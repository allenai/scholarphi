{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///web/ui_utils.js","webpack:///web/pdfjs.js","webpack:///node_modules/@babel/runtime/regenerator/index.js","webpack:///web/pdf_rendering_queue.js","webpack:///web/app.js","webpack:///web/app_options.js","webpack:///web/pdf_link_service.js","webpack:///web/viewer_compatibility.js","webpack:///web/pdf_cursor_tools.js","webpack:///web/pdf_find_controller.js","webpack:///web/base_viewer.js","webpack:///web/viewer.js","webpack:///node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js","webpack:///node_modules/webpack/buildin/module.js","webpack:///web/grab_to_pan.js","webpack:///web/pdf_sidebar.js","webpack:///web/overlay_manager.js","webpack:///web/password_prompt.js","webpack:///web/pdf_attachment_viewer.js","webpack:///web/pdf_document_properties.js","webpack:///web/pdf_find_bar.js","webpack:///web/pdf_find_utils.js","webpack:///web/pdf_history.js","webpack:///web/pdf_outline_viewer.js","webpack:///web/pdf_presentation_mode.js","webpack:///web/pdf_sidebar_resizer.js","webpack:///web/pdf_thumbnail_viewer.js","webpack:///web/pdf_thumbnail_view.js","webpack:///web/pdf_viewer.js","webpack:///web/annotation_layer_builder.js","webpack:///web/pdf_page_view.js","webpack:///web/text_layer_builder.js","webpack:///web/secondary_toolbar.js","webpack:///web/pdf_single_page_viewer.js","webpack:///web/toolbar.js","webpack:///web/view_history.js","webpack:///web/genericcom.js","webpack:///web/preferences.js","webpack:///web/download_manager.js","webpack:///web/genericl10n.js","webpack:///external/webL10n/l10n.js","webpack:///web/pdf_print_service.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","angle","Number","ScrollMode","SpreadMode","size","dispatchToDOM","globalEventBus","EventBus","url","defaultFilename","ii","isDataSchema","console","reFilename","splitURI","reURI","suggestedFilename","decodeURIComponent","ex","evt","query","parts","params","param","scrollEl","views","sortByVisibility","horizontal","top","bottom","left","right","visible","numViews","firstVisibleElementInd","binarySearchFirstItem","element","view","backtrackBeforeAllVisibleElements","lastEdge","currentWidth","currentHeight","viewWidth","viewHeight","viewRight","viewBottom","hiddenHeight","Math","hiddenWidth","percent","id","x","y","first","last","pc","a","b","div","changeOrientation","rotate","width","x2","height","y2","xinv","x_","q","result","ctx","devicePixelRatio","window","backingStoreRatio","pixelRatio","sx","sy","scaled","spot","skipOverflowHiddenElements","parent","offsetY","offsetX","getComputedStyle","viewAreaElement","callback","debounceScroll","rAF","requestAnimationFrame","currentX","lastX","state","currentY","lastY","down","_eventHandler","delta","MOUSE_PIXELS_PER_LINE","delay","Promise","isInteger","Error","target","clearTimeout","resolve","eventHandler","handler","WaitOnType","timeoutHandler","timeout","setTimeout","arr","condition","moved","len","write","read","UNKNOWN","NORMAL","CHANGING","FULLSCREEN","CANVAS","SVG","DISABLE","ENABLE","ENABLE_ENHANCE","VERTICAL","HORIZONTAL","WRAPPED","NONE","ODD","EVEN","formatL10nValue","text","args","replace","NullL10n","items","minIndex","maxIndex","currentIndex","index","elt","pageTop","EVENT","TIMEOUT","animationStarted","constructor","this","on","eventListeners","_listeners","off","dispatch","Array","listener","_dispatchDOMEvent","details","obj","event","document","clamp","v","min","max","units","progressSize","setWidth","scrollbarWidth","viewer","container","isNaN","pdfjsLib","__non_webpack_require__","require","RenderingStates","INITIAL","RUNNING","PAUSED","FINISHED","setViewer","setThumbnailViewer","isHighestPriority","highestPriorityPage","renderHighestPriority","pdfViewer","forceRendering","pdfThumbnailViewer","onIdle","getHighestPriority","visibleViews","numVisible","isViewFinished","nextPageIndex","previousPageIndex","renderView","WHEEL_ZOOM_DISABLED_TIMEOUT","ViewOnLoad","DefaultExternalServices","updateFindControlState","updateFindMatchesCount","initPassiveLoading","fallback","reportTelemetry","createDownloadManager","createPreferences","createL10n","supportsIntegratedFind","supportsDocumentFonts","supportsDocumentColors","supportedMouseWheelZoomModifierKeys","ctrlKey","metaKey","PDFViewerApplication","initialBookmark","initialized","fellback","appConfig","pdfDocument","pdfLoadingTask","printService","pdfRenderingQueue","pdfPresentationMode","pdfDocumentProperties","pdfLinkService","pdfHistory","pdfSidebar","pdfSidebarResizer","pdfOutlineViewer","pdfAttachmentViewer","pdfCursorTools","store","downloadManager","overlayManager","preferences","toolbar","secondaryToolbar","eventBus","l10n","isInitialViewSet","downloadComplete","isViewerEmbedded","baseUrl","externalServices","_boundEvents","contentDispositionFilename","AppOptions","LinkTarget","appContainer","source","prefs","reason","waitOn","hash","hashParams","parseQueryString","loadFakeWorker","TextLayerMode","enabled","loadAndEnablePDFBug","all","catch","locale","dir","getGlobalEventBus","cleanup","externalLinkTarget","externalLinkRel","disableCreateObjectURL","findController","linkService","renderingQueue","renderer","enableWebGL","textLayerMode","imageResourcesPath","renderInteractiveForms","enablePrintAutoRotate","useOnlyCssZoom","maxCanvasPixels","cursorToolOnLoad","contextMenuItems","elements","run","zoomIn","newScale","ticks","zoomOut","zoomReset","PDFPrintServiceFactory","doc","support","requestFullscreen","shadow","bar","setTitleUsingUrl","title","getPDFFileNameFromURL","getFilenameFromUrl","setTitle","errorWrapper","promise","PDFBug","workerParameters","OptionKind","GlobalWorkerOptions","parameters","file","apiParameters","loadingTask","getDocument","loaded","then","exception","message","msg","download","filename","err","blob","Blob","type","downloadByUrl","error","moreInfoText","version","build","moreInfo","stack","line","errorWrapperConfig","errorMessage","closeButton","errorMoreInfo","moreInfoButton","lessInfoButton","progress","level","loadingBar","loadingParams","load","firstPagePromise","pageLayoutPromise","getPageLayout","pageModePromise","getPageMode","openActionDestPromise","getOpenActionDestination","pagesPromise","onePageRendered","pdfPage","storePromise","getMultiple","page","zoom","scrollLeft","scrollTop","rotation","sidebarView","SidebarView","scrollMode","spreadMode","values","viewOnLoad","fingerprint","initialDest","parseInt","pageMode","apiPageModeToSidebarView","pageLayout","apiPageLayoutToSpreadMode","race","labels","numLabels","javaScript","js","UNSUPPORTED_FEATURES","regex","outline","attachments","info","metadata","pdfTitle","_initializePdfHistory","resetHistory","updateUrl","JSON","explicitDest","pageNumber","setInitialView","setRotation","isValidRotation","setViewerModes","scroll","spread","isValidScrollMode","isValidSpreadMode","storedHash","RendererType","beforePrint","pagesOverview","printContainer","notReadyMessage","printMessage","afterPrint","rotatePages","newRotation","requestPresentationMode","bindEvents","bindWindowEvents","passive","unbindEvents","unbindWindowEvents","HOSTED_VIEWER_ORIGINS","loadScript","PDFWorker","enabledTabs","OPS","createObjectURL","webViewerInitialized","queryString","validateFileURL","fileInput","files","webViewerOpenFileViaURL","webViewerPageRendered","pageIndex","pageView","thumbnailView","Stats","webViewerTextLayerRendered","webViewerPageMode","webViewerNamedAction","webViewerPresentationModeChanged","switchInProgress","PresentationModeState","active","webViewerSidebarViewChanged","webViewerUpdateViewarea","location","href","loading","currentPage","webViewerScrollModeChanged","webViewerSpreadModeChanged","webViewerResize","currentScaleValue","webViewerHashchange","webViewerPresentationMode","webViewerOpenFile","openFileInputName","webViewerPrint","webViewerDownload","webViewerFirstPage","webViewerLastPage","webViewerNextPage","webViewerPreviousPage","webViewerZoomIn","webViewerZoomOut","webViewerZoomReset","webViewerPageNumberChanged","webViewerScaleChanged","webViewerRotateCw","webViewerRotateCcw","webViewerSwitchScrollMode","webViewerSwitchSpreadMode","webViewerDocumentProperties","webViewerFind","phraseSearch","caseSensitive","entireWord","highlightAll","findPrevious","webViewerFindFromUrlHash","webViewerUpdateFindMatchesCount","webViewerUpdateFindControlState","matchesCount","webViewerScaleChanging","webViewerRotationChanging","webViewerPageChanging","webViewerVisibilityChange","setZoomDisabledTimeout","viewerOrigin","URL","loadingErrorMessage","xhr","Uint8Array","webViewerFileInputChange","originalUrl","fileReader","buffer","zoomDisabledTimeout","webViewerWheel","previousScale","normalizeWheelEventDelta","currentScale","scaleCorrectionFactor","rect","dx","dy","webViewerClick","webViewerKeyDown","handled","ensureViewerFocused","cmd","altKey","shiftKey","isViewerInPresentationMode","findState","curElement","curElementTagName","turnPage","turnOnlyIfPageFit","CursorTool","layout","instance","supportsPrinting","createPrintService","VIEWER","API","WORKER","PREFERENCE","defaultOptions","kind","defaultUrl","defaultZoomValue","disableHistory","disablePageLabels","eventBusDispatchToDOM","historyUpdateUrl","compatibility","viewerCompatibilityParams","pdfBugEnabled","sidebarViewOnLoad","scrollModeOnLoad","spreadModeOnLoad","cMapPacked","cMapUrl","disableAutoFetch","apiCompatibilityParams","disableFontFace","disableRange","disableStream","docBaseUrl","isEvalSupported","maxImageSize","pdfBug","verbosity","workerPort","workerSrc","navigator","userOptions","userOption","defaultOption","options","valueType","externalLinkEnabled","setDocument","setHistory","navigateTo","dest","namedDest","destArray","data","goToDestination","destRef","getDestinationHash","getAnchorUrl","escape","str","setHash","zoomArgs","zoomArg","zoomArgNumber","parseFloat","allowNegativeOffset","unescape","destLength","allowNull","isValidExplicitDestination","executeNamedAction","action","cachePageRef","refStr","pageRef","_cachedPageNumber","_pagesRefCache","isPageVisible","compatibilityParams","userAgent","platform","maxTouchPoints","isAndroid","test","SELECT","HAND","ZOOM","switchTool","activeBeforePresentationMode","tool","disableActiveTool","previouslyActive","FindState","FOUND","NOT_FOUND","PENDING","CHARACTERS_TO_NORMALIZE","normalizationRegex","normalize","RegExp","_onFindBarClose","executeCommand","_state","_shouldDirtyMatch","findbarClosed","pendingTimeout","matchIndex","scrollMatchIntoView","_selected","scrollIntoView","pageIdx","matchIdx","wrapped","_prepareMatches","currentElem","matchesWithLength","nextElem","prevElem","isSubTerm","matches","matchesLength","_isEntireWord","startIdx","content","limit","getCharacterType","endIdx","_calculatePhraseMatch","queryLen","pageContent","_calculateWordMatch","queryArray","subquery","subqueryLen","match","matchLength","skipped","_pageMatches","_pageMatchesLength","_calculateMatch","_pageContents","_resumePageIdx","pageMatchesCount","_extractTextPromises","length","extractTextCapability","normalizeWhitespace","textContent","textItems","strBuf","j","jj","_linkService","_updatePage","_scrollMatches","previous","currentPageIndex","numPages","_pendingFindMatches","_query","offset","numPageMatches","_matchesReady","numMatches","_pagesToSearch","_offset","_advanceOffsetPage","found","previousPage","current","total","_updateUIState","PDFPageViewBuffer","pageIdsToKeep","iMax","pagesToKeep","moveToEndOfArray","isSameScale","oldScale","watchScroll","_scrollUpdate","_onAfterDraw","getPageView","_pages","_setCurrentPageNumber","resetCurrentPageView","_currentPageNumber","val","pageLabel","_pageLabels","pagesCount","pagesCapability","onePageRenderedCapability","scale","viewport","pageNum","textLayerFactory","defaultViewport","annotationLayerFactory","getPagesLeft","setPageLabels","isArray","label","pageSpot","_setScaleUpdatePages","noScroll","preset","newValue","presetValue","_location","isInPresentationMode","_setScale","noPadding","hPadding","vPadding","pageWidthScale","pageHeightScale","horizontalScale","isPortraitOrientation","pageDiv","pageWidth","pageHeight","removePageBorders","widthScale","heightScale","_currentScale","boundingRect","_updateLocation","normalizedScaleValue","firstPage","pdfOpenParams","currentPageView","topLeft","intLeft","intTop","_updateHelper","visiblePages","numVisiblePages","newCacheSize","containsElement","contains","getVisibleElements","_getVisiblePages","some","renderingState","_ensurePdfPageLoaded","_pagesRequests","getPage","currentlyVisiblePages","scrollAhead","_isScrollModeHorizontal","createTextLayerBuilder","enhanceTextSelection","textLayerDiv","createAnnotationLayerBuilder","map","isFirstPagePortrait","_updateScrollMode","_currentScaleValue","_updateSpreadMode","pages","_spreadMode","parity","indexOf","_pagesRotation","pagesRotation","_scrollMode","presentationModeState","scrollWidth","scrollHeight","firstPageView","webViewerLoad","config","mainContainer","viewerContainer","scaleSelectContainer","scaleSelect","customScaleOption","next","viewFind","openFile","print","presentationModeButton","viewBookmark","toggleButton","toolbarButtonContainer","openFileButton","printButton","downloadButton","viewBookmarkButton","firstPageButton","lastPageButton","pageRotateCwButton","pageRotateCcwButton","cursorSelectToolButton","cursorHandToolButton","scrollVerticalButton","scrollHorizontalButton","scrollWrappedButton","spreadNoneButton","spreadOddButton","spreadEvenButton","documentPropertiesButton","fullscreen","contextFirstPage","contextLastPage","contextPageRotateCw","contextPageRotateCcw","sidebar","outerContainer","thumbnailButton","outlineButton","attachmentsButton","outlineView","attachmentsView","sidebarResizer","resizer","findBar","findField","highlightAllCheckbox","caseSensitiveCheckbox","entireWordCheckbox","findMsg","findResultsCount","findPreviousButton","findNextButton","passwordOverlay","overlayName","input","submitButton","cancelButton","documentProperties","fields","debuggerScriptPath","pdfjsWebApp","pdfjsWebAppOptions","runtime","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","toStringTagSymbol","protoGenerator","outerFn","generator","context","Context","tryLocsList","method","arg","doneResult","delegate","delegateResult","maybeInvokeDelegate","record","tryCatch","done","makeInvokeMethod","fn","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","IteratorPrototype","getProto","NativeIteratorPrototype","Gp","GeneratorFunctionPrototype","Generator","_invoke","invoke","reject","previousPromise","callInvokeWithMethodAndArg","TypeError","entry","tryLoc","locs","iteratorMethod","iterable","GeneratorFunction","ctor","genFun","__await","defineIteratorMethods","AsyncIterator","iter","wrap","keys","reset","_sent","stop","rootRecord","tryEntries","dispatchException","handle","hasCatch","hasFinally","prev","abrupt","finallyEntry","complete","finish","resetTryEntry","thrown","delegateYield","iterator","resultName","nextLoc","regeneratorRuntime","accidentalStrictMode","Function","GrabToPan","activate","deactivate","toggle","_onmousedown","_onmousemove","_endPan","overlay","CSS_CLASS_GRAB","ignoreTarget","node","e","focusedElement","buttons","isChrome15OrOpera15plus","isLeftMouseReleased","xDiff","yDiff","scrollTopStart","scrollLeftStart","behavior","prefix","matchesSelector","isNotIEorIsIE10plus","chrome","webstore","isSafari6plus","THUMBS","OUTLINE","ATTACHMENTS","LAYERS","disableNotification","_switchView","switchView","forceOpen","isViewChanged","shouldForceRendering","isOpen","_showUINotification","_hideUINotification","removeNotification","outlineCount","_keyDown","callerCloseMethod","canForceClose","_overlays","_active","verify","close","PasswordResponses","promptString","password","setUpdateCallback","_appendAttachment","keepRenderedCapability","_dispatchEvent","attachmentsCount","_bindPdfLink","button","blobUrl","viewerUrl","encodeURIComponent","_bindLink","names","sort","item","removeNullCharacters","NON_METRIC_LOCALES","US_PAGE_NAMES","METRIC_PAGE_NAMES","getPageName","isPortrait","pageNames","freezeFieldData","writable","configurable","open","_dataAvailableCapability","currentPageNumber","getPageSizeInches","fileSize","setFileSize","fieldData","kb","size_kb","size_b","size_mb","pageSizeInches","sizeInches","sizeMillimeters","pageName","exactMillimeters","intMillimeters","_isNonMetricLocale","unit","orientation","dateObject","PDFDateString","date","time","_parseLinearization","isLinearized","_adjustWidth","dispatchEvent","updateUIState","notFound","status","updateResultsCount","matchesCountMsg","firstElementChild","charCode","isAlphabeticalScript","isAscii","isAsciiSpace","CharacterType","isAsciiAlpha","isAsciiDigit","isThai","isHan","isKatakana","isHiragana","isHalfwidthKatakana","SPACE","ALPHA_LETTER","PUNCT","HAN_LETTER","KATAKANA_LETTER","HIRAGANA_LETTER","HALFWIDTH_KATAKANA_LETTER","THAI_LETTER","getCurrentHash","parseCurrentHash","reInitialized","_maxUid","_isValidState","destination","_uid","push","forceReplace","_destination","isDestHashesEqual","isDestArraysEqual","_popStateInProgress","_pushOrReplaceState","shouldReplace","newState","uid","_updateUrl","newUrl","temporary","position","_numPositionUpdates","checkReload","performance","perfEntry","_updateInternalState","removeTemporary","_updateViewarea","_isViewerInPresentationMode","POSITION_UPDATED_THRESHOLD","_popState","newHash","hashChanged","_currentHash","waitOnEventOrTimeout","_blockHashChange","destHash","pushHash","firstDest","secondDest","second","isEntryEqual","toggleOutlineTree","addLinkAttributes","newWindow","rel","_setStyles","styleStr","_addToggleButton","toggler","count","shouldShowAll","_toggleOutlineItem","show","root","render","fragment","queue","hasAnyNesting","levelData","itemsDiv","SWIPE_ANGLE_THRESHOLD","Element","_mouseWheel","currentTime","storedTime","mouseScrollDelta","totalDelta","_mouseDown","_touchSwipe","startX","startY","endX","endY","touchSwipeState","absAngle","_showControls","_resetMouseScrollState","_contextMenu","_fullscreenChange","fullscreenElement","SIDEBAR_WIDTH_VAR","SIDEBAR_MIN_WIDTH","CSS","_updateWidth","newWidth","outerContainerWidth","_mouseMove","_mouseUp","updated","_scrollUpdated","getThumbnail","_thumbnails","scrollThumbnailIntoView","prevThumbnailView","visibleThumbs","numVisibleThumbs","shouldScroll","PDFThumbnailView","thumbnail","disableCanvasToImageConversion","thumbView","tempCanvasCache","THUMBNAIL_CANVAS_BORDER_WIDTH","THUMBNAIL_WIDTH","TempImageFactory","getCanvas","tempCanvas","alpha","destroyCanvas","canvasWidth","anchor","ring","borderAdjustment","canvasHeight","setPdfPage","totalRotation","getViewport","childNodes","update","clone","noCtxScale","canvas","outputScale","getOutputScale","image","renderCapability","finishRenderTask","renderTask","renderContext","canvasContext","cont","setImage","img","_getPageDrawContext","reducedWidth","reducedHeight","reducedImage","reducedImageCtx","setPageLabel","ariaLabel","_scrollIntoView","currentId","stillFullyVisible","intent","annotations","dontFlip","AnnotationLayer","AnnotationLayerBuilder","MAX_CANVAS_PIXELS","removeFromDOM","zoomLayerCanvas","zoomLayer","keepZoomLayer","keepAnnotations","currentZoomLayerNode","currentAnnotationNode","annotationLayer","cssTransform","timestamp","isScalingRestricted","hasRestrictedScaling","hasAttribute","redrawAnnotations","relativeRotation","paintedViewportMap","absRotation","scaleX","scaleY","textLayerViewport","textLayer","textRelativeRotation","textAbsRotation","transX","transY","getPagePoint","convertToPdfPoint","canvasWrapper","renderContinueCallback","finishPaintTask","paintTask","paintOnSvg","paintOnCanvas","resultPromise","readableStream","onRenderContinue","cancel","isCanvasHidden","showCanvas","actualSizeViewport","pixelsInViewport","maxScale","sfx","approximateFraction","sfy","roundToDivide","transform","cancelled","ensureNotCancelled","getOperatorList","opList","getSVG","svg","wrapper","endOfContent","numTextDivs","textDivs","textLayerFrag","renderTextLayer","textContentStream","textContentItemsStr","setTextContentStream","setTextContent","_convertMatches","iIndex","end","mm","begin","divIdx","_renderMatches","isSelectedPage","selectedMatchIdx","prevEnd","infinity","i0","i1","isSelected","highlightSuffix","appendTextToDiv","beginText","n0","n1","span","clearedUntilDivIdx","pageMatches","pageMatchesLength","expandDivsTimer","adjustTop","divBounds","TextLayerBuilder","eventName","eventDetails","lastPage","pageRotateCw","pageRotateCcw","_setMaxHeight","setPageNumber","setPagesCount","_bindCursorToolsListener","_bindScrollModeListener","isScrollModeHorizontal","scrollModeChanged","_bindSpreadModeListener","spreadModeChanged","containerHeight","previousPageView","_previousPageNumber","viewerNodes","scrolledDown","setPageScale","pageScaleValue","self","resetNumPages","pageScale","customScale","predefinedValueFound","option","pageNumberInput","select","DEFAULT_VIEW_HISTORY_CACHE_SIZE","cacheSize","_readFromStorage","databaseStr","database","branch","localStorage","properties","GenericExternalServices","defaultPreferences","defaults","defaultValue","prefValue","_writeToStorage","defaultType","DISABLE_CREATE_OBJECT_URL","downloadUrl","createValidAbsoluteUrl","downloadData","webL10n","gL10nData","gTextData","gTextProp","gLanguage","gMacros","gReadyState","gAsyncResourceLoading","onSuccess","onFailure","baseURL","xhrLoadText","dictionary","reBlank","reComment","reSection","reImport","reSplit","entries","rawText","currentLang","genericLang","lang","skipLang","parsedRawLinesCallback","loadImport","tmp","evalString","nextEntry","parseRawLines","parsedPropertiesCallback","parseProperties","prop","successCallback","langLinks","langCount","script","onResourceLoaded","gResourceCount","L10nResourceLink","resource","dict","defaultLocale","anyCaseLang","link","parseResource","rv","substArguments","substIndexes","reMatch","reIndex","macroName","paramName","macro","l10nId","l10nArgs","getL10nAttributes","getL10nData","getChildElementCount","children","textNode","list","start","pluralRules","isBetween","isIn","getPluralRules","getData","getText","getLanguage","setLanguage","loadLocale","getDirection","shortCode","rtlList","translate","getTranslatableChildren","elementCount","translateElement","getReadyState","ready","once","activeService","PDFPrintService","body","every","pageSize","destroy","scratchCanvas","ensureOverlay","renderPages","pageCount","renderNextPage","renderProgress","activeServiceOnEntry","PRINT_UNITS","renderPage","useRenderedPage","printItem","performPrint","throwIfInactive","eventType","abort","progressContainer","progressBar","progressPerc","hasAttachEvent","stopPropagationIfNeeded","overlayPromise"],"mappings":"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","file":"viewer.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CSS_UNITS = 96.0 / 72.0;\nconst DEFAULT_SCALE_VALUE = 'auto';\nconst DEFAULT_SCALE = 1.0;\nconst MIN_SCALE = 0.10;\nconst MAX_SCALE = 10.0;\nconst UNKNOWN_SCALE = 0;\nconst MAX_AUTO_SCALE = 1.25;\nconst SCROLLBAR_PADDING = 40;\nconst VERTICAL_PADDING = 5;\n\nconst PresentationModeState = {\n  UNKNOWN: 0,\n  NORMAL: 1,\n  CHANGING: 2,\n  FULLSCREEN: 3,\n};\n\nconst RendererType = {\n  CANVAS: 'canvas',\n  SVG: 'svg',\n};\n\nconst TextLayerMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_ENHANCE: 2,\n};\n\nconst ScrollMode = {\n  UNKNOWN: -1,\n  VERTICAL: 0, // Default value.\n  HORIZONTAL: 1,\n  WRAPPED: 2,\n};\n\nconst SpreadMode = {\n  UNKNOWN: -1,\n  NONE: 0, // Default value.\n  ODD: 1,\n  EVEN: 2,\n};\n\n// Replaces {{arguments}} with their values.\nfunction formatL10nValue(text, args) {\n  if (!args) {\n    return text;\n  }\n  return text.replace(/\\{\\{\\s*(\\w+)\\s*\\}\\}/g, (all, name) => {\n    return (name in args ? args[name] : '{{' + name + '}}');\n  });\n}\n\n/**\n * No-op implementation of the localization service.\n * @implements {IL10n}\n */\nlet NullL10n = {\n  async getLanguage() {\n    return 'en-us';\n  },\n\n  async getDirection() {\n    return 'ltr';\n  },\n\n  async get(property, args, fallback) {\n    return formatL10nValue(fallback, args);\n  },\n\n  async translate(element) { },\n};\n\n/**\n * Returns scale factor for the canvas. It makes sense for the HiDPI displays.\n * @returns {Object} The object with horizontal (sx) and vertical (sy)\n *                   scales. The scaled property is set to false if scaling is\n *                   not required, true otherwise.\n */\nfunction getOutputScale(ctx) {\n  let devicePixelRatio = window.devicePixelRatio || 1;\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n                          ctx.mozBackingStorePixelRatio ||\n                          ctx.msBackingStorePixelRatio ||\n                          ctx.oBackingStorePixelRatio ||\n                          ctx.backingStorePixelRatio || 1;\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1,\n  };\n}\n\n/**\n * Scrolls specified element into view of its parent.\n * @param {Object} element - The element to be visible.\n * @param {Object} spot - An object with optional top and left properties,\n *   specifying the offset from the top left edge.\n * @param {boolean} skipOverflowHiddenElements - Ignore elements that have\n *   the CSS rule `overflow: hidden;` set. The default is false.\n */\nfunction scrollIntoView(element, spot, skipOverflowHiddenElements = false) {\n  // Assuming offsetParent is available (it's not available when viewer is in\n  // hidden iframe or object). We have to scroll: if the offsetParent is not set\n  // producing the error. See also animationStarted.\n  let parent = element.offsetParent;\n  if (!parent) {\n    console.error('offsetParent is not set -- cannot scroll');\n    return;\n  }\n  let offsetY = element.offsetTop + element.clientTop;\n  let offsetX = element.offsetLeft + element.clientLeft;\n  while ((parent.clientHeight === parent.scrollHeight &&\n          parent.clientWidth === parent.scrollWidth) ||\n         (skipOverflowHiddenElements &&\n          getComputedStyle(parent).overflow === 'hidden')) {\n    if (parent.dataset._scaleY) {\n      offsetY /= parent.dataset._scaleY;\n      offsetX /= parent.dataset._scaleX;\n    }\n    offsetY += parent.offsetTop;\n    offsetX += parent.offsetLeft;\n    parent = parent.offsetParent;\n    if (!parent) {\n      return; // no need to scroll\n    }\n  }\n  if (spot) {\n    if (spot.top !== undefined) {\n      offsetY += spot.top;\n    }\n    if (spot.left !== undefined) {\n      offsetX += spot.left;\n      parent.scrollLeft = offsetX;\n    }\n  }\n  parent.scrollTop = offsetY;\n}\n\n/**\n * Helper function to start monitoring the scroll event and converting them into\n * PDF.js friendly one: with scroll debounce and scroll direction.\n */\nfunction watchScroll(viewAreaElement, callback) {\n  let debounceScroll = function(evt) {\n    if (rAF) {\n      return;\n    }\n    // schedule an invocation of scroll for next animation frame.\n    rAF = window.requestAnimationFrame(function viewAreaElementScrolled() {\n      rAF = null;\n\n      let currentX = viewAreaElement.scrollLeft;\n      let lastX = state.lastX;\n      if (currentX !== lastX) {\n        state.right = currentX > lastX;\n      }\n      state.lastX = currentX;\n      let currentY = viewAreaElement.scrollTop;\n      let lastY = state.lastY;\n      if (currentY !== lastY) {\n        state.down = currentY > lastY;\n      }\n      state.lastY = currentY;\n      callback(state);\n    });\n  };\n\n  let state = {\n    right: true,\n    down: true,\n    lastX: viewAreaElement.scrollLeft,\n    lastY: viewAreaElement.scrollTop,\n    _eventHandler: debounceScroll,\n  };\n\n  let rAF = null;\n  viewAreaElement.addEventListener('scroll', debounceScroll, true);\n  return state;\n}\n\n/**\n * Helper function to parse query string (e.g. ?param1=value&parm2=...).\n */\nfunction parseQueryString(query) {\n  let parts = query.split('&');\n  let params = Object.create(null);\n  for (let i = 0, ii = parts.length; i < ii; ++i) {\n    let param = parts[i].split('=');\n    let key = param[0].toLowerCase();\n    let value = param.length > 1 ? param[1] : null;\n    params[decodeURIComponent(key)] = decodeURIComponent(value);\n  }\n  return params;\n}\n\n/**\n * Use binary search to find the index of the first item in a given array which\n * passes a given condition. The items are expected to be sorted in the sense\n * that if the condition is true for one item in the array, then it is also true\n * for all following items.\n *\n * @returns {number} Index of the first array element to pass the test,\n *                   or |items.length| if no such element exists.\n */\nfunction binarySearchFirstItem(items, condition) {\n  let minIndex = 0;\n  let maxIndex = items.length - 1;\n\n  if (items.length === 0 || !condition(items[maxIndex])) {\n    return items.length;\n  }\n  if (condition(items[minIndex])) {\n    return minIndex;\n  }\n\n  while (minIndex < maxIndex) {\n    let currentIndex = (minIndex + maxIndex) >> 1;\n    let currentItem = items[currentIndex];\n    if (condition(currentItem)) {\n      maxIndex = currentIndex;\n    } else {\n      minIndex = currentIndex + 1;\n    }\n  }\n  return minIndex; /* === maxIndex */\n}\n\n/**\n *  Approximates float number as a fraction using Farey sequence (max order\n *  of 8).\n *  @param {number} x - Positive float number.\n *  @returns {Array} Estimated fraction: the first array item is a numerator,\n *                   the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast paths for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n  let xinv = 1 / x;\n  let limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  let x_ = x > 1 ? xinv : x;\n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0, b = 1, c = 1, d = 1;\n  // Limiting search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    let p = a + c, q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p; d = q;\n    } else {\n      a = p; b = q;\n    }\n  }\n  let result;\n  // Select closest of the neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    result = x_ === x ? [a, b] : [b, a];\n  } else {\n    result = x_ === x ? [c, d] : [d, c];\n  }\n  return result;\n}\n\nfunction roundToDivide(x, div) {\n  let r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n\n/**\n * Gets the size of the specified page, converted from PDF units to inches.\n * @param {Object} An Object containing the properties: {Array} `view`,\n *   {number} `userUnit`, and {number} `rotate`.\n * @returns {Object} An Object containing the properties: {number} `width`\n *   and {number} `height`, given in inches.\n */\nfunction getPageSizeInches({ view, userUnit, rotate, }) {\n  const [x1, y1, x2, y2] = view;\n  // We need to take the page rotation into account as well.\n  const changeOrientation = rotate % 180 !== 0;\n\n  const width = (x2 - x1) / 72 * userUnit;\n  const height = (y2 - y1) / 72 * userUnit;\n\n  return {\n    width: (changeOrientation ? height : width),\n    height: (changeOrientation ? width : height),\n  };\n}\n\n/**\n * Helper function for getVisibleElements.\n *\n * @param {number} index - initial guess at the first visible element\n * @param {Array} views - array of pages, into which `index` is an index\n * @param {number} top - the top of the scroll pane\n * @returns {number} less than or equal to `index` that is definitely at or\n *   before the first visible element in `views`, but not by too much. (Usually,\n *   this will be the first element in the first partially visible row in\n *   `views`, although sometimes it goes back one row further.)\n */\nfunction backtrackBeforeAllVisibleElements(index, views, top) {\n  // binarySearchFirstItem's assumption is that the input is ordered, with only\n  // one index where the conditions flips from false to true: [false ...,\n  // true...]. With vertical scrolling and spreads, it is possible to have\n  // [false ..., true, false, true ...]. With wrapped scrolling we can have a\n  // similar sequence, with many more mixed true and false in the middle.\n  //\n  // So there is no guarantee that the binary search yields the index of the\n  // first visible element. It could have been any of the other visible elements\n  // that were preceded by a hidden element.\n\n  // Of course, if either this element or the previous (hidden) element is also\n  // the first element, there's nothing to worry about.\n  if (index < 2) {\n    return index;\n  }\n\n  // That aside, the possible cases are represented below.\n  //\n  //     ****  = fully hidden\n  //     A*B*  = mix of partially visible and/or hidden pages\n  //     CDEF  = fully visible\n  //\n  // (1) Binary search could have returned A, in which case we can stop.\n  // (2) Binary search could also have returned B, in which case we need to\n  // check the whole row.\n  // (3) Binary search could also have returned C, in which case we need to\n  // check the whole previous row.\n  //\n  // There's one other possibility:\n  //\n  //     ****  = fully hidden\n  //     ABCD  = mix of fully and/or partially visible pages\n  //\n  // (4) Binary search could only have returned A.\n\n  // Initially assume that we need to find the beginning of the current row\n  // (case 1, 2, or 4), which means finding a page that is above the current\n  // page's top. If the found page is partially visible, we're definitely not in\n  // case 3, and this assumption is correct.\n  let elt = views[index].div;\n  let pageTop = elt.offsetTop + elt.clientTop;\n\n  if (pageTop >= top) {\n    // The found page is fully visible, so we're actually either in case 3 or 4,\n    // and unfortunately we can't tell the difference between them without\n    // scanning the entire previous row, so we just conservatively assume that\n    // we do need to backtrack to that row. In both cases, the previous page is\n    // in the previous row, so use its top instead.\n    elt = views[index - 1].div;\n    pageTop = elt.offsetTop + elt.clientTop;\n  }\n\n  // Now we backtrack to the first page that still has its bottom below\n  // `pageTop`, which is the top of a page in the first visible row (unless\n  // we're in case 4, in which case it's the row before that).\n  // `index` is found by binary search, so the page at `index - 1` is\n  // invisible and we can start looking for potentially visible pages from\n  // `index - 2`. (However, if this loop terminates on its first iteration,\n  // which is the case when pages are stacked vertically, `index` should remain\n  // unchanged, so we use a distinct loop variable.)\n  for (let i = index - 2; i >= 0; --i) {\n    elt = views[i].div;\n    if (elt.offsetTop + elt.clientTop + elt.clientHeight <= pageTop) {\n      // We have reached the previous row, so stop now.\n      // This loop is expected to terminate relatively quickly because the\n      // number of pages per row is expected to be small.\n      break;\n    }\n    index = i;\n  }\n  return index;\n}\n\n/**\n * Generic helper to find out what elements are visible within a scroll pane.\n *\n * Well, pretty generic. There are some assumptions placed on the elements\n * referenced by `views`:\n *   - If `horizontal`, no left of any earlier element is to the right of the\n *     left of any later element.\n *   - Otherwise, `views` can be split into contiguous rows where, within a row,\n *     no top of any element is below the bottom of any other element, and\n *     between rows, no bottom of any element in an earlier row is below the\n *     top of any element in a later row.\n *\n * (Here, top, left, etc. all refer to the padding edge of the element in\n * question. For pages, that ends up being equivalent to the bounding box of the\n * rendering canvas. Earlier and later refer to index in `views`, not page\n * layout.)\n *\n * @param scrollEl {HTMLElement} - a container that can possibly scroll\n * @param views {Array} - objects with a `div` property that contains an\n *   HTMLElement, which should all be descendents of `scrollEl` satisfying the\n *   above layout assumptions\n * @param sortByVisibility {boolean} - if true, the returned elements are sorted\n *   in descending order of the percent of their padding box that is visible\n * @param horizontal {boolean} - if true, the elements are assumed to be laid\n *   out horizontally instead of vertically\n * @returns {Object} `{ first, last, views: [{ id, x, y, view, percent }] }`\n */\nfunction getVisibleElements(scrollEl, views, sortByVisibility = false,\n                            horizontal = false) {\n  const top = scrollEl.scrollTop, bottom = top + scrollEl.clientHeight;\n  const left = scrollEl.scrollLeft, right = left + scrollEl.clientWidth;\n\n  // Throughout this \"generic\" function, comments will assume we're working with\n  // PDF document pages, which is the most important and complex case. In this\n  // case, the visible elements we're actually interested is the page canvas,\n  // which is contained in a wrapper which adds no padding/border/margin, which\n  // is itself contained in `view.div` which adds no padding (but does add a\n  // border). So, as specified in this function's doc comment, this function\n  // does all of its work on the padding edge of the provided views, starting at\n  // offsetLeft/Top (which includes margin) and adding clientLeft/Top (which is\n  // the border). Adding clientWidth/Height gets us the bottom-right corner of\n  // the padding edge.\n  function isElementBottomAfterViewTop(view) {\n    const element = view.div;\n    const elementBottom =\n      element.offsetTop + element.clientTop + element.clientHeight;\n    return elementBottom > top;\n  }\n  function isElementRightAfterViewLeft(view) {\n    const element = view.div;\n    const elementRight =\n      element.offsetLeft + element.clientLeft + element.clientWidth;\n    return elementRight > left;\n  }\n\n  const visible = [], numViews = views.length;\n  let firstVisibleElementInd = numViews === 0 ? 0 :\n    binarySearchFirstItem(views, horizontal ? isElementRightAfterViewLeft :\n                                              isElementBottomAfterViewTop);\n\n  // Please note the return value of the `binarySearchFirstItem` function when\n  // no valid element is found (hence the `firstVisibleElementInd` check below).\n  if (firstVisibleElementInd > 0 && firstVisibleElementInd < numViews &&\n      !horizontal) {\n    // In wrapped scrolling (or vertical scrolling with spreads), with some page\n    // sizes, isElementBottomAfterViewTop doesn't satisfy the binary search\n    // condition: there can be pages with bottoms above the view top between\n    // pages with bottoms below. This function detects and corrects that error;\n    // see it for more comments.\n    firstVisibleElementInd =\n      backtrackBeforeAllVisibleElements(firstVisibleElementInd, views, top);\n  }\n\n  // lastEdge acts as a cutoff for us to stop looping, because we know all\n  // subsequent pages will be hidden.\n  //\n  // When using wrapped scrolling or vertical scrolling with spreads, we can't\n  // simply stop the first time we reach a page below the bottom of the view;\n  // the tops of subsequent pages on the same row could still be visible. In\n  // horizontal scrolling, we don't have that issue, so we can stop as soon as\n  // we pass `right`, without needing the code below that handles the -1 case.\n  let lastEdge = horizontal ? right : -1;\n\n  for (let i = firstVisibleElementInd; i < numViews; i++) {\n    const view = views[i], element = view.div;\n    const currentWidth = element.offsetLeft + element.clientLeft;\n    const currentHeight = element.offsetTop + element.clientTop;\n    const viewWidth = element.clientWidth, viewHeight = element.clientHeight;\n    const viewRight = currentWidth + viewWidth;\n    const viewBottom = currentHeight + viewHeight;\n\n    if (lastEdge === -1) {\n      // As commented above, this is only needed in non-horizontal cases.\n      // Setting lastEdge to the bottom of the first page that is partially\n      // visible ensures that the next page fully below lastEdge is on the\n      // next row, which has to be fully hidden along with all subsequent rows.\n      if (viewBottom >= bottom) {\n        lastEdge = viewBottom;\n      }\n    } else if ((horizontal ? currentWidth : currentHeight) > lastEdge) {\n      break;\n    }\n\n    if (viewBottom <= top || currentHeight >= bottom ||\n        viewRight <= left || currentWidth >= right) {\n      continue;\n    }\n\n    const hiddenHeight = Math.max(0, top - currentHeight) +\n                         Math.max(0, viewBottom - bottom);\n    const hiddenWidth = Math.max(0, left - currentWidth) +\n                        Math.max(0, viewRight - right);\n    const percent = ((viewHeight - hiddenHeight) * (viewWidth - hiddenWidth) *\n                     100 / viewHeight / viewWidth) | 0;\n    visible.push({\n      id: view.id,\n      x: currentWidth,\n      y: currentHeight,\n      view,\n      percent,\n    });\n  }\n\n  const first = visible[0], last = visible[visible.length - 1];\n\n  if (sortByVisibility) {\n    visible.sort(function(a, b) {\n      let pc = a.percent - b.percent;\n      if (Math.abs(pc) > 0.001) {\n        return -pc;\n      }\n      return a.id - b.id; // ensure stability\n    });\n  }\n  return { first, last, views: visible, };\n}\n\n/**\n * Event handler to suppress context menu.\n */\nfunction noContextMenuHandler(evt) {\n  evt.preventDefault();\n}\n\nfunction isDataSchema(url) {\n  let i = 0, ii = url.length;\n  while (i < ii && url[i].trim() === '') {\n    i++;\n  }\n  return url.substring(i, i + 5).toLowerCase() === 'data:';\n}\n\n/**\n * Returns the filename or guessed filename from the url (see issue 3455).\n * @param {string} url - The original PDF location.\n * @param {string} defaultFilename - The value returned if the filename is\n *   unknown, or the protocol is unsupported.\n * @returns {string} Guessed PDF filename.\n */\nfunction getPDFFileNameFromURL(url, defaultFilename = 'document.pdf') {\n  if (typeof url !== 'string') {\n    return defaultFilename;\n  }\n  if (isDataSchema(url)) {\n    console.warn('getPDFFileNameFromURL: ' +\n                 'ignoring \"data:\" URL for performance reasons.');\n    return defaultFilename;\n  }\n  const reURI = /^(?:(?:[^:]+:)?\\/\\/[^\\/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  //            SCHEME        HOST         1.PATH  2.QUERY   3.REF\n  // Pattern to get last matching NAME.pdf\n  const reFilename = /[^\\/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  let splitURI = reURI.exec(url);\n  let suggestedFilename = reFilename.exec(splitURI[1]) ||\n                          reFilename.exec(splitURI[2]) ||\n                          reFilename.exec(splitURI[3]);\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n    if (suggestedFilename.includes('%')) {\n      // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n      try {\n        suggestedFilename =\n          reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n      } catch (ex) { // Possible (extremely rare) errors:\n        // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n        // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n      }\n    }\n  }\n  return suggestedFilename || defaultFilename;\n}\n\nfunction normalizeWheelEventDelta(evt) {\n  let delta = Math.sqrt(evt.deltaX * evt.deltaX + evt.deltaY * evt.deltaY);\n  let angle = Math.atan2(evt.deltaY, evt.deltaX);\n  if (-0.25 * Math.PI < angle && angle < 0.75 * Math.PI) {\n    // All that is left-up oriented has to change the sign.\n    delta = -delta;\n  }\n\n  const MOUSE_DOM_DELTA_PIXEL_MODE = 0;\n  const MOUSE_DOM_DELTA_LINE_MODE = 1;\n  const MOUSE_PIXELS_PER_LINE = 30;\n  const MOUSE_LINES_PER_PAGE = 30;\n\n  // Converts delta to per-page units\n  if (evt.deltaMode === MOUSE_DOM_DELTA_PIXEL_MODE) {\n    delta /= MOUSE_PIXELS_PER_LINE * MOUSE_LINES_PER_PAGE;\n  } else if (evt.deltaMode === MOUSE_DOM_DELTA_LINE_MODE) {\n    delta /= MOUSE_LINES_PER_PAGE;\n  }\n  return delta;\n}\n\nfunction isValidRotation(angle) {\n  return Number.isInteger(angle) && angle % 90 === 0;\n}\n\nfunction isValidScrollMode(mode) {\n  return (Number.isInteger(mode) && Object.values(ScrollMode).includes(mode) &&\n          mode !== ScrollMode.UNKNOWN);\n}\n\nfunction isValidSpreadMode(mode) {\n  return (Number.isInteger(mode) && Object.values(SpreadMode).includes(mode) &&\n          mode !== SpreadMode.UNKNOWN);\n}\n\nfunction isPortraitOrientation(size) {\n  return size.width <= size.height;\n}\n\nconst WaitOnType = {\n  EVENT: 'event',\n  TIMEOUT: 'timeout',\n};\n\n/**\n * @typedef {Object} WaitOnEventOrTimeoutParameters\n * @property {Object} target - The event target, can for example be:\n *   `window`, `document`, a DOM element, or an {EventBus} instance.\n * @property {string} name - The name of the event.\n * @property {number} delay - The delay, in milliseconds, after which the\n *   timeout occurs (if the event wasn't already dispatched).\n */\n\n/**\n * Allows waiting for an event or a timeout, whichever occurs first.\n * Can be used to ensure that an action always occurs, even when an event\n * arrives late or not at all.\n *\n * @param {WaitOnEventOrTimeoutParameters}\n * @returns {Promise} A promise that is resolved with a {WaitOnType} value.\n */\nfunction waitOnEventOrTimeout({ target, name, delay = 0, }) {\n  return new Promise(function(resolve, reject) {\n    if (typeof target !== 'object' || !(name && typeof name === 'string') ||\n        !(Number.isInteger(delay) && delay >= 0)) {\n      throw new Error('waitOnEventOrTimeout - invalid parameters.');\n    }\n\n    function handler(type) {\n      if (target instanceof EventBus) {\n        target.off(name, eventHandler);\n      } else {\n        target.removeEventListener(name, eventHandler);\n      }\n\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n      resolve(type);\n    }\n\n    const eventHandler = handler.bind(null, WaitOnType.EVENT);\n    if (target instanceof EventBus) {\n      target.on(name, eventHandler);\n    } else {\n      target.addEventListener(name, eventHandler);\n    }\n\n    const timeoutHandler = handler.bind(null, WaitOnType.TIMEOUT);\n    let timeout = setTimeout(timeoutHandler, delay);\n  });\n}\n\n/**\n * Promise that is resolved when DOM window becomes visible.\n */\nlet animationStarted = new Promise(function (resolve) {\n  if ((typeof PDFJSDev !== 'undefined' && PDFJSDev.test('LIB')) &&\n      typeof window === 'undefined') {\n    // Prevent \"ReferenceError: window is not defined\" errors when running the\n    // unit-tests in Node.js/Travis.\n    setTimeout(resolve, 20);\n    return;\n  }\n  window.requestAnimationFrame(resolve);\n});\n\n/**\n * Simple event bus for an application. Listeners are attached using the\n * `on` and `off` methods. To raise an event, the `dispatch` method shall be\n * used.\n */\nclass EventBus {\n  constructor({ dispatchToDOM = false, } = {}) {\n    this._listeners = Object.create(null);\n    this._dispatchToDOM = dispatchToDOM === true;\n  }\n\n  on(eventName, listener) {\n    let eventListeners = this._listeners[eventName];\n    if (!eventListeners) {\n      eventListeners = [];\n      this._listeners[eventName] = eventListeners;\n    }\n    eventListeners.push(listener);\n  }\n\n  off(eventName, listener) {\n    let eventListeners = this._listeners[eventName];\n    let i;\n    if (!eventListeners || ((i = eventListeners.indexOf(listener)) < 0)) {\n      return;\n    }\n    eventListeners.splice(i, 1);\n  }\n\n  dispatch(eventName) {\n    let eventListeners = this._listeners[eventName];\n    if (!eventListeners || eventListeners.length === 0) {\n      if (this._dispatchToDOM) {\n        const args = Array.prototype.slice.call(arguments, 1);\n        this._dispatchDOMEvent(eventName, args);\n      }\n      return;\n    }\n    // Passing all arguments after the eventName to the listeners.\n    const args = Array.prototype.slice.call(arguments, 1);\n    // Making copy of the listeners array in case if it will be modified\n    // during dispatch.\n    eventListeners.slice(0).forEach(function (listener) {\n      listener.apply(null, args);\n    });\n    if (this._dispatchToDOM) {\n      this._dispatchDOMEvent(eventName, args);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _dispatchDOMEvent(eventName, args = null) {\n    const details = Object.create(null);\n    if (args && args.length > 0) {\n      const obj = args[0];\n      for (let key in obj) {\n        const value = obj[key];\n        if (key === 'source') {\n          if (value === window || value === document) {\n            return; // No need to re-dispatch (already) global events.\n          }\n          continue; // Ignore the `source` property.\n        }\n        details[key] = value;\n      }\n    }\n    const event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, true, true, details);\n    document.dispatchEvent(event);\n  }\n}\n\nlet globalEventBus = null;\nfunction getGlobalEventBus(dispatchToDOM = false) {\n  if (!globalEventBus) {\n    globalEventBus = new EventBus({ dispatchToDOM, });\n  }\n  return globalEventBus;\n}\n\nfunction clamp(v, min, max) {\n  return Math.min(Math.max(v, min), max);\n}\n\nclass ProgressBar {\n  constructor(id, { height, width, units, } = {}) {\n    this.visible = true;\n\n    // Fetch the sub-elements for later.\n    this.div = document.querySelector(id + ' .progress');\n    // Get the loading bar element, so it can be resized to fit the viewer.\n    this.bar = this.div.parentNode;\n\n    // Get options, with sensible defaults.\n    this.height = height || 100;\n    this.width = width || 100;\n    this.units = units || '%';\n\n    // Initialize heights.\n    this.div.style.height = this.height + this.units;\n    this.percent = 0;\n  }\n\n  _updateBar() {\n    if (this._indeterminate) {\n      this.div.classList.add('indeterminate');\n      this.div.style.width = this.width + this.units;\n      return;\n    }\n\n    this.div.classList.remove('indeterminate');\n    let progressSize = this.width * this._percent / 100;\n    this.div.style.width = progressSize + this.units;\n  }\n\n  get percent() {\n    return this._percent;\n  }\n\n  set percent(val) {\n    this._indeterminate = isNaN(val);\n    this._percent = clamp(val, 0, 100);\n    this._updateBar();\n  }\n\n  setWidth(viewer) {\n    if (!viewer) {\n      return;\n    }\n    let container = viewer.parentNode;\n    let scrollbarWidth = container.offsetWidth - viewer.offsetWidth;\n    if (scrollbarWidth > 0) {\n      this.bar.setAttribute('style', 'width: calc(100% - ' +\n                                     scrollbarWidth + 'px);');\n    }\n  }\n\n  hide() {\n    if (!this.visible) {\n      return;\n    }\n    this.visible = false;\n    this.bar.classList.add('hidden');\n    document.body.classList.remove('loadingInProgress');\n  }\n\n  show() {\n    if (this.visible) {\n      return;\n    }\n    this.visible = true;\n    document.body.classList.add('loadingInProgress');\n    this.bar.classList.remove('hidden');\n  }\n}\n\n/**\n * Moves all elements of an array that satisfy condition to the end of the\n * array, preserving the order of the rest.\n */\nfunction moveToEndOfArray(arr, condition) {\n  const moved = [], len = arr.length;\n  let write = 0;\n  for (let read = 0; read < len; ++read) {\n    if (condition(arr[read])) {\n      moved.push(arr[read]);\n    } else {\n      arr[write] = arr[read];\n      ++write;\n    }\n  }\n  for (let read = 0; write < len; ++read, ++write) {\n    arr[write] = moved[read];\n  }\n}\n\nexport {\n  CSS_UNITS,\n  DEFAULT_SCALE_VALUE,\n  DEFAULT_SCALE,\n  MIN_SCALE,\n  MAX_SCALE,\n  UNKNOWN_SCALE,\n  MAX_AUTO_SCALE,\n  SCROLLBAR_PADDING,\n  VERTICAL_PADDING,\n  isValidRotation,\n  isValidScrollMode,\n  isValidSpreadMode,\n  isPortraitOrientation,\n  PresentationModeState,\n  RendererType,\n  TextLayerMode,\n  ScrollMode,\n  SpreadMode,\n  NullL10n,\n  EventBus,\n  getGlobalEventBus,\n  clamp,\n  ProgressBar,\n  getPDFFileNameFromURL,\n  noContextMenuHandler,\n  parseQueryString,\n  backtrackBeforeAllVisibleElements, // only exported for testing\n  getVisibleElements,\n  roundToDivide,\n  getPageSizeInches,\n  approximateFraction,\n  getOutputScale,\n  scrollIntoView,\n  watchScroll,\n  binarySearchFirstItem,\n  normalizeWheelEventDelta,\n  animationStarted,\n  WaitOnType,\n  waitOnEventOrTimeout,\n  moveToEndOfArray,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals module, __non_webpack_require__ */\n\n'use strict';\n\nlet pdfjsLib;\nif (typeof window !== 'undefined' && window['pdfjs-dist/build/pdf']) {\n  pdfjsLib = window['pdfjs-dist/build/pdf'];\n} else {\n  pdfjsLib = __non_webpack_require__('../build/pdf.js');\n}\nmodule.exports = pdfjsLib;\n","module.exports = require(\"regenerator-runtime\");\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CLEANUP_TIMEOUT = 30000;\n\nconst RenderingStates = {\n  INITIAL: 0,\n  RUNNING: 1,\n  PAUSED: 2,\n  FINISHED: 3,\n};\n\n/**\n * Controls rendering of the views for pages and thumbnails.\n */\nclass PDFRenderingQueue {\n  constructor() {\n    this.pdfViewer = null;\n    this.pdfThumbnailViewer = null;\n    this.onIdle = null;\n    this.highestPriorityPage = null;\n    this.idleTimeout = null;\n    this.printing = false;\n    this.isThumbnailViewEnabled = false;\n  }\n\n  /**\n   * @param {PDFViewer} pdfViewer\n   */\n  setViewer(pdfViewer) {\n    this.pdfViewer = pdfViewer;\n  }\n\n  /**\n   * @param {PDFThumbnailViewer} pdfThumbnailViewer\n   */\n  setThumbnailViewer(pdfThumbnailViewer) {\n    this.pdfThumbnailViewer = pdfThumbnailViewer;\n  }\n\n  /**\n   * @param {IRenderableView} view\n   * @returns {boolean}\n   */\n  isHighestPriority(view) {\n    return this.highestPriorityPage === view.renderingId;\n  }\n\n  /**\n   * @param {Object} currentlyVisiblePages\n   */\n  renderHighestPriority(currentlyVisiblePages) {\n    if (this.idleTimeout) {\n      clearTimeout(this.idleTimeout);\n      this.idleTimeout = null;\n    }\n\n    // Pages have a higher priority than thumbnails, so check them first.\n    if (this.pdfViewer.forceRendering(currentlyVisiblePages)) {\n      return;\n    }\n    // No pages needed rendering, so check thumbnails.\n    if (this.pdfThumbnailViewer && this.isThumbnailViewEnabled) {\n      if (this.pdfThumbnailViewer.forceRendering()) {\n        return;\n      }\n    }\n\n    if (this.printing) {\n      // If printing is currently ongoing do not reschedule cleanup.\n      return;\n    }\n\n    if (this.onIdle) {\n      this.idleTimeout = setTimeout(this.onIdle.bind(this), CLEANUP_TIMEOUT);\n    }\n  }\n\n  /**\n   * @param {Object} visible\n   * @param {Array} views\n   * @param {boolean} scrolledDown\n   */\n  getHighestPriority(visible, views, scrolledDown) {\n    /**\n     * The state has changed. Figure out which page has the highest priority to\n     * render next (if any).\n     *\n     * Priority:\n     * 1. visible pages\n     * 2. if last scrolled down, the page after the visible pages, or\n     *    if last scrolled up, the page before the visible pages\n     */\n    let visibleViews = visible.views;\n\n    let numVisible = visibleViews.length;\n    if (numVisible === 0) {\n      return null;\n    }\n    for (let i = 0; i < numVisible; ++i) {\n      let view = visibleViews[i].view;\n      if (!this.isViewFinished(view)) {\n        return view;\n      }\n    }\n\n    // All the visible views have rendered; try to render next/previous pages.\n    if (scrolledDown) {\n      let nextPageIndex = visible.last.id;\n      // IDs start at 1, so no need to add 1.\n      if (views[nextPageIndex] && !this.isViewFinished(views[nextPageIndex])) {\n        return views[nextPageIndex];\n      }\n    } else {\n      let previousPageIndex = visible.first.id - 2;\n      if (views[previousPageIndex] &&\n          !this.isViewFinished(views[previousPageIndex])) {\n        return views[previousPageIndex];\n      }\n    }\n    // Everything that needs to be rendered has been.\n    return null;\n  }\n\n  /**\n   * @param {IRenderableView} view\n   * @returns {boolean}\n   */\n  isViewFinished(view) {\n    return view.renderingState === RenderingStates.FINISHED;\n  }\n\n  /**\n   * Render a page or thumbnail view. This calls the appropriate function\n   * based on the views state. If the view is already rendered it will return\n   * `false`.\n   *\n   * @param {IRenderableView} view\n   */\n  renderView(view) {\n    switch (view.renderingState) {\n      case RenderingStates.FINISHED:\n        return false;\n      case RenderingStates.PAUSED:\n        this.highestPriorityPage = view.renderingId;\n        view.resume();\n        break;\n      case RenderingStates.RUNNING:\n        this.highestPriorityPage = view.renderingId;\n        break;\n      case RenderingStates.INITIAL:\n        this.highestPriorityPage = view.renderingId;\n        view.draw().finally(() => {\n          this.renderHighestPriority();\n        });\n        break;\n    }\n    return true;\n  }\n}\n\nexport {\n  RenderingStates,\n  PDFRenderingQueue,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals PDFBug, Stats */\n\nimport {\n  animationStarted, DEFAULT_SCALE_VALUE, getGlobalEventBus,\n  getPDFFileNameFromURL, isValidRotation, isValidScrollMode, isValidSpreadMode,\n  MAX_SCALE, MIN_SCALE, noContextMenuHandler, normalizeWheelEventDelta,\n  parseQueryString, PresentationModeState, ProgressBar, RendererType,\n  ScrollMode, SpreadMode, TextLayerMode\n} from './ui_utils';\nimport { AppOptions, OptionKind } from './app_options';\nimport {\n  build, createObjectURL, getDocument, getFilenameFromUrl, GlobalWorkerOptions,\n  InvalidPDFException, LinkTarget, loadScript, MissingPDFException, OPS,\n  PDFWorker, shadow, UnexpectedResponseException, UNSUPPORTED_FEATURES, version\n} from 'pdfjs-lib';\nimport { CursorTool, PDFCursorTools } from './pdf_cursor_tools';\nimport { PDFRenderingQueue, RenderingStates } from './pdf_rendering_queue';\nimport { PDFSidebar, SidebarView } from './pdf_sidebar';\nimport { OverlayManager } from './overlay_manager';\nimport { PasswordPrompt } from './password_prompt';\nimport { PDFAttachmentViewer } from './pdf_attachment_viewer';\nimport { PDFDocumentProperties } from './pdf_document_properties';\nimport { PDFFindBar } from './pdf_find_bar';\nimport { PDFFindController } from './pdf_find_controller';\nimport { PDFHistory } from './pdf_history';\nimport { PDFLinkService } from './pdf_link_service';\nimport { PDFOutlineViewer } from './pdf_outline_viewer';\nimport { PDFPresentationMode } from './pdf_presentation_mode';\nimport { PDFSidebarResizer } from './pdf_sidebar_resizer';\nimport { PDFThumbnailViewer } from './pdf_thumbnail_viewer';\nimport { PDFViewer } from './pdf_viewer';\nimport { SecondaryToolbar } from './secondary_toolbar';\nimport { Toolbar } from './toolbar';\nimport { ViewHistory } from './view_history';\n\nconst DEFAULT_SCALE_DELTA = 1.1;\nconst DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT = 5000; // ms\nconst FORCE_PAGES_LOADED_TIMEOUT = 10000; // ms\nconst WHEEL_ZOOM_DISABLED_TIMEOUT = 1000; // ms\n\nconst ViewOnLoad = {\n  UNKNOWN: -1,\n  PREVIOUS: 0, // Default value.\n  INITIAL: 1,\n};\n\nconst DefaultExternalServices = {\n  updateFindControlState(data) {},\n  updateFindMatchesCount(data) {},\n  initPassiveLoading(callbacks) {},\n  fallback(data, callback) {},\n  reportTelemetry(data) {},\n  createDownloadManager(options) {\n    throw new Error('Not implemented: createDownloadManager');\n  },\n  createPreferences() {\n    throw new Error('Not implemented: createPreferences');\n  },\n  createL10n(options) {\n    throw new Error('Not implemented: createL10n');\n  },\n  supportsIntegratedFind: false,\n  supportsDocumentFonts: true,\n  supportsDocumentColors: true,\n  supportedMouseWheelZoomModifierKeys: {\n    ctrlKey: true,\n    metaKey: true,\n  },\n};\n\nlet PDFViewerApplication = {\n  initialBookmark: document.location.hash.substring(1),\n  initialized: false,\n  fellback: false,\n  appConfig: null,\n  pdfDocument: null,\n  pdfLoadingTask: null,\n  printService: null,\n  /** @type {PDFViewer} */\n  pdfViewer: null,\n  /** @type {PDFThumbnailViewer} */\n  pdfThumbnailViewer: null,\n  /** @type {PDFRenderingQueue} */\n  pdfRenderingQueue: null,\n  /** @type {PDFPresentationMode} */\n  pdfPresentationMode: null,\n  /** @type {PDFDocumentProperties} */\n  pdfDocumentProperties: null,\n  /** @type {PDFLinkService} */\n  pdfLinkService: null,\n  /** @type {PDFHistory} */\n  pdfHistory: null,\n  /** @type {PDFSidebar} */\n  pdfSidebar: null,\n  /** @type {PDFSidebarResizer} */\n  pdfSidebarResizer: null,\n  /** @type {PDFOutlineViewer} */\n  pdfOutlineViewer: null,\n  /** @type {PDFAttachmentViewer} */\n  pdfAttachmentViewer: null,\n  /** @type {PDFCursorTools} */\n  pdfCursorTools: null,\n  /** @type {ViewHistory} */\n  store: null,\n  /** @type {DownloadManager} */\n  downloadManager: null,\n  /** @type {OverlayManager} */\n  overlayManager: null,\n  /** @type {Preferences} */\n  preferences: null,\n  /** @type {Toolbar} */\n  toolbar: null,\n  /** @type {SecondaryToolbar} */\n  secondaryToolbar: null,\n  /** @type {EventBus} */\n  eventBus: null,\n  /** @type {IL10n} */\n  l10n: null,\n  isInitialViewSet: false,\n  downloadComplete: false,\n  isViewerEmbedded: (window.parent !== window),\n  url: '',\n  baseUrl: '',\n  externalServices: DefaultExternalServices,\n  _boundEvents: {},\n  contentDispositionFilename: null,\n\n  // Called once when the document is loaded.\n  async initialize(appConfig) {\n    this.preferences = this.externalServices.createPreferences();\n    this.appConfig = appConfig;\n\n    await this._readPreferences();\n    await this._parseHashParameters();\n    await this._initializeL10n();\n\n    if (this.isViewerEmbedded &&\n        AppOptions.get('externalLinkTarget') === LinkTarget.NONE) {\n      // Prevent external links from \"replacing\" the viewer,\n      // when it's embedded in e.g. an <iframe> or an <object>.\n      AppOptions.set('externalLinkTarget', LinkTarget.TOP);\n    }\n    await this._initializeViewerComponents();\n\n    // Bind the various event handlers *after* the viewer has been\n    // initialized, to prevent errors if an event arrives too soon.\n    this.bindEvents();\n    this.bindWindowEvents();\n\n    // We can start UI localization now.\n    let appContainer = appConfig.appContainer || document.documentElement;\n    this.l10n.translate(appContainer).then(() => {\n      // Dispatch the 'localized' event on the `eventBus` once the viewer\n      // has been fully initialized and translated.\n      this.eventBus.dispatch('localized', { source: this, });\n    });\n\n    this.initialized = true;\n  },\n\n  /**\n   * @private\n   */\n  async _readPreferences() {\n    if (AppOptions.get('disablePreferences') === true) {\n      // Give custom implementations of the default viewer a simpler way to\n      // opt-out of having the `Preferences` override existing `AppOptions`.\n      return;\n    }\n    try {\n      const prefs = await this.preferences.getAll();\n      for (const name in prefs) {\n        AppOptions.set(name, prefs[name]);\n      }\n    } catch (reason) {\n      console.error(`_readPreferences: \"${reason.message}\".`);\n    }\n  },\n\n  /**\n   * @private\n   */\n  async _parseHashParameters() {\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('PRODUCTION') &&\n        !AppOptions.get('pdfBugEnabled')) {\n      return undefined;\n    }\n    const waitOn = [];\n\n    // Special debugging flags in the hash section of the URL.\n    let hash = document.location.hash.substring(1);\n    let hashParams = parseQueryString(hash);\n\n    if ('disableworker' in hashParams &&\n        hashParams['disableworker'] === 'true') {\n      waitOn.push(loadFakeWorker());\n    }\n    if ('disablerange' in hashParams) {\n      AppOptions.set('disableRange', hashParams['disablerange'] === 'true');\n    }\n    if ('disablestream' in hashParams) {\n      AppOptions.set('disableStream', hashParams['disablestream'] === 'true');\n    }\n    if ('disableautofetch' in hashParams) {\n      AppOptions.set('disableAutoFetch',\n                     hashParams['disableautofetch'] === 'true');\n    }\n    if ('disablefontface' in hashParams) {\n      AppOptions.set('disableFontFace',\n                     hashParams['disablefontface'] === 'true');\n    }\n    if ('disablehistory' in hashParams) {\n      AppOptions.set('disableHistory', hashParams['disablehistory'] === 'true');\n    }\n    if ('webgl' in hashParams) {\n      AppOptions.set('enableWebGL', hashParams['webgl'] === 'true');\n    }\n    if ('useonlycsszoom' in hashParams) {\n      AppOptions.set('useOnlyCssZoom', hashParams['useonlycsszoom'] === 'true');\n    }\n    if ('verbosity' in hashParams) {\n      AppOptions.set('verbosity', hashParams['verbosity'] | 0);\n    }\n    if ('textlayer' in hashParams) {\n      switch (hashParams['textlayer']) {\n        case 'off':\n          AppOptions.set('textLayerMode', TextLayerMode.DISABLE);\n          break;\n        case 'visible':\n        case 'shadow':\n        case 'hover':\n          let viewer = this.appConfig.viewerContainer;\n          viewer.classList.add('textLayer-' + hashParams['textlayer']);\n          break;\n      }\n    }\n    if ('pdfbug' in hashParams) {\n      AppOptions.set('pdfBug', true);\n      let enabled = hashParams['pdfbug'].split(',');\n      waitOn.push(loadAndEnablePDFBug(enabled));\n    }\n    // It is not possible to change locale for the (various) extension builds.\n    if ((typeof PDFJSDev === 'undefined' ||\n         PDFJSDev.test('!PRODUCTION || GENERIC')) && 'locale' in hashParams) {\n      AppOptions.set('locale', hashParams['locale']);\n    }\n\n    return Promise.all(waitOn).catch((reason) => {\n      console.error(`_parseHashParameters: \"${reason.message}\".`);\n    });\n  },\n\n  /**\n   * @private\n   */\n  async _initializeL10n() {\n    this.l10n = this.externalServices.createL10n({\n      locale: AppOptions.get('locale'),\n    });\n    const dir = await this.l10n.getDirection();\n    document.getElementsByTagName('html')[0].dir = dir;\n  },\n\n  /**\n   * @private\n   */\n  async _initializeViewerComponents() {\n    const appConfig = this.appConfig;\n\n    this.overlayManager = new OverlayManager();\n\n    const eventBus = appConfig.eventBus ||\n                     getGlobalEventBus(AppOptions.get('eventBusDispatchToDOM'));\n    this.eventBus = eventBus;\n\n    let pdfRenderingQueue = new PDFRenderingQueue();\n    pdfRenderingQueue.onIdle = this.cleanup.bind(this);\n    this.pdfRenderingQueue = pdfRenderingQueue;\n\n    let pdfLinkService = new PDFLinkService({\n      eventBus,\n      externalLinkTarget: AppOptions.get('externalLinkTarget'),\n      externalLinkRel: AppOptions.get('externalLinkRel'),\n    });\n    this.pdfLinkService = pdfLinkService;\n\n    let downloadManager = this.externalServices.createDownloadManager({\n      disableCreateObjectURL: AppOptions.get('disableCreateObjectURL'),\n    });\n    this.downloadManager = downloadManager;\n\n    const findController = new PDFFindController({\n      linkService: pdfLinkService,\n      eventBus,\n    });\n    this.findController = findController;\n\n    const container = appConfig.mainContainer;\n    const viewer = appConfig.viewerContainer;\n    this.pdfViewer = new PDFViewer({\n      container,\n      viewer,\n      eventBus,\n      renderingQueue: pdfRenderingQueue,\n      linkService: pdfLinkService,\n      downloadManager,\n      findController,\n      renderer: AppOptions.get('renderer'),\n      enableWebGL: AppOptions.get('enableWebGL'),\n      l10n: this.l10n,\n      textLayerMode: AppOptions.get('textLayerMode'),\n      imageResourcesPath: AppOptions.get('imageResourcesPath'),\n      renderInteractiveForms: AppOptions.get('renderInteractiveForms'),\n      enablePrintAutoRotate: AppOptions.get('enablePrintAutoRotate'),\n      useOnlyCssZoom: AppOptions.get('useOnlyCssZoom'),\n      maxCanvasPixels: AppOptions.get('maxCanvasPixels'),\n    });\n    pdfRenderingQueue.setViewer(this.pdfViewer);\n    pdfLinkService.setViewer(this.pdfViewer);\n\n    this.pdfThumbnailViewer = new PDFThumbnailViewer({\n      container: appConfig.sidebar.thumbnailView,\n      renderingQueue: pdfRenderingQueue,\n      linkService: pdfLinkService,\n      l10n: this.l10n,\n    });\n    pdfRenderingQueue.setThumbnailViewer(this.pdfThumbnailViewer);\n\n    this.pdfHistory = new PDFHistory({\n      linkService: pdfLinkService,\n      eventBus,\n    });\n    pdfLinkService.setHistory(this.pdfHistory);\n\n    if (!this.supportsIntegratedFind) {\n      this.findBar = new PDFFindBar(appConfig.findBar, eventBus, this.l10n);\n    }\n\n    this.pdfDocumentProperties =\n      new PDFDocumentProperties(appConfig.documentProperties,\n                                this.overlayManager, eventBus, this.l10n);\n\n    this.pdfCursorTools = new PDFCursorTools({\n      container,\n      eventBus,\n      cursorToolOnLoad: AppOptions.get('cursorToolOnLoad'),\n    });\n\n    this.toolbar = new Toolbar(appConfig.toolbar, eventBus, this.l10n);\n\n    this.secondaryToolbar =\n      new SecondaryToolbar(appConfig.secondaryToolbar, container, eventBus);\n\n    if (this.supportsFullscreen) {\n      this.pdfPresentationMode = new PDFPresentationMode({\n        container,\n        viewer,\n        pdfViewer: this.pdfViewer,\n        eventBus,\n        contextMenuItems: appConfig.fullscreen,\n      });\n    }\n\n    this.passwordPrompt = new PasswordPrompt(appConfig.passwordOverlay,\n                                             this.overlayManager, this.l10n);\n\n    this.pdfOutlineViewer = new PDFOutlineViewer({\n      container: appConfig.sidebar.outlineView,\n      eventBus,\n      linkService: pdfLinkService,\n    });\n\n    this.pdfAttachmentViewer = new PDFAttachmentViewer({\n      container: appConfig.sidebar.attachmentsView,\n      eventBus,\n      downloadManager,\n    });\n\n    this.pdfSidebar = new PDFSidebar({\n      elements: appConfig.sidebar,\n      pdfViewer: this.pdfViewer,\n      pdfThumbnailViewer: this.pdfThumbnailViewer,\n      eventBus,\n      l10n: this.l10n,\n    });\n    this.pdfSidebar.onToggled = this.forceRendering.bind(this);\n\n    this.pdfSidebarResizer = new PDFSidebarResizer(appConfig.sidebarResizer,\n                                                   eventBus, this.l10n);\n  },\n\n  run(config) {\n    this.initialize(config).then(webViewerInitialized);\n  },\n\n  zoomIn(ticks) {\n    if (this.pdfViewer.isInPresentationMode) {\n      return;\n    }\n    let newScale = this.pdfViewer.currentScale;\n    do {\n      newScale = (newScale * DEFAULT_SCALE_DELTA).toFixed(2);\n      newScale = Math.ceil(newScale * 10) / 10;\n      newScale = Math.min(MAX_SCALE, newScale);\n    } while (--ticks > 0 && newScale < MAX_SCALE);\n    this.pdfViewer.currentScaleValue = newScale;\n  },\n\n  zoomOut(ticks) {\n    if (this.pdfViewer.isInPresentationMode) {\n      return;\n    }\n    let newScale = this.pdfViewer.currentScale;\n    do {\n      newScale = (newScale / DEFAULT_SCALE_DELTA).toFixed(2);\n      newScale = Math.floor(newScale * 10) / 10;\n      newScale = Math.max(MIN_SCALE, newScale);\n    } while (--ticks > 0 && newScale > MIN_SCALE);\n    this.pdfViewer.currentScaleValue = newScale;\n  },\n\n  zoomReset() {\n    if (this.pdfViewer.isInPresentationMode) {\n      return;\n    }\n    this.pdfViewer.currentScaleValue = DEFAULT_SCALE_VALUE;\n  },\n\n  get pagesCount() {\n    return this.pdfDocument ? this.pdfDocument.numPages : 0;\n  },\n\n  set page(val) {\n    this.pdfViewer.currentPageNumber = val;\n  },\n\n  get page() {\n    return this.pdfViewer.currentPageNumber;\n  },\n\n  get printing() {\n    return !!this.printService;\n  },\n\n  get supportsPrinting() {\n    return PDFPrintServiceFactory.instance.supportsPrinting;\n  },\n\n  get supportsFullscreen() {\n    let support;\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('MOZCENTRAL')) {\n      support = document.fullscreenEnabled === true ||\n                document.mozFullScreenEnabled === true;\n    } else {\n      let doc = document.documentElement;\n      support = !!(doc.requestFullscreen || doc.mozRequestFullScreen ||\n                   doc.webkitRequestFullScreen || doc.msRequestFullscreen);\n\n      if (document.fullscreenEnabled === false ||\n          document.mozFullScreenEnabled === false ||\n          document.webkitFullscreenEnabled === false ||\n          document.msFullscreenEnabled === false) {\n        support = false;\n      }\n    }\n    return shadow(this, 'supportsFullscreen', support);\n  },\n\n  get supportsIntegratedFind() {\n    return this.externalServices.supportsIntegratedFind;\n  },\n\n  get supportsDocumentFonts() {\n    return this.externalServices.supportsDocumentFonts;\n  },\n\n  get supportsDocumentColors() {\n    return this.externalServices.supportsDocumentColors;\n  },\n\n  get loadingBar() {\n    let bar = new ProgressBar('#loadingBar');\n    return shadow(this, 'loadingBar', bar);\n  },\n\n  get supportedMouseWheelZoomModifierKeys() {\n    return this.externalServices.supportedMouseWheelZoomModifierKeys;\n  },\n\n  initPassiveLoading() {\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n      throw new Error('Not implemented: initPassiveLoading');\n    }\n    this.externalServices.initPassiveLoading({\n      onOpenWithTransport(url, length, transport) {\n        PDFViewerApplication.open(url, { length, range: transport, });\n      },\n      onOpenWithData(data) {\n        PDFViewerApplication.open(data);\n      },\n      onOpenWithURL(url, length, originalUrl) {\n        let file = url, args = null;\n        if (length !== undefined) {\n          args = { length, };\n        }\n        if (originalUrl !== undefined) {\n          file = { url, originalUrl, };\n        }\n        PDFViewerApplication.open(file, args);\n      },\n      onError(err) {\n        PDFViewerApplication.l10n.get('loading_error', null,\n            'An error occurred while loading the PDF.').then((msg) => {\n          PDFViewerApplication.error(msg, err);\n        });\n      },\n      onProgress(loaded, total) {\n        PDFViewerApplication.progress(loaded / total);\n      },\n    });\n  },\n\n  setTitleUsingUrl(url = '') {\n    this.url = url;\n    this.baseUrl = url.split('#')[0];\n    let title = getPDFFileNameFromURL(url, '');\n    if (!title) {\n      try {\n        title = decodeURIComponent(getFilenameFromUrl(url)) || url;\n      } catch (ex) {\n        // decodeURIComponent may throw URIError,\n        // fall back to using the unprocessed url in that case\n        title = url;\n      }\n    }\n    this.setTitle(title);\n  },\n\n  setTitle(title) {\n    if (this.isViewerEmbedded) {\n      // Embedded PDF viewers should not be changing their parent page's title.\n      return;\n    }\n    document.title = title;\n  },\n\n  /**\n   * Closes opened PDF document.\n   * @returns {Promise} - Returns the promise, which is resolved when all\n   *                      destruction is completed.\n   */\n  async close() {\n    let errorWrapper = this.appConfig.errorWrapper.container;\n    errorWrapper.setAttribute('hidden', 'true');\n\n    if (!this.pdfLoadingTask) {\n      return undefined;\n    }\n\n    let promise = this.pdfLoadingTask.destroy();\n    this.pdfLoadingTask = null;\n\n    if (this.pdfDocument) {\n      this.pdfDocument = null;\n\n      this.pdfThumbnailViewer.setDocument(null);\n      this.pdfViewer.setDocument(null);\n      this.pdfLinkService.setDocument(null);\n      this.pdfDocumentProperties.setDocument(null);\n    }\n    this.store = null;\n    this.isInitialViewSet = false;\n    this.downloadComplete = false;\n    this.url = '';\n    this.baseUrl = '';\n    this.contentDispositionFilename = null;\n\n    this.pdfSidebar.reset();\n    this.pdfOutlineViewer.reset();\n    this.pdfAttachmentViewer.reset();\n\n    if (this.findBar) {\n      this.findBar.reset();\n    }\n    this.toolbar.reset();\n    this.secondaryToolbar.reset();\n\n    if (typeof PDFBug !== 'undefined') {\n      PDFBug.cleanup();\n    }\n    return promise;\n  },\n\n  /**\n   * Opens PDF document specified by URL or array with additional arguments.\n   * @param {string|TypedArray|ArrayBuffer} file - PDF location or binary data.\n   * @param {Object} [args] - Additional arguments for the getDocument call,\n   *                          e.g. HTTP headers ('httpHeaders') or alternative\n   *                          data transport ('range').\n   * @returns {Promise} - Returns the promise, which is resolved when document\n   *                      is opened.\n   */\n  async open(file, args) {\n    if (this.pdfLoadingTask) {\n      // We need to destroy already opened document.\n      await this.close();\n    }\n    // Set the necessary global worker parameters, using the available options.\n    const workerParameters = AppOptions.getAll(OptionKind.WORKER);\n    for (let key in workerParameters) {\n      GlobalWorkerOptions[key] = workerParameters[key];\n    }\n\n    let parameters = Object.create(null);\n    if (typeof file === 'string') { // URL\n      this.setTitleUsingUrl(file);\n      parameters.url = file;\n    } else if (file && 'byteLength' in file) { // ArrayBuffer\n      parameters.data = file;\n    } else if (file.url && file.originalUrl) {\n      this.setTitleUsingUrl(file.originalUrl);\n      parameters.url = file.url;\n    }\n    // Set the necessary API parameters, using the available options.\n    const apiParameters = AppOptions.getAll(OptionKind.API);\n    for (let key in apiParameters) {\n      let value = apiParameters[key];\n\n      if (key === 'docBaseUrl' && !value) {\n        if (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION')) {\n          value = document.URL.split('#')[0];\n        } else if (typeof PDFJSDev !== 'undefined' &&\n                   PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n          value = this.baseUrl;\n        }\n      }\n      parameters[key] = value;\n    }\n\n    if (args) {\n      for (let key in args) {\n        const value = args[key];\n\n        if (key === 'length') {\n          this.pdfDocumentProperties.setFileSize(value);\n        }\n        parameters[key] = value;\n      }\n    }\n\n    let loadingTask = getDocument(parameters);\n    this.pdfLoadingTask = loadingTask;\n\n    loadingTask.onPassword = (updateCallback, reason) => {\n      this.pdfLinkService.externalLinkEnabled = false;\n      this.passwordPrompt.setUpdateCallback(updateCallback, reason);\n      this.passwordPrompt.open();\n    };\n\n    loadingTask.onProgress = ({ loaded, total, }) => {\n      this.progress(loaded / total);\n    };\n\n    // Listen for unsupported features to trigger the fallback UI.\n    loadingTask.onUnsupportedFeature = this.fallback.bind(this);\n\n    return loadingTask.promise.then((pdfDocument) => {\n      this.load(pdfDocument);\n    }, (exception) => {\n      if (loadingTask !== this.pdfLoadingTask) {\n        return undefined; // Ignore errors for previously opened PDF files.\n      }\n\n      let message = exception && exception.message;\n      let loadingErrorMessage;\n      if (exception instanceof InvalidPDFException) {\n        // change error message also for other builds\n        loadingErrorMessage = this.l10n.get('invalid_file_error', null,\n                                            'Invalid or corrupted PDF file.');\n      } else if (exception instanceof MissingPDFException) {\n        // special message for missing PDF's\n        loadingErrorMessage = this.l10n.get('missing_file_error', null,\n                                            'Missing PDF file.');\n      } else if (exception instanceof UnexpectedResponseException) {\n        loadingErrorMessage = this.l10n.get('unexpected_response_error', null,\n                                            'Unexpected server response.');\n      } else {\n        loadingErrorMessage = this.l10n.get('loading_error', null,\n          'An error occurred while loading the PDF.');\n      }\n\n      return loadingErrorMessage.then((msg) => {\n        this.error(msg, { message, });\n        throw new Error(msg);\n      });\n    });\n  },\n\n  download() {\n    function downloadByUrl() {\n      downloadManager.downloadUrl(url, filename);\n    }\n\n    let url = this.baseUrl;\n    // Use this.url instead of this.baseUrl to perform filename detection based\n    // on the reference fragment as ultimate fallback if needed.\n    let filename = this.contentDispositionFilename ||\n      getPDFFileNameFromURL(this.url);\n    let downloadManager = this.downloadManager;\n    downloadManager.onerror = (err) => {\n      // This error won't really be helpful because it's likely the\n      // fallback won't work either (or is already open).\n      this.error(`PDF failed to download: ${err}`);\n    };\n\n    // When the PDF document isn't ready, or the PDF file is still downloading,\n    // simply download using the URL.\n    if (!this.pdfDocument || !this.downloadComplete) {\n      downloadByUrl();\n      return;\n    }\n\n    this.pdfDocument.getData().then(function(data) {\n      const blob = new Blob([data], { type: 'application/pdf', });\n      downloadManager.download(blob, url, filename);\n    }).catch(downloadByUrl); // Error occurred, try downloading with the URL.\n  },\n\n  fallback(featureId) {\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      // Only trigger the fallback once so we don't spam the user with messages\n      // for one PDF.\n      if (this.fellback) {\n        return;\n      }\n      this.fellback = true;\n      this.externalServices.fallback({\n        featureId,\n        url: this.baseUrl,\n      }, function response(download) {\n        if (!download) {\n          return;\n        }\n        PDFViewerApplication.download();\n      });\n    }\n  },\n\n  /**\n   * Show the error box.\n   * @param {string} message - A message that is human readable.\n   * @param {Object} [moreInfo] - Further information about the error that is\n   *                              more technical.  Should have a 'message' and\n   *                              optionally a 'stack' property.\n   */\n  error(message, moreInfo) {\n    let moreInfoText = [this.l10n.get('error_version_info',\n      { version: version || '?', build: build || '?', },\n      'PDF.js v{{version}} (build: {{build}})')];\n    if (moreInfo) {\n      moreInfoText.push(\n        this.l10n.get('error_message', { message: moreInfo.message, },\n                      'Message: {{message}}'));\n      if (moreInfo.stack) {\n        moreInfoText.push(\n          this.l10n.get('error_stack', { stack: moreInfo.stack, },\n                        'Stack: {{stack}}'));\n      } else {\n        if (moreInfo.filename) {\n          moreInfoText.push(\n            this.l10n.get('error_file', { file: moreInfo.filename, },\n                          'File: {{file}}'));\n        }\n        if (moreInfo.lineNumber) {\n          moreInfoText.push(\n            this.l10n.get('error_line', { line: moreInfo.lineNumber, },\n                          'Line: {{line}}'));\n        }\n      }\n    }\n\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      let errorWrapperConfig = this.appConfig.errorWrapper;\n      let errorWrapper = errorWrapperConfig.container;\n      errorWrapper.removeAttribute('hidden');\n\n      let errorMessage = errorWrapperConfig.errorMessage;\n      errorMessage.textContent = message;\n\n      let closeButton = errorWrapperConfig.closeButton;\n      closeButton.onclick = function() {\n        errorWrapper.setAttribute('hidden', 'true');\n      };\n\n      let errorMoreInfo = errorWrapperConfig.errorMoreInfo;\n      let moreInfoButton = errorWrapperConfig.moreInfoButton;\n      let lessInfoButton = errorWrapperConfig.lessInfoButton;\n      moreInfoButton.onclick = function() {\n        errorMoreInfo.removeAttribute('hidden');\n        moreInfoButton.setAttribute('hidden', 'true');\n        lessInfoButton.removeAttribute('hidden');\n        errorMoreInfo.style.height = errorMoreInfo.scrollHeight + 'px';\n      };\n      lessInfoButton.onclick = function() {\n        errorMoreInfo.setAttribute('hidden', 'true');\n        moreInfoButton.removeAttribute('hidden');\n        lessInfoButton.setAttribute('hidden', 'true');\n      };\n      moreInfoButton.oncontextmenu = noContextMenuHandler;\n      lessInfoButton.oncontextmenu = noContextMenuHandler;\n      closeButton.oncontextmenu = noContextMenuHandler;\n      moreInfoButton.removeAttribute('hidden');\n      lessInfoButton.setAttribute('hidden', 'true');\n      Promise.all(moreInfoText).then((parts) => {\n        errorMoreInfo.value = parts.join('\\n');\n      });\n    } else {\n      Promise.all(moreInfoText).then((parts) => {\n        console.error(message + '\\n' + parts.join('\\n'));\n      });\n      this.fallback();\n    }\n  },\n\n  progress(level) {\n    if (this.downloadComplete) {\n      // Don't accidentally show the loading bar again when the entire file has\n      // already been fetched (only an issue when disableAutoFetch is enabled).\n      return;\n    }\n    let percent = Math.round(level * 100);\n    // When we transition from full request to range requests, it's possible\n    // that we discard some of the loaded data. This can cause the loading\n    // bar to move backwards. So prevent this by only updating the bar if it\n    // increases.\n    if (percent > this.loadingBar.percent || isNaN(percent)) {\n      this.loadingBar.percent = percent;\n\n      // When disableAutoFetch is enabled, it's not uncommon for the entire file\n      // to never be fetched (depends on e.g. the file structure). In this case\n      // the loading bar will not be completely filled, nor will it be hidden.\n      // To prevent displaying a partially filled loading bar permanently, we\n      // hide it when no data has been loaded during a certain amount of time.\n      const disableAutoFetch = this.pdfDocument ?\n        this.pdfDocument.loadingParams['disableAutoFetch'] :\n        AppOptions.get('disableAutoFetch');\n\n      if (disableAutoFetch && percent) {\n        if (this.disableAutoFetchLoadingBarTimeout) {\n          clearTimeout(this.disableAutoFetchLoadingBarTimeout);\n          this.disableAutoFetchLoadingBarTimeout = null;\n        }\n        this.loadingBar.show();\n\n        this.disableAutoFetchLoadingBarTimeout = setTimeout(() => {\n          this.loadingBar.hide();\n          this.disableAutoFetchLoadingBarTimeout = null;\n        }, DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT);\n      }\n    }\n  },\n\n  load(pdfDocument) {\n    this.pdfDocument = pdfDocument;\n\n    pdfDocument.getDownloadInfo().then(() => {\n      this.downloadComplete = true;\n      this.loadingBar.hide();\n\n      firstPagePromise.then(() => {\n        this.eventBus.dispatch('documentloaded', { source: this, });\n      });\n    });\n\n    // Since the `setInitialView` call below depends on this being resolved,\n    // fetch it early to avoid delaying initial rendering of the PDF document.\n    const pageLayoutPromise = pdfDocument.getPageLayout().catch(\n      function() { /* Avoid breaking initial rendering; ignoring errors. */ });\n    const pageModePromise = pdfDocument.getPageMode().catch(\n      function() { /* Avoid breaking initial rendering; ignoring errors. */ });\n    const openActionDestPromise = pdfDocument.getOpenActionDestination().catch(\n      function() { /* Avoid breaking initial rendering; ignoring errors. */ });\n\n    this.toolbar.setPagesCount(pdfDocument.numPages, false);\n    this.secondaryToolbar.setPagesCount(pdfDocument.numPages);\n\n    const store = this.store = new ViewHistory(pdfDocument.fingerprint);\n\n    let baseDocumentUrl;\n    if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n      baseDocumentUrl = null;\n    } else if (PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      baseDocumentUrl = this.baseUrl;\n    } else if (PDFJSDev.test('CHROME')) {\n      baseDocumentUrl = location.href.split('#')[0];\n    }\n    this.pdfLinkService.setDocument(pdfDocument, baseDocumentUrl);\n    this.pdfDocumentProperties.setDocument(pdfDocument, this.url);\n\n    let pdfViewer = this.pdfViewer;\n    pdfViewer.setDocument(pdfDocument);\n    let firstPagePromise = pdfViewer.firstPagePromise;\n    let pagesPromise = pdfViewer.pagesPromise;\n    let onePageRendered = pdfViewer.onePageRendered;\n\n    let pdfThumbnailViewer = this.pdfThumbnailViewer;\n    pdfThumbnailViewer.setDocument(pdfDocument);\n\n    firstPagePromise.then((pdfPage) => {\n      this.loadingBar.setWidth(this.appConfig.viewerContainer);\n\n      const storePromise = store.getMultiple({\n        page: null,\n        zoom: DEFAULT_SCALE_VALUE,\n        scrollLeft: '0',\n        scrollTop: '0',\n        rotation: null,\n        sidebarView: SidebarView.UNKNOWN,\n        scrollMode: ScrollMode.UNKNOWN,\n        spreadMode: SpreadMode.UNKNOWN,\n      }).catch(() => { /* Unable to read from storage; ignoring errors. */ });\n\n      Promise.all([\n        animationStarted,\n        storePromise,\n        pageLayoutPromise,\n        pageModePromise,\n        openActionDestPromise,\n      ]).then(async ([timeStamp, values = {}, pageLayout, pageMode,\n                      openActionDest]) => {\n        const viewOnLoad = AppOptions.get('viewOnLoad');\n\n        this._initializePdfHistory({\n          fingerprint: pdfDocument.fingerprint,\n          viewOnLoad,\n          initialDest: openActionDest,\n        });\n        const initialBookmark = this.initialBookmark;\n\n        // Initialize the default values, from user preferences.\n        const zoom = AppOptions.get('defaultZoomValue');\n        let hash = zoom ? `zoom=${zoom}` : null;\n\n        let rotation = null;\n        let sidebarView = AppOptions.get('sidebarViewOnLoad');\n        let scrollMode = AppOptions.get('scrollModeOnLoad');\n        let spreadMode = AppOptions.get('spreadModeOnLoad');\n\n        if (values.page && viewOnLoad !== ViewOnLoad.INITIAL) {\n          hash = `page=${values.page}&zoom=${zoom || values.zoom},` +\n                 `${values.scrollLeft},${values.scrollTop}`;\n\n          rotation = parseInt(values.rotation, 10);\n          // Always let user preferences take precedence over the view history.\n          if (sidebarView === SidebarView.UNKNOWN) {\n            sidebarView = (values.sidebarView | 0);\n          }\n          if (scrollMode === ScrollMode.UNKNOWN) {\n            scrollMode = (values.scrollMode | 0);\n          }\n          if (spreadMode === SpreadMode.UNKNOWN) {\n            spreadMode = (values.spreadMode | 0);\n          }\n        }\n        // Always let the user preference/view history take precedence.\n        if (pageMode && sidebarView === SidebarView.UNKNOWN) {\n          sidebarView = apiPageModeToSidebarView(pageMode);\n        }\n        if (pageLayout && spreadMode === SpreadMode.UNKNOWN) {\n          spreadMode = apiPageLayoutToSpreadMode(pageLayout);\n        }\n\n        this.setInitialView(hash, {\n          rotation, sidebarView, scrollMode, spreadMode,\n        });\n        this.eventBus.dispatch('documentinit', { source: this, });\n        // Make all navigation keys work on document load,\n        // unless the viewer is embedded in a web page.\n        if (!this.isViewerEmbedded) {\n          pdfViewer.focus();\n        }\n\n        // For documents with different page sizes, once all pages are resolved,\n        // ensure that the correct location becomes visible on load.\n        // (To reduce the risk, in very large and/or slow loading documents,\n        //  that the location changes *after* the user has started interacting\n        //  with the viewer, wait for either `pagesPromise` or a timeout.)\n        await Promise.race([\n          pagesPromise,\n          new Promise((resolve) => {\n            setTimeout(resolve, FORCE_PAGES_LOADED_TIMEOUT);\n          }),\n        ]);\n        if (!initialBookmark && !hash) {\n          return;\n        }\n        if (pdfViewer.hasEqualPageSizes) {\n          return;\n        }\n        this.initialBookmark = initialBookmark;\n\n        // eslint-disable-next-line no-self-assign\n        pdfViewer.currentScaleValue = pdfViewer.currentScaleValue;\n        // Re-apply the initial document location.\n        this.setInitialView(hash);\n      }).catch(() => {\n        // Ensure that the document is always completely initialized,\n        // even if there are any errors thrown above.\n        this.setInitialView();\n      }).then(function() {\n        // At this point, rendering of the initial page(s) should always have\n        // started (and may even have completed).\n        // To prevent any future issues, e.g. the document being completely\n        // blank on load, always trigger rendering here.\n        pdfViewer.update();\n      });\n    });\n\n    pdfDocument.getPageLabels().then((labels) => {\n      if (!labels || AppOptions.get('disablePageLabels')) {\n        return;\n      }\n      let i = 0, numLabels = labels.length;\n      if (numLabels !== this.pagesCount) {\n        console.error('The number of Page Labels does not match ' +\n                      'the number of pages in the document.');\n        return;\n      }\n      // Ignore page labels that correspond to standard page numbering.\n      while (i < numLabels && labels[i] === (i + 1).toString()) {\n        i++;\n      }\n      if (i === numLabels) {\n        return;\n      }\n\n      pdfViewer.setPageLabels(labels);\n      pdfThumbnailViewer.setPageLabels(labels);\n\n      // Changing toolbar page display to use labels and we need to set\n      // the label of the current page.\n      this.toolbar.setPagesCount(pdfDocument.numPages, true);\n      this.toolbar.setPageNumber(pdfViewer.currentPageNumber,\n                                 pdfViewer.currentPageLabel);\n    });\n\n    pagesPromise.then(() => {\n      if (!this.supportsPrinting) {\n        return;\n      }\n      pdfDocument.getJavaScript().then((javaScript) => {\n        if (!javaScript) {\n          return;\n        }\n        javaScript.some((js) => {\n          if (!js) { // Don't warn/fallback for empty JavaScript actions.\n            return false;\n          }\n          console.warn('Warning: JavaScript is not supported');\n          this.fallback(UNSUPPORTED_FEATURES.javaScript);\n          return true;\n        });\n\n        // Hack to support auto printing.\n        let regex = /\\bprint\\s*\\(/;\n        for (let i = 0, ii = javaScript.length; i < ii; i++) {\n          let js = javaScript[i];\n          if (js && regex.test(js)) {\n            setTimeout(function() {\n              window.print();\n            });\n            return;\n          }\n        }\n      });\n    });\n\n    onePageRendered.then(() => {\n      pdfDocument.getOutline().then((outline) => {\n        this.pdfOutlineViewer.render({ outline, });\n      });\n      pdfDocument.getAttachments().then((attachments) => {\n        this.pdfAttachmentViewer.render({ attachments, });\n      });\n    });\n\n    pdfDocument.getMetadata().then(\n        ({ info, metadata, contentDispositionFilename, }) => {\n      this.documentInfo = info;\n      this.metadata = metadata;\n      this.contentDispositionFilename = contentDispositionFilename;\n\n      // Provides some basic debug information\n      console.log('PDF ' + pdfDocument.fingerprint + ' [' +\n                  info.PDFFormatVersion + ' ' + (info.Producer || '-').trim() +\n                  ' / ' + (info.Creator || '-').trim() + ']' +\n                  ' (PDF.js: ' + (version || '-') +\n                  (AppOptions.get('enableWebGL') ? ' [WebGL]' : '') + ')');\n\n      let pdfTitle;\n      if (metadata && metadata.has('dc:title')) {\n        let title = metadata.get('dc:title');\n        // Ghostscript sometimes return 'Untitled', sets the title to 'Untitled'\n        if (title !== 'Untitled') {\n          pdfTitle = title;\n        }\n      }\n\n      if (!pdfTitle && info && info['Title']) {\n        pdfTitle = info['Title'];\n      }\n\n      if (pdfTitle) {\n        this.setTitle(\n          `${pdfTitle} - ${contentDispositionFilename || document.title}`);\n      } else if (contentDispositionFilename) {\n        this.setTitle(contentDispositionFilename);\n      }\n\n      if (info.IsAcroFormPresent) {\n        console.warn('Warning: AcroForm/XFA is not supported');\n        this.fallback(UNSUPPORTED_FEATURES.forms);\n      }\n\n      if (typeof PDFJSDev !== 'undefined' &&\n          PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        // Telemetry labels must be C++ variable friendly.\n        const versionId = `v${info.PDFFormatVersion.replace('.', '_')}`;\n        let generatorId = 'other';\n        // Keep these in sync with mozilla central's Histograms.json.\n        const KNOWN_GENERATORS = [\n          'acrobat distiller', 'acrobat pdfwriter', 'adobe livecycle',\n          'adobe pdf library', 'adobe photoshop', 'ghostscript', 'tcpdf',\n          'cairo', 'dvipdfm', 'dvips', 'pdftex', 'pdfkit', 'itext', 'prince',\n          'quarkxpress', 'mac os x', 'microsoft', 'openoffice', 'oracle',\n          'luradocument', 'pdf-xchange', 'antenna house', 'aspose.cells', 'fpdf'\n        ];\n        if (info.Producer) {\n          KNOWN_GENERATORS.some(function (generator, s, i) {\n            if (!generator.includes(s)) {\n              return false;\n            }\n            generatorId = s.replace(/[ .\\-]/g, '_');\n            return true;\n          }.bind(null, info.Producer.toLowerCase()));\n        }\n        let formType = !info.IsAcroFormPresent ? null : info.IsXFAPresent ?\n                      'xfa' : 'acroform';\n        this.externalServices.reportTelemetry({\n          type: 'documentInfo',\n          version: versionId,\n          generator: generatorId,\n          formType,\n        });\n      }\n    });\n  },\n\n  /**\n   * @private\n   */\n  _initializePdfHistory({ fingerprint, viewOnLoad, initialDest = null, }) {\n    if (AppOptions.get('disableHistory') || this.isViewerEmbedded) {\n      // The browsing history is only enabled when the viewer is standalone,\n      // i.e. not when it is embedded in a web page.\n      return;\n    }\n    this.pdfHistory.initialize({\n      fingerprint,\n      resetHistory: viewOnLoad === ViewOnLoad.INITIAL,\n      updateUrl: AppOptions.get('historyUpdateUrl'),\n    });\n\n    if (this.pdfHistory.initialBookmark) {\n      this.initialBookmark = this.pdfHistory.initialBookmark;\n\n      this.initialRotation = this.pdfHistory.initialRotation;\n    }\n\n    // Always let the browser history/document hash take precedence.\n    if (initialDest && !this.initialBookmark &&\n        viewOnLoad === ViewOnLoad.UNKNOWN) {\n      this.initialBookmark = JSON.stringify(initialDest);\n      // TODO: Re-factor the `PDFHistory` initialization to remove this hack\n      // that's currently necessary to prevent weird initial history state.\n      this.pdfHistory.push({ explicitDest: initialDest, pageNumber: null, });\n    }\n  },\n\n  setInitialView(storedHash, { rotation, sidebarView,\n                               scrollMode, spreadMode, } = {}) {\n    const setRotation = (angle) => {\n      if (isValidRotation(angle)) {\n        this.pdfViewer.pagesRotation = angle;\n      }\n    };\n    const setViewerModes = (scroll, spread) => {\n      if (isValidScrollMode(scroll)) {\n        this.pdfViewer.scrollMode = scroll;\n      }\n      if (isValidSpreadMode(spread)) {\n        this.pdfViewer.spreadMode = spread;\n      }\n    };\n    this.isInitialViewSet = true;\n    this.pdfSidebar.setInitialView(sidebarView);\n\n    setViewerModes(scrollMode, spreadMode);\n\n    if (this.initialBookmark) {\n      setRotation(this.initialRotation);\n      delete this.initialRotation;\n\n      this.pdfLinkService.setHash(this.initialBookmark);\n      this.initialBookmark = null;\n    } else if (storedHash) {\n      setRotation(rotation);\n\n      this.pdfLinkService.setHash(storedHash);\n    }\n\n    // Ensure that the correct page number is displayed in the UI,\n    // even if the active page didn't change during document load.\n    this.toolbar.setPageNumber(this.pdfViewer.currentPageNumber,\n                               this.pdfViewer.currentPageLabel);\n    this.secondaryToolbar.setPageNumber(this.pdfViewer.currentPageNumber);\n\n    if (!this.pdfViewer.currentScaleValue) {\n      // Scale was not initialized: invalid bookmark or scale was not specified.\n      // Setting the default one.\n      this.pdfViewer.currentScaleValue = DEFAULT_SCALE_VALUE;\n    }\n  },\n\n  cleanup() {\n    if (!this.pdfDocument) {\n      return; // run cleanup when document is loaded\n    }\n    this.pdfViewer.cleanup();\n    this.pdfThumbnailViewer.cleanup();\n\n    // We don't want to remove fonts used by active page SVGs.\n    if (this.pdfViewer.renderer !== RendererType.SVG) {\n      this.pdfDocument.cleanup();\n    }\n  },\n\n  forceRendering() {\n    this.pdfRenderingQueue.printing = this.printing;\n    this.pdfRenderingQueue.isThumbnailViewEnabled =\n      this.pdfSidebar.isThumbnailViewVisible;\n    this.pdfRenderingQueue.renderHighestPriority();\n  },\n\n  beforePrint() {\n    if (this.printService) {\n      // There is no way to suppress beforePrint/afterPrint events,\n      // but PDFPrintService may generate double events -- this will ignore\n      // the second event that will be coming from native window.print().\n      return;\n    }\n\n    if (!this.supportsPrinting) {\n      this.l10n.get('printing_not_supported', null,\n                    'Warning: Printing is not fully supported by ' +\n                    'this browser.').then((printMessage) => {\n        this.error(printMessage);\n      });\n      return;\n    }\n\n    // The beforePrint is a sync method and we need to know layout before\n    // returning from this method. Ensure that we can get sizes of the pages.\n    if (!this.pdfViewer.pageViewsReady) {\n      this.l10n.get('printing_not_ready', null,\n                    'Warning: The PDF is not fully loaded for printing.').\n          then((notReadyMessage) => {\n        window.alert(notReadyMessage);\n      });\n      return;\n    }\n\n    let pagesOverview = this.pdfViewer.getPagesOverview();\n    let printContainer = this.appConfig.printContainer;\n    let printService = PDFPrintServiceFactory.instance.createPrintService(\n      this.pdfDocument, pagesOverview, printContainer, this.l10n);\n    this.printService = printService;\n    this.forceRendering();\n\n    printService.layout();\n\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      this.externalServices.reportTelemetry({\n        type: 'print',\n      });\n    }\n  },\n\n  afterPrint() {\n    if (this.printService) {\n      this.printService.destroy();\n      this.printService = null;\n    }\n    this.forceRendering();\n  },\n\n  rotatePages(delta) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let newRotation = (this.pdfViewer.pagesRotation + 360 + delta) % 360;\n    this.pdfViewer.pagesRotation = newRotation;\n    // Note that the thumbnail viewer is updated, and rendering is triggered,\n    // in the 'rotationchanging' event handler.\n  },\n\n  requestPresentationMode() {\n    if (!this.pdfPresentationMode) {\n      return;\n    }\n    this.pdfPresentationMode.request();\n  },\n\n  bindEvents() {\n    let { eventBus, _boundEvents, } = this;\n\n    _boundEvents.beforePrint = this.beforePrint.bind(this);\n    _boundEvents.afterPrint = this.afterPrint.bind(this);\n\n    eventBus.on('resize', webViewerResize);\n    eventBus.on('hashchange', webViewerHashchange);\n    eventBus.on('beforeprint', _boundEvents.beforePrint);\n    eventBus.on('afterprint', _boundEvents.afterPrint);\n    eventBus.on('pagerendered', webViewerPageRendered);\n    eventBus.on('textlayerrendered', webViewerTextLayerRendered);\n    eventBus.on('updateviewarea', webViewerUpdateViewarea);\n    eventBus.on('pagechanging', webViewerPageChanging);\n    eventBus.on('scalechanging', webViewerScaleChanging);\n    eventBus.on('rotationchanging', webViewerRotationChanging);\n    eventBus.on('sidebarviewchanged', webViewerSidebarViewChanged);\n    eventBus.on('pagemode', webViewerPageMode);\n    eventBus.on('namedaction', webViewerNamedAction);\n    eventBus.on('presentationmodechanged', webViewerPresentationModeChanged);\n    eventBus.on('presentationmode', webViewerPresentationMode);\n    eventBus.on('openfile', webViewerOpenFile);\n    eventBus.on('print', webViewerPrint);\n    eventBus.on('download', webViewerDownload);\n    eventBus.on('firstpage', webViewerFirstPage);\n    eventBus.on('lastpage', webViewerLastPage);\n    eventBus.on('nextpage', webViewerNextPage);\n    eventBus.on('previouspage', webViewerPreviousPage);\n    eventBus.on('zoomin', webViewerZoomIn);\n    eventBus.on('zoomout', webViewerZoomOut);\n    eventBus.on('zoomreset', webViewerZoomReset);\n    eventBus.on('pagenumberchanged', webViewerPageNumberChanged);\n    eventBus.on('scalechanged', webViewerScaleChanged);\n    eventBus.on('rotatecw', webViewerRotateCw);\n    eventBus.on('rotateccw', webViewerRotateCcw);\n    eventBus.on('switchscrollmode', webViewerSwitchScrollMode);\n    eventBus.on('scrollmodechanged', webViewerScrollModeChanged);\n    eventBus.on('switchspreadmode', webViewerSwitchSpreadMode);\n    eventBus.on('spreadmodechanged', webViewerSpreadModeChanged);\n    eventBus.on('documentproperties', webViewerDocumentProperties);\n    eventBus.on('find', webViewerFind);\n    eventBus.on('findfromurlhash', webViewerFindFromUrlHash);\n    eventBus.on('updatefindmatchescount', webViewerUpdateFindMatchesCount);\n    eventBus.on('updatefindcontrolstate', webViewerUpdateFindControlState);\n    if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n      eventBus.on('fileinputchange', webViewerFileInputChange);\n    }\n  },\n\n  bindWindowEvents() {\n    let { eventBus, _boundEvents, } = this;\n\n    _boundEvents.windowResize = () => {\n      eventBus.dispatch('resize', { source: window, });\n    };\n    _boundEvents.windowHashChange = () => {\n      eventBus.dispatch('hashchange', {\n        source: window,\n        hash: document.location.hash.substring(1),\n      });\n    };\n    _boundEvents.windowBeforePrint = () => {\n      eventBus.dispatch('beforeprint', { source: window, });\n    };\n    _boundEvents.windowAfterPrint = () => {\n      eventBus.dispatch('afterprint', { source: window, });\n    };\n\n    window.addEventListener('visibilitychange', webViewerVisibilityChange);\n    window.addEventListener('wheel', webViewerWheel, { passive: false, });\n    window.addEventListener('click', webViewerClick);\n    window.addEventListener('keydown', webViewerKeyDown);\n    window.addEventListener('resize', _boundEvents.windowResize);\n    window.addEventListener('hashchange', _boundEvents.windowHashChange);\n    window.addEventListener('beforeprint', _boundEvents.windowBeforePrint);\n    window.addEventListener('afterprint', _boundEvents.windowAfterPrint);\n  },\n\n  unbindEvents() {\n    let { eventBus, _boundEvents, } = this;\n\n    eventBus.off('resize', webViewerResize);\n    eventBus.off('hashchange', webViewerHashchange);\n    eventBus.off('beforeprint', _boundEvents.beforePrint);\n    eventBus.off('afterprint', _boundEvents.afterPrint);\n    eventBus.off('pagerendered', webViewerPageRendered);\n    eventBus.off('textlayerrendered', webViewerTextLayerRendered);\n    eventBus.off('updateviewarea', webViewerUpdateViewarea);\n    eventBus.off('pagechanging', webViewerPageChanging);\n    eventBus.off('scalechanging', webViewerScaleChanging);\n    eventBus.off('rotationchanging', webViewerRotationChanging);\n    eventBus.off('sidebarviewchanged', webViewerSidebarViewChanged);\n    eventBus.off('pagemode', webViewerPageMode);\n    eventBus.off('namedaction', webViewerNamedAction);\n    eventBus.off('presentationmodechanged', webViewerPresentationModeChanged);\n    eventBus.off('presentationmode', webViewerPresentationMode);\n    eventBus.off('openfile', webViewerOpenFile);\n    eventBus.off('print', webViewerPrint);\n    eventBus.off('download', webViewerDownload);\n    eventBus.off('firstpage', webViewerFirstPage);\n    eventBus.off('lastpage', webViewerLastPage);\n    eventBus.off('nextpage', webViewerNextPage);\n    eventBus.off('previouspage', webViewerPreviousPage);\n    eventBus.off('zoomin', webViewerZoomIn);\n    eventBus.off('zoomout', webViewerZoomOut);\n    eventBus.off('zoomreset', webViewerZoomReset);\n    eventBus.off('pagenumberchanged', webViewerPageNumberChanged);\n    eventBus.off('scalechanged', webViewerScaleChanged);\n    eventBus.off('rotatecw', webViewerRotateCw);\n    eventBus.off('rotateccw', webViewerRotateCcw);\n    eventBus.off('switchscrollmode', webViewerSwitchScrollMode);\n    eventBus.off('scrollmodechanged', webViewerScrollModeChanged);\n    eventBus.off('switchspreadmode', webViewerSwitchSpreadMode);\n    eventBus.off('spreadmodechanged', webViewerSpreadModeChanged);\n    eventBus.off('documentproperties', webViewerDocumentProperties);\n    eventBus.off('find', webViewerFind);\n    eventBus.off('findfromurlhash', webViewerFindFromUrlHash);\n    eventBus.off('updatefindmatchescount', webViewerUpdateFindMatchesCount);\n    eventBus.off('updatefindcontrolstate', webViewerUpdateFindControlState);\n    if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n      eventBus.off('fileinputchange', webViewerFileInputChange);\n    }\n\n    _boundEvents.beforePrint = null;\n    _boundEvents.afterPrint = null;\n  },\n\n  unbindWindowEvents() {\n    let { _boundEvents, } = this;\n\n    window.removeEventListener('visibilitychange', webViewerVisibilityChange);\n    window.removeEventListener('wheel', webViewerWheel);\n    window.removeEventListener('click', webViewerClick);\n    window.removeEventListener('keydown', webViewerKeyDown);\n    window.removeEventListener('resize', _boundEvents.windowResize);\n    window.removeEventListener('hashchange', _boundEvents.windowHashChange);\n    window.removeEventListener('beforeprint', _boundEvents.windowBeforePrint);\n    window.removeEventListener('afterprint', _boundEvents.windowAfterPrint);\n\n    _boundEvents.windowResize = null;\n    _boundEvents.windowHashChange = null;\n    _boundEvents.windowBeforePrint = null;\n    _boundEvents.windowAfterPrint = null;\n  },\n};\n\nlet validateFileURL;\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  const HOSTED_VIEWER_ORIGINS = ['null',\n    'http://mozilla.github.io', 'https://mozilla.github.io'];\n  validateFileURL = function validateFileURL(file) {\n    if (file === undefined) {\n      return;\n    }\n    try {\n      let viewerOrigin = new URL(window.location.href).origin || 'null';\n      if (HOSTED_VIEWER_ORIGINS.includes(viewerOrigin)) {\n        // Hosted or local viewer, allow for any file locations\n        return;\n      }\n      let { origin, protocol, } = new URL(file, window.location.href);\n      // Removing of the following line will not guarantee that the viewer will\n      // start accepting URLs from foreign origin -- CORS headers on the remote\n      // server must be properly configured.\n      // IE10 / IE11 does not include an origin in `blob:`-URLs. So don't block\n      // any blob:-URL. The browser's same-origin policy will block requests to\n      // blob:-URLs from other origins, so this is safe.\n      if (origin !== viewerOrigin && protocol !== 'blob:') {\n        // throw new Error('file origin does not match viewer\\'s');\n      }\n    } catch (ex) {\n      let message = ex && ex.message;\n      PDFViewerApplication.l10n.get('loading_error', null,\n          'An error occurred while loading the PDF.').\n          then((loadingErrorMessage) => {\n        PDFViewerApplication.error(loadingErrorMessage, { message, });\n      });\n      throw ex;\n    }\n  };\n}\n\nfunction loadFakeWorker() {\n  if (!GlobalWorkerOptions.workerSrc) {\n    GlobalWorkerOptions.workerSrc = AppOptions.get('workerSrc');\n  }\n  if (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION')) {\n    return new Promise(function(resolve, reject) {\n      if (typeof SystemJS === 'object') {\n        SystemJS.import('pdfjs/core/worker').then((worker) => {\n          window.pdfjsWorker = worker;\n          resolve();\n        }).catch(reject);\n      } else if (typeof require === 'function') {\n        try {\n          window.pdfjsWorker = require('../src/core/worker.js');\n          resolve();\n        } catch (ex) {\n          reject(ex);\n        }\n      } else {\n        reject(new Error(\n          'SystemJS or CommonJS must be used to load fake worker.'));\n      }\n    });\n  }\n  return loadScript(PDFWorker.getWorkerSrc());\n}\n\nfunction loadAndEnablePDFBug(enabledTabs) {\n  let appConfig = PDFViewerApplication.appConfig;\n  return loadScript(appConfig.debuggerScriptPath).then(function() {\n    PDFBug.enable(enabledTabs);\n    PDFBug.init({\n      OPS,\n      createObjectURL,\n    }, appConfig.mainContainer);\n  });\n}\n\nfunction webViewerInitialized() {\n  let appConfig = PDFViewerApplication.appConfig;\n  let file;\n  if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n    let queryString = document.location.search.substring(1);\n    let params = parseQueryString(queryString);\n    file = 'file' in params ? params.file : AppOptions.get('defaultUrl');\n    validateFileURL(file);\n  } else if (PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n    file = window.location.href.split('#')[0];\n  } else if (PDFJSDev.test('CHROME')) {\n    file = AppOptions.get('defaultUrl');\n  }\n\n  if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n    let fileInput = document.createElement('input');\n    fileInput.id = appConfig.openFileInputName;\n    fileInput.className = 'fileInput';\n    fileInput.setAttribute('type', 'file');\n    fileInput.oncontextmenu = noContextMenuHandler;\n    document.body.appendChild(fileInput);\n\n    if (!window.File || !window.FileReader ||\n        !window.FileList || !window.Blob) {\n      appConfig.toolbar.openFile.setAttribute('hidden', 'true');\n      appConfig.secondaryToolbar.openFileButton.setAttribute('hidden', 'true');\n    } else {\n      fileInput.value = null;\n    }\n\n    fileInput.addEventListener('change', function(evt) {\n      let files = evt.target.files;\n      if (!files || files.length === 0) {\n        return;\n      }\n      PDFViewerApplication.eventBus.dispatch('fileinputchange', {\n        source: this,\n        fileInput: evt.target,\n      });\n    });\n\n    // Enable draging-and-dropping a new PDF file onto the viewerContainer.\n    appConfig.mainContainer.addEventListener('dragover', function(evt) {\n      evt.preventDefault();\n\n      evt.dataTransfer.dropEffect = 'move';\n    });\n    appConfig.mainContainer.addEventListener('drop', function(evt) {\n      evt.preventDefault();\n\n      const files = evt.dataTransfer.files;\n      if (!files || files.length === 0) {\n        return;\n      }\n      PDFViewerApplication.eventBus.dispatch('fileinputchange', {\n        source: this,\n        fileInput: evt.dataTransfer,\n      });\n    });\n  } else {\n    appConfig.toolbar.openFile.setAttribute('hidden', 'true');\n    appConfig.secondaryToolbar.openFileButton.setAttribute('hidden', 'true');\n  }\n\n  if (typeof PDFJSDev !== 'undefined' &&\n      PDFJSDev.test('FIREFOX || MOZCENTRAL') &&\n      !PDFViewerApplication.supportsDocumentFonts) {\n    AppOptions.set('disableFontFace', true);\n    PDFViewerApplication.l10n.get('web_fonts_disabled', null,\n      'Web fonts are disabled: unable to use embedded PDF fonts.').\n        then((msg) => {\n      console.warn(msg);\n    });\n  }\n\n  if (!PDFViewerApplication.supportsPrinting) {\n    appConfig.toolbar.print.classList.add('hidden');\n    appConfig.secondaryToolbar.printButton.classList.add('hidden');\n  }\n\n  if (!PDFViewerApplication.supportsFullscreen) {\n    appConfig.toolbar.presentationModeButton.classList.add('hidden');\n    appConfig.secondaryToolbar.presentationModeButton.classList.add('hidden');\n  }\n\n  if (PDFViewerApplication.supportsIntegratedFind) {\n    appConfig.toolbar.viewFind.classList.add('hidden');\n  }\n\n  appConfig.mainContainer.addEventListener('transitionend', function(evt) {\n    if (evt.target === /* mainContainer */ this) {\n      PDFViewerApplication.eventBus.dispatch('resize', { source: this, });\n    }\n  }, true);\n\n  try {\n    webViewerOpenFileViaURL(file);\n  } catch (reason) {\n    PDFViewerApplication.l10n.get('loading_error', null,\n        'An error occurred while loading the PDF.').then((msg) => {\n      PDFViewerApplication.error(msg, reason);\n    });\n  }\n}\n\nlet webViewerOpenFileViaURL;\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  webViewerOpenFileViaURL = function webViewerOpenFileViaURL(file) {\n    if (file && file.lastIndexOf('file:', 0) === 0) {\n      // file:-scheme. Load the contents in the main thread because QtWebKit\n      // cannot load file:-URLs in a Web Worker. file:-URLs are usually loaded\n      // very quickly, so there is no need to set up progress event listeners.\n      PDFViewerApplication.setTitleUsingUrl(file);\n      const xhr = new XMLHttpRequest();\n      xhr.onload = function() {\n        PDFViewerApplication.open(new Uint8Array(xhr.response));\n      };\n      xhr.open('GET', file);\n      xhr.responseType = 'arraybuffer';\n      xhr.send();\n      return;\n    }\n\n    if (file) {\n      PDFViewerApplication.open(file);\n    }\n  };\n} else if (PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n  webViewerOpenFileViaURL = function webViewerOpenFileViaURL(file) {\n    PDFViewerApplication.setTitleUsingUrl(file);\n    PDFViewerApplication.initPassiveLoading();\n  };\n} else {\n  webViewerOpenFileViaURL = function webViewerOpenFileViaURL(file) {\n    if (file) {\n      throw new Error('Not implemented: webViewerOpenFileViaURL');\n    }\n  };\n}\n\nfunction webViewerPageRendered(evt) {\n  let pageNumber = evt.pageNumber;\n  let pageIndex = pageNumber - 1;\n  let pageView = PDFViewerApplication.pdfViewer.getPageView(pageIndex);\n\n  // If the page is still visible when it has finished rendering,\n  // ensure that the page number input loading indicator is hidden.\n  if (pageNumber === PDFViewerApplication.page) {\n    PDFViewerApplication.toolbar.updateLoadingIndicatorState(false);\n  }\n\n  // Prevent errors in the edge-case where the PDF document is removed *before*\n  // the 'pagerendered' event handler is invoked.\n  if (!pageView) {\n    return;\n  }\n\n  // Use the rendered page to set the corresponding thumbnail image.\n  if (PDFViewerApplication.pdfSidebar.isThumbnailViewVisible) {\n    let thumbnailView = PDFViewerApplication.pdfThumbnailViewer.\n                        getThumbnail(pageIndex);\n    thumbnailView.setImage(pageView);\n  }\n\n  if (typeof Stats !== 'undefined' && Stats.enabled && pageView.stats) {\n    Stats.add(pageNumber, pageView.stats);\n  }\n\n  if (pageView.error) {\n    PDFViewerApplication.l10n.get('rendering_error', null,\n        'An error occurred while rendering the page.').then((msg) => {\n      PDFViewerApplication.error(msg, pageView.error);\n    });\n  }\n\n  if (typeof PDFJSDev !== 'undefined' &&\n      PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n    PDFViewerApplication.externalServices.reportTelemetry({\n      type: 'pageInfo',\n      timestamp: evt.timestamp,\n    });\n    // It is a good time to report stream and font types.\n    PDFViewerApplication.pdfDocument.getStats().then(function (stats) {\n      PDFViewerApplication.externalServices.reportTelemetry({\n        type: 'documentStats',\n        stats,\n      });\n    });\n  }\n}\n\nfunction webViewerTextLayerRendered(evt) {\n  if (typeof PDFJSDev !== 'undefined' &&\n      PDFJSDev.test('FIREFOX || MOZCENTRAL') &&\n      evt.numTextDivs > 0 && !PDFViewerApplication.supportsDocumentColors) {\n    PDFViewerApplication.l10n.get('document_colors_not_allowed', null,\n      'PDF documents are not allowed to use their own colors: ' +\n      '\\'Allow pages to choose their own colors\\' ' +\n      'is deactivated in the browser.').\n        then((msg) => {\n      console.error(msg);\n    });\n    PDFViewerApplication.fallback();\n  }\n}\n\nfunction webViewerPageMode(evt) {\n  // Handle the 'pagemode' hash parameter, see also `PDFLinkService_setHash`.\n  let mode = evt.mode, view;\n  switch (mode) {\n    case 'thumbs':\n      view = SidebarView.THUMBS;\n      break;\n    case 'bookmarks':\n    case 'outline':\n      view = SidebarView.OUTLINE;\n      break;\n    case 'attachments':\n      view = SidebarView.ATTACHMENTS;\n      break;\n    case 'none':\n      view = SidebarView.NONE;\n      break;\n    default:\n      console.error('Invalid \"pagemode\" hash parameter: ' + mode);\n      return;\n  }\n  PDFViewerApplication.pdfSidebar.switchView(view, /* forceOpen = */ true);\n}\n\nfunction webViewerNamedAction(evt) {\n  // Processing couple of named actions that might be useful.\n  // See also PDFLinkService.executeNamedAction\n  let action = evt.action;\n  switch (action) {\n    case 'GoToPage':\n      PDFViewerApplication.appConfig.toolbar.pageNumber.select();\n      break;\n\n    case 'Find':\n      if (!PDFViewerApplication.supportsIntegratedFind) {\n        PDFViewerApplication.findBar.toggle();\n      }\n      break;\n  }\n}\n\nfunction webViewerPresentationModeChanged(evt) {\n  let { active, switchInProgress, } = evt;\n  PDFViewerApplication.pdfViewer.presentationModeState =\n    switchInProgress ? PresentationModeState.CHANGING :\n    active ? PresentationModeState.FULLSCREEN : PresentationModeState.NORMAL;\n}\n\nfunction webViewerSidebarViewChanged(evt) {\n  PDFViewerApplication.pdfRenderingQueue.isThumbnailViewEnabled =\n    PDFViewerApplication.pdfSidebar.isThumbnailViewVisible;\n\n  let store = PDFViewerApplication.store;\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    // Only update the storage when the document has been loaded *and* rendered.\n    store.set('sidebarView', evt.view).catch(function() { });\n  }\n}\n\nfunction webViewerUpdateViewarea(evt) {\n  let location = evt.location, store = PDFViewerApplication.store;\n\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    store.setMultiple({\n      'page': location.pageNumber,\n      'zoom': location.scale,\n      'scrollLeft': location.left,\n      'scrollTop': location.top,\n      'rotation': location.rotation,\n    }).catch(function() { /* unable to write to storage */ });\n  }\n  let href =\n    PDFViewerApplication.pdfLinkService.getAnchorUrl(location.pdfOpenParams);\n  PDFViewerApplication.appConfig.toolbar.viewBookmark.href = href;\n  PDFViewerApplication.appConfig.secondaryToolbar.viewBookmarkButton.href =\n    href;\n\n  // Show/hide the loading indicator in the page number input element.\n  let currentPage =\n    PDFViewerApplication.pdfViewer.getPageView(PDFViewerApplication.page - 1);\n  let loading = currentPage.renderingState !== RenderingStates.FINISHED;\n  PDFViewerApplication.toolbar.updateLoadingIndicatorState(loading);\n}\n\nfunction webViewerScrollModeChanged(evt) {\n  let store = PDFViewerApplication.store;\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    // Only update the storage when the document has been loaded *and* rendered.\n    store.set('scrollMode', evt.mode).catch(function() { });\n  }\n}\n\nfunction webViewerSpreadModeChanged(evt) {\n  let store = PDFViewerApplication.store;\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    // Only update the storage when the document has been loaded *and* rendered.\n    store.set('spreadMode', evt.mode).catch(function() { });\n  }\n}\n\nfunction webViewerResize() {\n  let { pdfDocument, pdfViewer, } = PDFViewerApplication;\n  if (!pdfDocument) {\n    return;\n  }\n  let currentScaleValue = pdfViewer.currentScaleValue;\n  if (currentScaleValue === 'auto' ||\n      currentScaleValue === 'page-fit' ||\n      currentScaleValue === 'page-width') {\n    // Note: the scale is constant for 'page-actual'.\n    pdfViewer.currentScaleValue = currentScaleValue;\n  }\n  pdfViewer.update();\n}\n\nfunction webViewerHashchange(evt) {\n  let hash = evt.hash;\n  if (!hash) {\n    return;\n  }\n  if (!PDFViewerApplication.isInitialViewSet) {\n    PDFViewerApplication.initialBookmark = hash;\n  } else if (!PDFViewerApplication.pdfHistory.popStateInProgress) {\n    PDFViewerApplication.pdfLinkService.setHash(hash);\n  }\n}\n\nlet webViewerFileInputChange;\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  webViewerFileInputChange = function webViewerFileInputChange(evt) {\n    if (PDFViewerApplication.pdfViewer &&\n        PDFViewerApplication.pdfViewer.isInPresentationMode) {\n      return; // Opening a new PDF file isn't supported in Presentation Mode.\n    }\n    let file = evt.fileInput.files[0];\n\n    if (URL.createObjectURL && !AppOptions.get('disableCreateObjectURL')) {\n      let url = URL.createObjectURL(file);\n      if (file.name) {\n        url = { url, originalUrl: file.name, };\n      }\n      PDFViewerApplication.open(url);\n    } else {\n      PDFViewerApplication.setTitleUsingUrl(file.name);\n      // Read the local file into a Uint8Array.\n      let fileReader = new FileReader();\n      fileReader.onload = function webViewerChangeFileReaderOnload(evt) {\n        let buffer = evt.target.result;\n        PDFViewerApplication.open(new Uint8Array(buffer));\n      };\n      fileReader.readAsArrayBuffer(file);\n    }\n\n    // URL does not reflect proper document location - hiding some icons.\n    let appConfig = PDFViewerApplication.appConfig;\n    appConfig.toolbar.viewBookmark.setAttribute('hidden', 'true');\n    appConfig.secondaryToolbar.viewBookmarkButton.setAttribute('hidden',\n                                                               'true');\n    appConfig.toolbar.download.setAttribute('hidden', 'true');\n    appConfig.secondaryToolbar.downloadButton.setAttribute('hidden', 'true');\n  };\n}\n\nfunction webViewerPresentationMode() {\n  PDFViewerApplication.requestPresentationMode();\n}\nfunction webViewerOpenFile() {\n  if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n    let openFileInputName = PDFViewerApplication.appConfig.openFileInputName;\n    document.getElementById(openFileInputName).click();\n  }\n}\nfunction webViewerPrint() {\n  window.print();\n}\nfunction webViewerDownload() {\n  PDFViewerApplication.download();\n}\nfunction webViewerFirstPage() {\n  if (PDFViewerApplication.pdfDocument) {\n    PDFViewerApplication.page = 1;\n  }\n}\nfunction webViewerLastPage() {\n  if (PDFViewerApplication.pdfDocument) {\n    PDFViewerApplication.page = PDFViewerApplication.pagesCount;\n  }\n}\nfunction webViewerNextPage() {\n  PDFViewerApplication.page++;\n}\nfunction webViewerPreviousPage() {\n  PDFViewerApplication.page--;\n}\nfunction webViewerZoomIn() {\n  PDFViewerApplication.zoomIn();\n}\nfunction webViewerZoomOut() {\n  PDFViewerApplication.zoomOut();\n}\nfunction webViewerZoomReset() {\n  PDFViewerApplication.zoomReset();\n}\nfunction webViewerPageNumberChanged(evt) {\n  let pdfViewer = PDFViewerApplication.pdfViewer;\n  // Note that for `<input type=\"number\">` HTML elements, an empty string will\n  // be returned for non-number inputs; hence we simply do nothing in that case.\n  if (evt.value !== '') {\n    pdfViewer.currentPageLabel = evt.value;\n  }\n\n  // Ensure that the page number input displays the correct value, even if the\n  // value entered by the user was invalid (e.g. a floating point number).\n  if (evt.value !== pdfViewer.currentPageNumber.toString() &&\n      evt.value !== pdfViewer.currentPageLabel) {\n    PDFViewerApplication.toolbar.setPageNumber(\n      pdfViewer.currentPageNumber, pdfViewer.currentPageLabel);\n  }\n}\nfunction webViewerScaleChanged(evt) {\n  PDFViewerApplication.pdfViewer.currentScaleValue = evt.value;\n}\nfunction webViewerRotateCw() {\n  PDFViewerApplication.rotatePages(90);\n}\nfunction webViewerRotateCcw() {\n  PDFViewerApplication.rotatePages(-90);\n}\nfunction webViewerSwitchScrollMode(evt) {\n  PDFViewerApplication.pdfViewer.scrollMode = evt.mode;\n}\nfunction webViewerSwitchSpreadMode(evt) {\n  PDFViewerApplication.pdfViewer.spreadMode = evt.mode;\n}\nfunction webViewerDocumentProperties() {\n  PDFViewerApplication.pdfDocumentProperties.open();\n}\n\nfunction webViewerFind(evt) {\n  PDFViewerApplication.findController.executeCommand('find' + evt.type, {\n    query: evt.query,\n    phraseSearch: evt.phraseSearch,\n    caseSensitive: evt.caseSensitive,\n    entireWord: evt.entireWord,\n    highlightAll: evt.highlightAll,\n    findPrevious: evt.findPrevious,\n  });\n}\n\nfunction webViewerFindFromUrlHash(evt) {\n  PDFViewerApplication.findController.executeCommand('find', {\n    query: evt.query,\n    phraseSearch: evt.phraseSearch,\n    caseSensitive: false,\n    entireWord: false,\n    highlightAll: true,\n    findPrevious: false,\n  });\n}\n\nfunction webViewerUpdateFindMatchesCount({ matchesCount, }) {\n  if (PDFViewerApplication.supportsIntegratedFind) {\n    PDFViewerApplication.externalServices.updateFindMatchesCount(matchesCount);\n  } else {\n    PDFViewerApplication.findBar.updateResultsCount(matchesCount);\n  }\n}\n\nfunction webViewerUpdateFindControlState({ state, previous, matchesCount, }) {\n  if (PDFViewerApplication.supportsIntegratedFind) {\n    PDFViewerApplication.externalServices.updateFindControlState({\n      result: state,\n      findPrevious: previous,\n      matchesCount,\n    });\n  } else {\n    PDFViewerApplication.findBar.updateUIState(state, previous, matchesCount);\n  }\n}\n\nfunction webViewerScaleChanging(evt) {\n  PDFViewerApplication.toolbar.setPageScale(evt.presetValue, evt.scale);\n\n  PDFViewerApplication.pdfViewer.update();\n}\n\nfunction webViewerRotationChanging(evt) {\n  PDFViewerApplication.pdfThumbnailViewer.pagesRotation = evt.pagesRotation;\n\n  PDFViewerApplication.forceRendering();\n  // Ensure that the active page doesn't change during rotation.\n  PDFViewerApplication.pdfViewer.currentPageNumber = evt.pageNumber;\n}\n\nfunction webViewerPageChanging(evt) {\n  let page = evt.pageNumber;\n\n  PDFViewerApplication.toolbar.setPageNumber(page, evt.pageLabel || null);\n  PDFViewerApplication.secondaryToolbar.setPageNumber(page);\n\n  if (PDFViewerApplication.pdfSidebar.isThumbnailViewVisible) {\n    PDFViewerApplication.pdfThumbnailViewer.scrollThumbnailIntoView(page);\n  }\n\n  // We need to update stats.\n  if (typeof Stats !== 'undefined' && Stats.enabled) {\n    let pageView = PDFViewerApplication.pdfViewer.getPageView(page - 1);\n    if (pageView && pageView.stats) {\n      Stats.add(page, pageView.stats);\n    }\n  }\n}\n\nfunction webViewerVisibilityChange(evt) {\n  if (document.visibilityState === 'visible') {\n    // Ignore mouse wheel zooming during tab switches (bug 1503412).\n    setZoomDisabledTimeout();\n  }\n}\n\nlet zoomDisabledTimeout = null;\nfunction setZoomDisabledTimeout() {\n  if (zoomDisabledTimeout) {\n    clearTimeout(zoomDisabledTimeout);\n  }\n  zoomDisabledTimeout = setTimeout(function() {\n    zoomDisabledTimeout = null;\n  }, WHEEL_ZOOM_DISABLED_TIMEOUT);\n}\n\nfunction webViewerWheel(evt) {\n  const { pdfViewer, supportedMouseWheelZoomModifierKeys, } =\n    PDFViewerApplication;\n\n  if (pdfViewer.isInPresentationMode) {\n    return;\n  }\n\n  if ((evt.ctrlKey && supportedMouseWheelZoomModifierKeys.ctrlKey) ||\n      (evt.metaKey && supportedMouseWheelZoomModifierKeys.metaKey)) {\n    // Only zoom the pages, not the entire viewer.\n    evt.preventDefault();\n    // NOTE: this check must be placed *after* preventDefault.\n    if (zoomDisabledTimeout || document.visibilityState === 'hidden') {\n      return;\n    }\n\n    let previousScale = pdfViewer.currentScale;\n\n    let delta = normalizeWheelEventDelta(evt);\n\n    const MOUSE_WHEEL_DELTA_PER_PAGE_SCALE = 3.0;\n    let ticks = delta * MOUSE_WHEEL_DELTA_PER_PAGE_SCALE;\n    if (ticks < 0) {\n      PDFViewerApplication.zoomOut(-ticks);\n    } else {\n      PDFViewerApplication.zoomIn(ticks);\n    }\n\n    let currentScale = pdfViewer.currentScale;\n    if (previousScale !== currentScale) {\n      // After scaling the page via zoomIn/zoomOut, the position of the upper-\n      // left corner is restored. When the mouse wheel is used, the position\n      // under the cursor should be restored instead.\n      let scaleCorrectionFactor = currentScale / previousScale - 1;\n      let rect = pdfViewer.container.getBoundingClientRect();\n      let dx = evt.clientX - rect.left;\n      let dy = evt.clientY - rect.top;\n      pdfViewer.container.scrollLeft += dx * scaleCorrectionFactor;\n      pdfViewer.container.scrollTop += dy * scaleCorrectionFactor;\n    }\n  } else {\n    setZoomDisabledTimeout();\n  }\n}\n\nfunction webViewerClick(evt) {\n  if (!PDFViewerApplication.secondaryToolbar.isOpen) {\n    return;\n  }\n  let appConfig = PDFViewerApplication.appConfig;\n  if (PDFViewerApplication.pdfViewer.containsElement(evt.target) ||\n      (appConfig.toolbar.container.contains(evt.target) &&\n       evt.target !== appConfig.secondaryToolbar.toggleButton)) {\n    PDFViewerApplication.secondaryToolbar.close();\n  }\n}\n\nfunction webViewerKeyDown(evt) {\n  if (PDFViewerApplication.overlayManager.active) {\n    return;\n  }\n\n  let handled = false, ensureViewerFocused = false;\n  let cmd = (evt.ctrlKey ? 1 : 0) |\n            (evt.altKey ? 2 : 0) |\n            (evt.shiftKey ? 4 : 0) |\n            (evt.metaKey ? 8 : 0);\n\n  let pdfViewer = PDFViewerApplication.pdfViewer;\n  let isViewerInPresentationMode = pdfViewer && pdfViewer.isInPresentationMode;\n\n  // First, handle the key bindings that are independent whether an input\n  // control is selected or not.\n  if (cmd === 1 || cmd === 8 || cmd === 5 || cmd === 12) {\n    // either CTRL or META key with optional SHIFT.\n    switch (evt.keyCode) {\n      case 70: // f\n        if (!PDFViewerApplication.supportsIntegratedFind) {\n          PDFViewerApplication.findBar.open();\n          handled = true;\n        }\n        break;\n      case 71: // g\n        if (!PDFViewerApplication.supportsIntegratedFind) {\n          let findState = PDFViewerApplication.findController.state;\n          if (findState) {\n            PDFViewerApplication.findController.executeCommand('findagain', {\n              query: findState.query,\n              phraseSearch: findState.phraseSearch,\n              caseSensitive: findState.caseSensitive,\n              entireWord: findState.entireWord,\n              highlightAll: findState.highlightAll,\n              findPrevious: cmd === 5 || cmd === 12,\n            });\n          }\n          handled = true;\n        }\n        break;\n      case 61: // FF/Mac '='\n      case 107: // FF '+' and '='\n      case 187: // Chrome '+'\n      case 171: // FF with German keyboard\n        if (!isViewerInPresentationMode) {\n          PDFViewerApplication.zoomIn();\n        }\n        handled = true;\n        break;\n      case 173: // FF/Mac '-'\n      case 109: // FF '-'\n      case 189: // Chrome '-'\n        if (!isViewerInPresentationMode) {\n          PDFViewerApplication.zoomOut();\n        }\n        handled = true;\n        break;\n      case 48: // '0'\n      case 96: // '0' on Numpad of Swedish keyboard\n        if (!isViewerInPresentationMode) {\n          // keeping it unhandled (to restore page zoom to 100%)\n          setTimeout(function() {\n            // ... and resetting the scale after browser adjusts its scale\n            PDFViewerApplication.zoomReset();\n          });\n          handled = false;\n        }\n        break;\n\n      case 38: // up arrow\n        if (isViewerInPresentationMode || PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page = 1;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n      case 40: // down arrow\n        if (isViewerInPresentationMode ||\n            PDFViewerApplication.page < PDFViewerApplication.pagesCount) {\n          PDFViewerApplication.page = PDFViewerApplication.pagesCount;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n    }\n  }\n\n  if (typeof PDFJSDev === 'undefined' ||\n      !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n    // CTRL or META without shift\n    if (cmd === 1 || cmd === 8) {\n      switch (evt.keyCode) {\n        case 83: // s\n          PDFViewerApplication.download();\n          handled = true;\n          break;\n      }\n    }\n  }\n\n  // CTRL+ALT or Option+Command\n  if (cmd === 3 || cmd === 10) {\n    switch (evt.keyCode) {\n      case 80: // p\n        PDFViewerApplication.requestPresentationMode();\n        handled = true;\n        break;\n      case 71: // g\n        // focuses input#pageNumber field\n        PDFViewerApplication.appConfig.toolbar.pageNumber.select();\n        handled = true;\n        break;\n    }\n  }\n\n  if (handled) {\n    if (ensureViewerFocused && !isViewerInPresentationMode) {\n      pdfViewer.focus();\n    }\n    evt.preventDefault();\n    return;\n  }\n\n  // Some shortcuts should not get handled if a control/input element\n  // is selected.\n  let curElement = document.activeElement || document.querySelector(':focus');\n  let curElementTagName = curElement && curElement.tagName.toUpperCase();\n  if (curElementTagName === 'INPUT' ||\n      curElementTagName === 'TEXTAREA' ||\n      curElementTagName === 'SELECT' ||\n      (curElement && curElement.isContentEditable)) {\n    // Make sure that the secondary toolbar is closed when Escape is pressed.\n    if (evt.keyCode !== 27) { // 'Esc'\n      return;\n    }\n  }\n\n  if (cmd === 0) { // no control key pressed at all.\n    let turnPage = 0, turnOnlyIfPageFit = false;\n    switch (evt.keyCode) {\n      case 38: // up arrow\n      case 33: // pg up\n        // vertical scrolling using arrow/pg keys\n        if (pdfViewer.isVerticalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = -1;\n        break;\n      case 8: // backspace\n        if (!isViewerInPresentationMode) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = -1;\n        break;\n      case 37: // left arrow\n        // horizontal scrolling using arrow keys\n        if (pdfViewer.isHorizontalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        /* falls through */\n      case 75: // 'k'\n      case 80: // 'p'\n        turnPage = -1;\n        break;\n      case 27: // esc key\n        if (PDFViewerApplication.secondaryToolbar.isOpen) {\n          PDFViewerApplication.secondaryToolbar.close();\n          handled = true;\n        }\n        if (!PDFViewerApplication.supportsIntegratedFind &&\n            PDFViewerApplication.findBar.opened) {\n          PDFViewerApplication.findBar.close();\n          handled = true;\n        }\n        break;\n      case 40: // down arrow\n      case 34: // pg down\n        // vertical scrolling using arrow/pg keys\n        if (pdfViewer.isVerticalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = 1;\n        break;\n      case 13: // enter key\n      case 32: // spacebar\n        if (!isViewerInPresentationMode) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = 1;\n        break;\n      case 39: // right arrow\n        // horizontal scrolling using arrow keys\n        if (pdfViewer.isHorizontalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        /* falls through */\n      case 74: // 'j'\n      case 78: // 'n'\n        turnPage = 1;\n        break;\n\n      case 36: // home\n        if (isViewerInPresentationMode || PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page = 1;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n      case 35: // end\n        if (isViewerInPresentationMode ||\n            PDFViewerApplication.page < PDFViewerApplication.pagesCount) {\n          PDFViewerApplication.page = PDFViewerApplication.pagesCount;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n\n      case 83: // 's'\n        PDFViewerApplication.pdfCursorTools.switchTool(CursorTool.SELECT);\n        break;\n      case 72: // 'h'\n        PDFViewerApplication.pdfCursorTools.switchTool(CursorTool.HAND);\n        break;\n\n      case 82: // 'r'\n        PDFViewerApplication.rotatePages(90);\n        break;\n\n      case 115: // F4\n        PDFViewerApplication.pdfSidebar.toggle();\n        break;\n    }\n\n    if (turnPage !== 0 &&\n        (!turnOnlyIfPageFit || pdfViewer.currentScaleValue === 'page-fit')) {\n      if (turnPage > 0) {\n        if (PDFViewerApplication.page < PDFViewerApplication.pagesCount) {\n          PDFViewerApplication.page++;\n        }\n      } else {\n        if (PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page--;\n        }\n      }\n      handled = true;\n    }\n  }\n\n  if (cmd === 4) { // shift-key\n    switch (evt.keyCode) {\n      case 13: // enter key\n      case 32: // spacebar\n        if (!isViewerInPresentationMode &&\n            pdfViewer.currentScaleValue !== 'page-fit') {\n          break;\n        }\n        if (PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page--;\n        }\n        handled = true;\n        break;\n\n      case 82: // 'r'\n        PDFViewerApplication.rotatePages(-90);\n        break;\n    }\n  }\n\n  if (!handled && !isViewerInPresentationMode) {\n    // 33=Page Up  34=Page Down  35=End    36=Home\n    // 37=Left     38=Up         39=Right  40=Down\n    // 32=Spacebar\n    if ((evt.keyCode >= 33 && evt.keyCode <= 40) ||\n        (evt.keyCode === 32 && curElementTagName !== 'BUTTON')) {\n      ensureViewerFocused = true;\n    }\n  }\n\n  if (ensureViewerFocused && !pdfViewer.containsElement(curElement)) {\n    // The page container is not focused, but a page navigation key has been\n    // pressed. Change the focus to the viewer container to make sure that\n    // navigation by keyboard works as expected.\n    pdfViewer.focus();\n  }\n\n  if (handled) {\n    evt.preventDefault();\n  }\n}\n\n/**\n * Converts API PageLayout values to the format used by `PDFViewer`.\n * NOTE: This is supported to the extent that the viewer implements the\n *       necessary Scroll/Spread modes (since SinglePage, TwoPageLeft,\n *       and TwoPageRight all suggests using non-continuous scrolling).\n * @param {string} mode - The API PageLayout value.\n * @returns {number} A value from {SpreadMode}.\n */\nfunction apiPageLayoutToSpreadMode(layout) {\n  switch (layout) {\n    case 'SinglePage':\n    case 'OneColumn':\n      return SpreadMode.NONE;\n    case 'TwoColumnLeft':\n    case 'TwoPageLeft':\n      return SpreadMode.ODD;\n    case 'TwoColumnRight':\n    case 'TwoPageRight':\n      return SpreadMode.EVEN;\n  }\n  return SpreadMode.NONE; // Default value.\n}\n\n/**\n * Converts API PageMode values to the format used by `PDFSidebar`.\n * NOTE: There's also a \"FullScreen\" parameter which is not possible to support,\n *       since the Fullscreen API used in browsers requires that entering\n *       fullscreen mode only occurs as a result of a user-initiated event.\n * @param {string} mode - The API PageMode value.\n * @returns {number} A value from {SidebarView}.\n */\nfunction apiPageModeToSidebarView(mode) {\n  switch (mode) {\n    case 'UseNone':\n      return SidebarView.NONE;\n    case 'UseThumbs':\n      return SidebarView.THUMBS;\n    case 'UseOutlines':\n      return SidebarView.OUTLINE;\n    case 'UseAttachments':\n      return SidebarView.ATTACHMENTS;\n    case 'UseOC':\n      // Not implemented, since we don't support Optional Content Groups yet.\n  }\n  return SidebarView.NONE; // Default value.\n}\n\n/* Abstract factory for the print service. */\nlet PDFPrintServiceFactory = {\n  instance: {\n    supportsPrinting: false,\n    createPrintService() {\n      throw new Error('Not implemented: createPrintService');\n    },\n  },\n};\n\nexport {\n  PDFViewerApplication,\n  DefaultExternalServices,\n  PDFPrintServiceFactory,\n};\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { apiCompatibilityParams } from 'pdfjs-lib';\nimport { viewerCompatibilityParams } from './viewer_compatibility';\n\nconst OptionKind = {\n  VIEWER: 0x02,\n  API: 0x04,\n  WORKER: 0x08,\n  PREFERENCE: 0x80,\n};\n\n/**\n * PLEASE NOTE: To avoid introducing unnecessary dependencies, we specify the\n *              values below *explicitly* rather than relying on imported types.\n */\nconst defaultOptions = {\n  cursorToolOnLoad: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  defaultUrl: {\n    /** @type {string} */\n    value: 'compressed.tracemonkey-pldi-09.pdf',\n    kind: OptionKind.VIEWER,\n  },\n  defaultZoomValue: {\n    /** @type {string} */\n    value: '',\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  disableHistory: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER,\n  },\n  disablePageLabels: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  /**\n   * The `disablePreferences` is, conditionally, defined below.\n   */\n  enablePrintAutoRotate: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  enableWebGL: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  eventBusDispatchToDOM: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  externalLinkRel: {\n    /** @type {string} */\n    value: 'noopener noreferrer nofollow',\n    kind: OptionKind.VIEWER,\n  },\n  externalLinkTarget: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  historyUpdateUrl: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  imageResourcesPath: {\n    /** @type {string} */\n    value: './images/',\n    kind: OptionKind.VIEWER,\n  },\n  /**\n   * The `locale` is, conditionally, defined below.\n   */\n  maxCanvasPixels: {\n    /** @type {number} */\n    value: 16777216,\n    compatibility: viewerCompatibilityParams.maxCanvasPixels,\n    kind: OptionKind.VIEWER,\n  },\n  pdfBugEnabled: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  /**\n   * The `printResolution` is, conditionally, defined below.\n   */\n  renderer: {\n    /** @type {string} */\n    value: 'canvas',\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  renderInteractiveForms: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  sidebarViewOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  scrollModeOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  spreadModeOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  textLayerMode: {\n    /** @type {number} */\n    value: 1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  useOnlyCssZoom: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  viewOnLoad: {\n    /** @type {boolean} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n\n  cMapPacked: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  cMapUrl: {\n    /** @type {string} */\n    value: (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION') ?\n            '../external/bcmaps/' : '../web/cmaps/'),\n    kind: OptionKind.API,\n  },\n  disableAutoFetch: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableCreateObjectURL: {\n    /** @type {boolean} */\n    value: false,\n    compatibility: apiCompatibilityParams.disableCreateObjectURL,\n    kind: OptionKind.API,\n  },\n  disableFontFace: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableRange: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableStream: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  docBaseUrl: {\n    /** @type {string} */\n    value: '',\n    kind: OptionKind.API,\n  },\n  isEvalSupported: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  maxImageSize: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.API,\n  },\n  pdfBug: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API,\n  },\n  verbosity: {\n    /** @type {number} */\n    value: 1,\n    kind: OptionKind.API,\n  },\n\n  workerPort: {\n    /** @type {Object} */\n    value: null,\n    kind: OptionKind.WORKER,\n  },\n  workerSrc: {\n    /** @type {string} */\n    value: (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION') ?\n            '../src/worker_loader.js' : '../build/pdf.worker.js'),\n    kind: OptionKind.WORKER,\n  },\n};\nif (typeof PDFJSDev === 'undefined' ||\n    PDFJSDev.test('!PRODUCTION || (GENERIC && !LIB)')) {\n  defaultOptions.disablePreferences = {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.locale = {\n    /** @type {string} */\n    value: (typeof navigator !== 'undefined' ? navigator.language : 'en-US'),\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.printResolution = {\n    /** @type {number} */\n    value: 150,\n    kind: OptionKind.VIEWER,\n  };\n}\n\nconst userOptions = Object.create(null);\n\nclass AppOptions {\n  constructor() {\n    throw new Error('Cannot initialize AppOptions.');\n  }\n\n  static get(name) {\n    const userOption = userOptions[name];\n    if (userOption !== undefined) {\n      return userOption;\n    }\n    const defaultOption = defaultOptions[name];\n    if (defaultOption !== undefined) {\n      return (defaultOption.compatibility || defaultOption.value);\n    }\n    return undefined;\n  }\n\n  static getAll(kind = null) {\n    const options = Object.create(null);\n    for (const name in defaultOptions) {\n      const defaultOption = defaultOptions[name];\n      if (kind) {\n        if ((kind & defaultOption.kind) === 0) {\n          continue;\n        }\n        if (kind === OptionKind.PREFERENCE) {\n          const value = defaultOption.value, valueType = typeof value;\n\n          if (valueType === 'boolean' || valueType === 'string' ||\n              (valueType === 'number' && Number.isInteger(value))) {\n            options[name] = value;\n            continue;\n          }\n          throw new Error(`Invalid type for preference: ${name}`);\n        }\n      }\n      const userOption = userOptions[name];\n      options[name] = (userOption !== undefined ? userOption :\n                       (defaultOption.compatibility || defaultOption.value));\n    }\n    return options;\n  }\n\n  static set(name, value) {\n    userOptions[name] = value;\n  }\n\n  static remove(name) {\n    delete userOptions[name];\n  }\n}\n\nexport {\n  AppOptions,\n  OptionKind,\n};\n","/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus, parseQueryString } from './ui_utils';\n\n/**\n * @typedef {Object} PDFLinkServiceOptions\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} [externalLinkTarget] - Specifies the `target` attribute\n *   for external links. Must use one of the values from {LinkTarget}.\n *   Defaults to using no target.\n * @property {string} [externalLinkRel] - Specifies the `rel` attribute for\n *   external links. Defaults to stripping the referrer.\n */\n\n/**\n * Performs navigation functions inside PDF, such as opening specified page,\n * or destination.\n * @implements {IPDFLinkService}\n */\nclass PDFLinkService {\n  /**\n   * @param {PDFLinkServiceOptions} options\n   */\n  constructor({ eventBus, externalLinkTarget = null,\n                externalLinkRel = null, externalLinkEnabled = true, } = {}) {\n    this.eventBus = eventBus || getGlobalEventBus();\n    this.externalLinkTarget = externalLinkTarget;\n    this.externalLinkRel = externalLinkRel;\n    this.externalLinkEnabled = externalLinkEnabled;\n\n    this.baseUrl = null;\n    this.pdfDocument = null;\n    this.pdfViewer = null;\n    this.pdfHistory = null;\n\n    this._pagesRefCache = null;\n  }\n\n  setDocument(pdfDocument, baseUrl = null) {\n    this.baseUrl = baseUrl;\n    this.pdfDocument = pdfDocument;\n    this._pagesRefCache = Object.create(null);\n  }\n\n  setViewer(pdfViewer) {\n    this.pdfViewer = pdfViewer;\n  }\n\n  setHistory(pdfHistory) {\n    this.pdfHistory = pdfHistory;\n  }\n\n  /**\n   * @type {number}\n   */\n  get pagesCount() {\n    return this.pdfDocument ? this.pdfDocument.numPages : 0;\n  }\n\n  /**\n   * @type {number}\n   */\n  get page() {\n    return this.pdfViewer.currentPageNumber;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set page(value) {\n    this.pdfViewer.currentPageNumber = value;\n  }\n\n  /**\n   * @type {number}\n   */\n  get rotation() {\n    return this.pdfViewer.pagesRotation;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set rotation(value) {\n    this.pdfViewer.pagesRotation = value;\n  }\n\n  /**\n   * @param {string|Array} dest - The named, or explicit, PDF destination.\n   */\n  navigateTo(dest) {\n    let goToDestination = ({ namedDest, explicitDest, }) => {\n      // Dest array looks like that: <page-ref> </XYZ|/FitXXX> <args..>\n      let destRef = explicitDest[0], pageNumber;\n\n      if (destRef instanceof Object) {\n        pageNumber = this._cachedPageNumber(destRef);\n\n        if (pageNumber === null) {\n          // Fetch the page reference if it's not yet available. This could\n          // only occur during loading, before all pages have been resolved.\n          this.pdfDocument.getPageIndex(destRef).then((pageIndex) => {\n            this.cachePageRef(pageIndex + 1, destRef);\n            goToDestination({ namedDest, explicitDest, });\n          }).catch(() => {\n            console.error(`PDFLinkService.navigateTo: \"${destRef}\" is not ` +\n                          `a valid page reference, for dest=\"${dest}\".`);\n          });\n          return;\n        }\n      } else if (Number.isInteger(destRef)) {\n        pageNumber = destRef + 1;\n      } else {\n        console.error(`PDFLinkService.navigateTo: \"${destRef}\" is not ` +\n                      `a valid destination reference, for dest=\"${dest}\".`);\n        return;\n      }\n      if (!pageNumber || pageNumber < 1 || pageNumber > this.pagesCount) {\n        console.error(`PDFLinkService.navigateTo: \"${pageNumber}\" is not ` +\n                      `a valid page number, for dest=\"${dest}\".`);\n        return;\n      }\n\n      if (this.pdfHistory) {\n        // Update the browser history before scrolling the new destination into\n        // view, to be able to accurately capture the current document position.\n        this.pdfHistory.pushCurrentPosition();\n        this.pdfHistory.push({ namedDest, explicitDest, pageNumber, });\n      }\n\n      this.pdfViewer.scrollPageIntoView({\n        pageNumber,\n        destArray: explicitDest,\n      });\n    };\n\n    new Promise((resolve, reject) => {\n      if (typeof dest === 'string') {\n        this.pdfDocument.getDestination(dest).then((destArray) => {\n          resolve({\n            namedDest: dest,\n            explicitDest: destArray,\n          });\n        });\n        return;\n      }\n      resolve({\n        namedDest: '',\n        explicitDest: dest,\n      });\n    }).then((data) => {\n      if (!Array.isArray(data.explicitDest)) {\n        console.error(`PDFLinkService.navigateTo: \"${data.explicitDest}\" is` +\n                      ` not a valid destination array, for dest=\"${dest}\".`);\n        return;\n      }\n      goToDestination(data);\n    });\n  }\n\n  /**\n   * @param {string|Array} dest - The PDF destination object.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getDestinationHash(dest) {\n    if (typeof dest === 'string') {\n      return this.getAnchorUrl('#' + escape(dest));\n    }\n    if (Array.isArray(dest)) {\n      let str = JSON.stringify(dest);\n      return this.getAnchorUrl('#' + escape(str));\n    }\n    return this.getAnchorUrl('');\n  }\n\n  /**\n   * Prefix the full url on anchor links to make sure that links are resolved\n   * relative to the current URL instead of the one defined in <base href>.\n   * @param {string} anchor The anchor hash, including the #.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getAnchorUrl(anchor) {\n    return (this.baseUrl || '') + anchor;\n  }\n\n  /**\n   * @param {string} hash\n   */\n  setHash(hash) {\n    let pageNumber, dest;\n    if (hash.includes('=')) {\n      let params = parseQueryString(hash);\n      if ('search' in params) {\n        this.eventBus.dispatch('findfromurlhash', {\n          source: this,\n          query: params['search'].replace(/\"/g, ''),\n          phraseSearch: (params['phrase'] === 'true'),\n        });\n      }\n      // borrowing syntax from \"Parameters for Opening PDF Files\"\n      if ('nameddest' in params) {\n        this.navigateTo(params.nameddest);\n        return;\n      }\n      if ('page' in params) {\n        pageNumber = (params.page | 0) || 1;\n      }\n      if ('zoom' in params) {\n        // Build the destination array.\n        let zoomArgs = params.zoom.split(','); // scale,left,top\n        let zoomArg = zoomArgs[0];\n        let zoomArgNumber = parseFloat(zoomArg);\n\n        if (!zoomArg.includes('Fit')) {\n          // If the zoomArg is a number, it has to get divided by 100. If it's\n          // a string, it should stay as it is.\n          dest = [null, { name: 'XYZ', },\n                  zoomArgs.length > 1 ? (zoomArgs[1] | 0) : null,\n                  zoomArgs.length > 2 ? (zoomArgs[2] | 0) : null,\n                  (zoomArgNumber ? zoomArgNumber / 100 : zoomArg)];\n        } else {\n          if (zoomArg === 'Fit' || zoomArg === 'FitB') {\n            dest = [null, { name: zoomArg, }];\n          } else if ((zoomArg === 'FitH' || zoomArg === 'FitBH') ||\n                     (zoomArg === 'FitV' || zoomArg === 'FitBV')) {\n            dest = [null, { name: zoomArg, },\n                    zoomArgs.length > 1 ? (zoomArgs[1] | 0) : null];\n          } else if (zoomArg === 'FitR') {\n            if (zoomArgs.length !== 5) {\n              console.error(\n                'PDFLinkService.setHash: Not enough parameters for \"FitR\".');\n            } else {\n              dest = [null, { name: zoomArg, },\n                      (zoomArgs[1] | 0), (zoomArgs[2] | 0),\n                      (zoomArgs[3] | 0), (zoomArgs[4] | 0)];\n            }\n          } else {\n            console.error(`PDFLinkService.setHash: \"${zoomArg}\" is not ` +\n                          'a valid zoom value.');\n          }\n        }\n      }\n      if (dest) {\n        this.pdfViewer.scrollPageIntoView({\n          pageNumber: pageNumber || this.page,\n          destArray: dest,\n          allowNegativeOffset: true,\n        });\n      } else if (pageNumber) {\n        this.page = pageNumber; // simple page\n      }\n      if ('pagemode' in params) {\n        this.eventBus.dispatch('pagemode', {\n          source: this,\n          mode: params.pagemode,\n        });\n      }\n    } else { // Named (or explicit) destination.\n      dest = unescape(hash);\n      try {\n        dest = JSON.parse(dest);\n\n        if (!Array.isArray(dest)) {\n          // Avoid incorrectly rejecting a valid named destination, such as\n          // e.g. \"4.3\" or \"true\", because `JSON.parse` converted its type.\n          dest = dest.toString();\n        }\n      } catch (ex) {}\n\n      if (typeof dest === 'string' || isValidExplicitDestination(dest)) {\n        this.navigateTo(dest);\n        return;\n      }\n      console.error(`PDFLinkService.setHash: \"${unescape(hash)}\" is not ` +\n                    'a valid destination.');\n    }\n  }\n\n  /**\n   * @param {string} action\n   */\n  executeNamedAction(action) {\n    // See PDF reference, table 8.45 - Named action\n    switch (action) {\n      case 'GoBack':\n        if (this.pdfHistory) {\n          this.pdfHistory.back();\n        }\n        break;\n\n      case 'GoForward':\n        if (this.pdfHistory) {\n          this.pdfHistory.forward();\n        }\n        break;\n\n      case 'NextPage':\n        if (this.page < this.pagesCount) {\n          this.page++;\n        }\n        break;\n\n      case 'PrevPage':\n        if (this.page > 1) {\n          this.page--;\n        }\n        break;\n\n      case 'LastPage':\n        this.page = this.pagesCount;\n        break;\n\n      case 'FirstPage':\n        this.page = 1;\n        break;\n\n      default:\n        break; // No action according to spec\n    }\n\n    this.eventBus.dispatch('namedaction', {\n      source: this,\n      action,\n    });\n  }\n\n  /**\n   * @param {number} pageNum - page number.\n   * @param {Object} pageRef - reference to the page.\n   */\n  cachePageRef(pageNum, pageRef) {\n    if (!pageRef) {\n      return;\n    }\n    const refStr = pageRef.gen === 0 ? `${pageRef.num}R` :\n                                       `${pageRef.num}R${pageRef.gen}`;\n    this._pagesRefCache[refStr] = pageNum;\n  }\n\n  _cachedPageNumber(pageRef) {\n    const refStr = pageRef.gen === 0 ? `${pageRef.num}R` :\n                                       `${pageRef.num}R${pageRef.gen}`;\n    return (this._pagesRefCache && this._pagesRefCache[refStr]) || null;\n  }\n\n  /**\n   * @param {number} pageNumber\n   */\n  isPageVisible(pageNumber) {\n    return this.pdfViewer.isPageVisible(pageNumber);\n  }\n}\n\nfunction isValidExplicitDestination(dest) {\n  if (!Array.isArray(dest)) {\n    return false;\n  }\n  let destLength = dest.length, allowNull = true;\n  if (destLength < 2) {\n    return false;\n  }\n  let page = dest[0];\n  if (!(typeof page === 'object' &&\n        Number.isInteger(page.num) && Number.isInteger(page.gen)) &&\n      !(Number.isInteger(page) && page >= 0)) {\n    return false;\n  }\n  let zoom = dest[1];\n  if (!(typeof zoom === 'object' && typeof zoom.name === 'string')) {\n    return false;\n  }\n  switch (zoom.name) {\n    case 'XYZ':\n      if (destLength !== 5) {\n        return false;\n      }\n      break;\n    case 'Fit':\n    case 'FitB':\n      return destLength === 2;\n    case 'FitH':\n    case 'FitBH':\n    case 'FitV':\n    case 'FitBV':\n      if (destLength !== 3) {\n        return false;\n      }\n      break;\n    case 'FitR':\n      if (destLength !== 6) {\n        return false;\n      }\n      allowNull = false;\n      break;\n    default:\n      return false;\n  }\n  for (let i = 2; i < destLength; i++) {\n    let param = dest[i];\n    if (!(typeof param === 'number' || (allowNull && param === null))) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * @implements {IPDFLinkService}\n */\nclass SimpleLinkService {\n  constructor() {\n    this.externalLinkTarget = null;\n    this.externalLinkRel = null;\n    this.externalLinkEnabled = true;\n  }\n\n  /**\n   * @type {number}\n   */\n  get pagesCount() {\n    return 0;\n  }\n\n  /**\n   * @type {number}\n   */\n  get page() {\n    return 0;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set page(value) {}\n\n  /**\n   * @type {number}\n   */\n  get rotation() {\n    return 0;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set rotation(value) {}\n\n  /**\n   * @param dest - The PDF destination object.\n   */\n  navigateTo(dest) {}\n\n  /**\n   * @param dest - The PDF destination object.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getDestinationHash(dest) {\n    return '#';\n  }\n\n  /**\n   * @param hash - The PDF parameters/hash.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getAnchorUrl(hash) {\n    return '#';\n  }\n\n  /**\n   * @param {string} hash\n   */\n  setHash(hash) {}\n\n  /**\n   * @param {string} action\n   */\n  executeNamedAction(action) {}\n\n  /**\n   * @param {number} pageNum - page number.\n   * @param {Object} pageRef - reference to the page.\n   */\n  cachePageRef(pageNum, pageRef) {}\n\n  /**\n   * @param {number} pageNumber\n   */\n  isPageVisible(pageNumber) {\n    return true;\n  }\n}\n\nexport {\n  PDFLinkService,\n  SimpleLinkService,\n};\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet compatibilityParams = Object.create(null);\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  const userAgent =\n    (typeof navigator !== 'undefined' && navigator.userAgent) || '';\n  const platform =\n    (typeof navigator !== 'undefined' && navigator.platform) || '';\n  const maxTouchPoints =\n    (typeof navigator !== 'undefined' && navigator.maxTouchPoints) || 1;\n\n  const isAndroid = /Android/.test(userAgent);\n  const isIOS = /\\b(iPad|iPhone|iPod)(?=;)/.test(userAgent) ||\n                (platform === 'MacIntel' && maxTouchPoints > 1);\n\n  // Limit canvas size to 5 mega-pixels on mobile.\n  // Support: Android, iOS\n  (function checkCanvasSizeLimitation() {\n    if (isIOS || isAndroid) {\n      compatibilityParams.maxCanvasPixels = 5242880;\n    }\n  })();\n}\n\nexports.viewerCompatibilityParams = Object.freeze(compatibilityParams);\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { GrabToPan } from './grab_to_pan';\n\nconst CursorTool = {\n  SELECT: 0, // The default value.\n  HAND: 1,\n  ZOOM: 2,\n};\n\n/**\n * @typedef {Object} PDFCursorToolsOptions\n * @property {HTMLDivElement} container - The document container.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} [cursorToolOnLoad] - The cursor tool that will be enabled\n *   on load; the constants from {CursorTool} should be used. The default value\n *   is `CursorTool.SELECT`.\n */\n\nclass PDFCursorTools {\n  /**\n   * @param {PDFCursorToolsOptions} options\n   */\n  constructor({ container, eventBus, cursorToolOnLoad = CursorTool.SELECT, }) {\n    this.container = container;\n    this.eventBus = eventBus;\n\n    this.active = CursorTool.SELECT;\n    this.activeBeforePresentationMode = null;\n\n    this.handTool = new GrabToPan({\n      element: this.container,\n    });\n\n    this._addEventListeners();\n\n    // Defer the initial `switchTool` call, to give other viewer components\n    // time to initialize *and* register 'cursortoolchanged' event listeners.\n    Promise.resolve().then(() => {\n      this.switchTool(cursorToolOnLoad);\n    });\n  }\n\n  /**\n   * @type {number} One of the values in {CursorTool}.\n   */\n  get activeTool() {\n    return this.active;\n  }\n\n  /**\n   * NOTE: This method is ignored while Presentation Mode is active.\n   * @param {number} tool - The cursor mode that should be switched to,\n   *                        must be one of the values in {CursorTool}.\n   */\n  switchTool(tool) {\n    if (this.activeBeforePresentationMode !== null) {\n      return; // Cursor tools cannot be used in Presentation Mode.\n    }\n    if (tool === this.active) {\n      return; // The requested tool is already active.\n    }\n\n    let disableActiveTool = () => {\n      switch (this.active) {\n        case CursorTool.SELECT:\n          break;\n        case CursorTool.HAND:\n          this.handTool.deactivate();\n          break;\n        case CursorTool.ZOOM:\n          /* falls through */\n      }\n    };\n\n    switch (tool) { // Enable the new cursor tool.\n      case CursorTool.SELECT:\n        disableActiveTool();\n        break;\n      case CursorTool.HAND:\n        disableActiveTool();\n        this.handTool.activate();\n        break;\n      case CursorTool.ZOOM:\n        /* falls through */\n      default:\n        console.error(`switchTool: \"${tool}\" is an unsupported value.`);\n        return;\n    }\n    // Update the active tool *after* it has been validated above,\n    // in order to prevent setting it to an invalid state.\n    this.active = tool;\n\n    this._dispatchEvent();\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent() {\n    this.eventBus.dispatch('cursortoolchanged', {\n      source: this,\n      tool: this.active,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _addEventListeners() {\n    this.eventBus.on('switchcursortool', (evt) => {\n      this.switchTool(evt.tool);\n    });\n\n    this.eventBus.on('presentationmodechanged', (evt) => {\n      if (evt.switchInProgress) {\n        return;\n      }\n      let previouslyActive;\n\n      if (evt.active) {\n        previouslyActive = this.active;\n\n        this.switchTool(CursorTool.SELECT);\n        this.activeBeforePresentationMode = previouslyActive;\n      } else {\n        previouslyActive = this.activeBeforePresentationMode;\n\n        this.activeBeforePresentationMode = null;\n        this.switchTool(previouslyActive);\n      }\n    });\n  }\n}\n\nexport {\n  CursorTool,\n  PDFCursorTools,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus, scrollIntoView } from './ui_utils';\nimport { createPromiseCapability } from 'pdfjs-lib';\nimport { getCharacterType } from './pdf_find_utils';\n\nconst FindState = {\n  FOUND: 0,\n  NOT_FOUND: 1,\n  WRAPPED: 2,\n  PENDING: 3,\n};\n\nconst FIND_TIMEOUT = 250; // ms\nconst MATCH_SCROLL_OFFSET_TOP = -50; // px\nconst MATCH_SCROLL_OFFSET_LEFT = -400; // px\n\nconst CHARACTERS_TO_NORMALIZE = {\n  '\\u2018': '\\'', // Left single quotation mark\n  '\\u2019': '\\'', // Right single quotation mark\n  '\\u201A': '\\'', // Single low-9 quotation mark\n  '\\u201B': '\\'', // Single high-reversed-9 quotation mark\n  '\\u201C': '\"', // Left double quotation mark\n  '\\u201D': '\"', // Right double quotation mark\n  '\\u201E': '\"', // Double low-9 quotation mark\n  '\\u201F': '\"', // Double high-reversed-9 quotation mark\n  '\\u00BC': '1/4', // Vulgar fraction one quarter\n  '\\u00BD': '1/2', // Vulgar fraction one half\n  '\\u00BE': '3/4', // Vulgar fraction three quarters\n};\n\nlet normalizationRegex = null;\nfunction normalize(text) {\n  if (!normalizationRegex) {\n    // Compile the regular expression for text normalization once.\n    const replace = Object.keys(CHARACTERS_TO_NORMALIZE).join('');\n    normalizationRegex = new RegExp(`[${replace}]`, 'g');\n  }\n  return text.replace(normalizationRegex, function(ch) {\n    return CHARACTERS_TO_NORMALIZE[ch];\n  });\n}\n\n/**\n * @typedef {Object} PDFFindControllerOptions\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * Provides search functionality to find a given string in a PDF document.\n */\nclass PDFFindController {\n  /**\n   * @param {PDFFindControllerOptions} options\n   */\n  constructor({ linkService, eventBus = getGlobalEventBus(), }) {\n    this._linkService = linkService;\n    this._eventBus = eventBus;\n\n    this._reset();\n    eventBus.on('findbarclose', this._onFindBarClose.bind(this));\n  }\n\n  get highlightMatches() {\n    return this._highlightMatches;\n  }\n\n  get pageMatches() {\n    return this._pageMatches;\n  }\n\n  get pageMatchesLength() {\n    return this._pageMatchesLength;\n  }\n\n  get selected() {\n    return this._selected;\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  /**\n   * Set a reference to the PDF document in order to search it.\n   * Note that searching is not possible if this method is not called.\n   *\n   * @param {PDFDocumentProxy} pdfDocument - The PDF document to search.\n   */\n  setDocument(pdfDocument) {\n    if (this._pdfDocument) {\n      this._reset();\n    }\n    if (!pdfDocument) {\n      return;\n    }\n    this._pdfDocument = pdfDocument;\n    this._firstPageCapability.resolve();\n  }\n\n  executeCommand(cmd, state) {\n    if (!state) {\n      return;\n    }\n    const pdfDocument = this._pdfDocument;\n\n    if (this._state === null || this._shouldDirtyMatch(cmd, state)) {\n      this._dirtyMatch = true;\n    }\n    this._state = state;\n    if (cmd !== 'findhighlightallchange') {\n      this._updateUIState(FindState.PENDING);\n    }\n\n    this._firstPageCapability.promise.then(() => {\n      // If the document was closed before searching began, or if the search\n      // operation was relevant for a previously opened document, do nothing.\n      if (!this._pdfDocument ||\n          (pdfDocument && this._pdfDocument !== pdfDocument)) {\n        return;\n      }\n      this._extractText();\n\n      const findbarClosed = !this._highlightMatches;\n      const pendingTimeout = !!this._findTimeout;\n\n      if (this._findTimeout) {\n        clearTimeout(this._findTimeout);\n        this._findTimeout = null;\n      }\n      if (cmd === 'find') {\n        // Trigger the find action with a small delay to avoid starting the\n        // search when the user is still typing (saving resources).\n        this._findTimeout = setTimeout(() => {\n          this._nextMatch();\n          this._findTimeout = null;\n        }, FIND_TIMEOUT);\n      } else if (this._dirtyMatch) {\n        // Immediately trigger searching for non-'find' operations, when the\n        // current state needs to be reset and matches re-calculated.\n        this._nextMatch();\n      } else if (cmd === 'findagain') {\n        this._nextMatch();\n\n        // When the findbar was previously closed, and `highlightAll` is set,\n        // ensure that the matches on all active pages are highlighted again.\n        if (findbarClosed && this._state.highlightAll) {\n          this._updateAllPages();\n        }\n      } else if (cmd === 'findhighlightallchange') {\n        // If there was a pending search operation, synchronously trigger a new\n        // search *first* to ensure that the correct matches are highlighted.\n        if (pendingTimeout) {\n          this._nextMatch();\n        } else {\n          this._highlightMatches = true;\n        }\n        this._updateAllPages(); // Update the highlighting on all active pages.\n      } else {\n        this._nextMatch();\n      }\n    });\n  }\n\n  scrollMatchIntoView({ element = null, pageIndex = -1, matchIndex = -1, }) {\n    if (!this._scrollMatches || !element) {\n      return;\n    } else if (matchIndex === -1 || matchIndex !== this._selected.matchIdx) {\n      return;\n    } else if (pageIndex === -1 || pageIndex !== this._selected.pageIdx) {\n      return;\n    }\n    this._scrollMatches = false; // Ensure that scrolling only happens once.\n\n    const spot = {\n      top: MATCH_SCROLL_OFFSET_TOP,\n      left: MATCH_SCROLL_OFFSET_LEFT,\n    };\n    scrollIntoView(element, spot, /* skipOverflowHiddenElements = */ true);\n  }\n\n  _reset() {\n    this._highlightMatches = false;\n    this._scrollMatches = false;\n    this._pdfDocument = null;\n    this._pageMatches = [];\n    this._pageMatchesLength = [];\n    this._state = null;\n    this._selected = { // Currently selected match.\n      pageIdx: -1,\n      matchIdx: -1,\n    };\n    this._offset = { // Where the find algorithm currently is in the document.\n      pageIdx: null,\n      matchIdx: null,\n      wrapped: false,\n    };\n    this._extractTextPromises = [];\n    this._pageContents = []; // Stores the normalized text for each page.\n    this._matchesCountTotal = 0;\n    this._pagesToSearch = null;\n    this._pendingFindMatches = Object.create(null);\n    this._resumePageIdx = null;\n    this._dirtyMatch = false;\n    clearTimeout(this._findTimeout);\n    this._findTimeout = null;\n\n    this._firstPageCapability = createPromiseCapability();\n  }\n\n  /**\n   * @type {string} The (current) normalized search query.\n   */\n  get _query() {\n    if (this._state.query !== this._rawQuery) {\n      this._rawQuery = this._state.query;\n      this._normalizedQuery = normalize(this._state.query);\n    }\n    return this._normalizedQuery;\n  }\n\n  _shouldDirtyMatch(cmd, state) {\n    // When the search query changes, regardless of the actual search command\n    // used, always re-calculate matches to avoid errors (fixes bug 1030622).\n    if (state.query !== this._state.query) {\n      return true;\n    }\n    switch (cmd) {\n      case 'findagain':\n        const pageNumber = this._selected.pageIdx + 1;\n        const linkService = this._linkService;\n        // Only treat a 'findagain' event as a new search operation when it's\n        // *absolutely* certain that the currently selected match is no longer\n        // visible, e.g. as a result of the user scrolling in the document.\n        //\n        // NOTE: If only a simple `this._linkService.page` check was used here,\n        // there's a risk that consecutive 'findagain' operations could \"skip\"\n        // over matches at the top/bottom of pages thus making them completely\n        // inaccessible when there's multiple pages visible in the viewer.\n        if (pageNumber >= 1 && pageNumber <= linkService.pagesCount &&\n            pageNumber !== linkService.page &&\n            !linkService.isPageVisible(pageNumber)) {\n          return true;\n        }\n        return false;\n      case 'findhighlightallchange':\n        return false;\n    }\n    return true;\n  }\n\n  /**\n   * Helper for multi-term search that fills the `matchesWithLength` array\n   * and handles cases where one search term includes another search term (for\n   * example, \"tamed tame\" or \"this is\"). It looks for intersecting terms in\n   * the `matches` and keeps elements with a longer match length.\n   */\n  _prepareMatches(matchesWithLength, matches, matchesLength) {\n    function isSubTerm(matchesWithLength, currentIndex) {\n      const currentElem = matchesWithLength[currentIndex];\n      const nextElem = matchesWithLength[currentIndex + 1];\n\n      // Check for cases like \"TAMEd TAME\".\n      if (currentIndex < matchesWithLength.length - 1 &&\n          currentElem.match === nextElem.match) {\n        currentElem.skipped = true;\n        return true;\n      }\n\n      // Check for cases like \"thIS IS\".\n      for (let i = currentIndex - 1; i >= 0; i--) {\n        const prevElem = matchesWithLength[i];\n        if (prevElem.skipped) {\n          continue;\n        }\n        if (prevElem.match + prevElem.matchLength < currentElem.match) {\n          break;\n        }\n        if (prevElem.match + prevElem.matchLength >=\n            currentElem.match + currentElem.matchLength) {\n          currentElem.skipped = true;\n          return true;\n        }\n      }\n      return false;\n    }\n\n    // Sort the array of `{ match: <match>, matchLength: <matchLength> }`\n    // objects on increasing index first and on the length otherwise.\n    matchesWithLength.sort(function(a, b) {\n      return a.match === b.match ? a.matchLength - b.matchLength :\n                                   a.match - b.match;\n    });\n    for (let i = 0, len = matchesWithLength.length; i < len; i++) {\n      if (isSubTerm(matchesWithLength, i)) {\n        continue;\n      }\n      matches.push(matchesWithLength[i].match);\n      matchesLength.push(matchesWithLength[i].matchLength);\n    }\n  }\n\n  /**\n   * Determine if the search query constitutes a \"whole word\", by comparing the\n   * first/last character type with the preceding/following character type.\n   */\n  _isEntireWord(content, startIdx, length) {\n    if (startIdx > 0) {\n      const first = content.charCodeAt(startIdx);\n      const limit = content.charCodeAt(startIdx - 1);\n      if (getCharacterType(first) === getCharacterType(limit)) {\n        return false;\n      }\n    }\n    const endIdx = (startIdx + length - 1);\n    if (endIdx < (content.length - 1)) {\n      const last = content.charCodeAt(endIdx);\n      const limit = content.charCodeAt(endIdx + 1);\n      if (getCharacterType(last) === getCharacterType(limit)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  _calculatePhraseMatch(query, pageIndex, pageContent, entireWord) {\n    const matches = [];\n    const queryLen = query.length;\n\n    let matchIdx = -queryLen;\n    while (true) {\n      matchIdx = pageContent.indexOf(query, matchIdx + queryLen);\n      if (matchIdx === -1) {\n        break;\n      }\n      if (entireWord && !this._isEntireWord(pageContent, matchIdx, queryLen)) {\n        continue;\n      }\n      matches.push(matchIdx);\n    }\n    this._pageMatches[pageIndex] = matches;\n  }\n\n  _calculateWordMatch(query, pageIndex, pageContent, entireWord) {\n    const matchesWithLength = [];\n\n    // Divide the query into pieces and search for text in each piece.\n    const queryArray = query.match(/\\S+/g);\n    for (let i = 0, len = queryArray.length; i < len; i++) {\n      const subquery = queryArray[i];\n      const subqueryLen = subquery.length;\n\n      let matchIdx = -subqueryLen;\n      while (true) {\n        matchIdx = pageContent.indexOf(subquery, matchIdx + subqueryLen);\n        if (matchIdx === -1) {\n          break;\n        }\n        if (entireWord &&\n            !this._isEntireWord(pageContent, matchIdx, subqueryLen)) {\n          continue;\n        }\n        // Other searches do not, so we store the length.\n        matchesWithLength.push({\n          match: matchIdx,\n          matchLength: subqueryLen,\n          skipped: false,\n        });\n      }\n    }\n\n    // Prepare arrays for storing the matches.\n    this._pageMatchesLength[pageIndex] = [];\n    this._pageMatches[pageIndex] = [];\n\n    // Sort `matchesWithLength`, remove intersecting terms and put the result\n    // into the two arrays.\n    this._prepareMatches(matchesWithLength, this._pageMatches[pageIndex],\n      this._pageMatchesLength[pageIndex]);\n  }\n\n  _calculateMatch(pageIndex) {\n    let pageContent = this._pageContents[pageIndex];\n    let query = this._query;\n    const { caseSensitive, entireWord, phraseSearch, } = this._state;\n\n    if (query.length === 0) {\n      // Do nothing: the matches should be wiped out already.\n      return;\n    }\n\n    if (!caseSensitive) {\n      pageContent = pageContent.toLowerCase();\n      query = query.toLowerCase();\n    }\n\n    if (phraseSearch) {\n      this._calculatePhraseMatch(query, pageIndex, pageContent, entireWord);\n    } else {\n      this._calculateWordMatch(query, pageIndex, pageContent, entireWord);\n    }\n\n    // When `highlightAll` is set, ensure that the matches on previously\n    // rendered (and still active) pages are correctly highlighted.\n    if (this._state.highlightAll) {\n      this._updatePage(pageIndex);\n    }\n    if (this._resumePageIdx === pageIndex) {\n      this._resumePageIdx = null;\n      this._nextPageMatch();\n    }\n\n    // Update the match count.\n    const pageMatchesCount = this._pageMatches[pageIndex].length;\n    if (pageMatchesCount > 0) {\n      this._matchesCountTotal += pageMatchesCount;\n      this._updateUIResultsCount();\n    }\n  }\n\n  _extractText() {\n    // Perform text extraction once if this method is called multiple times.\n    if (this._extractTextPromises.length > 0) {\n      return;\n    }\n\n    let promise = Promise.resolve();\n    for (let i = 0, ii = this._linkService.pagesCount; i < ii; i++) {\n      const extractTextCapability = createPromiseCapability();\n      this._extractTextPromises[i] = extractTextCapability.promise;\n\n      promise = promise.then(() => {\n        return this._pdfDocument.getPage(i + 1).then((pdfPage) => {\n          return pdfPage.getTextContent({\n            normalizeWhitespace: true,\n          });\n        }).then((textContent) => {\n          const textItems = textContent.items;\n          const strBuf = [];\n\n          for (let j = 0, jj = textItems.length; j < jj; j++) {\n            strBuf.push(textItems[j].str);\n          }\n\n          // Store the normalized page content (text items) as one string.\n          this._pageContents[i] = normalize(strBuf.join(''));\n          extractTextCapability.resolve(i);\n        }, (reason) => {\n          console.error(`Unable to get text content for page ${i + 1}`, reason);\n          // Page error -- assuming no text content.\n          this._pageContents[i] = '';\n          extractTextCapability.resolve(i);\n        });\n      });\n    }\n  }\n\n  _updatePage(index) {\n    if (this._scrollMatches && this._selected.pageIdx === index) {\n      // If the page is selected, scroll the page into view, which triggers\n      // rendering the page, which adds the text layer. Once the text layer\n      // is built, it will attempt to scroll the selected match into view.\n      this._linkService.page = index + 1;\n    }\n\n    this._eventBus.dispatch('updatetextlayermatches', {\n      source: this,\n      pageIndex: index,\n    });\n  }\n\n  _updateAllPages() {\n    this._eventBus.dispatch('updatetextlayermatches', {\n      source: this,\n      pageIndex: -1,\n    });\n  }\n\n  _nextMatch() {\n    const previous = this._state.findPrevious;\n    const currentPageIndex = this._linkService.page - 1;\n    const numPages = this._linkService.pagesCount;\n\n    this._highlightMatches = true;\n\n    if (this._dirtyMatch) {\n      // Need to recalculate the matches, reset everything.\n      this._dirtyMatch = false;\n      this._selected.pageIdx = this._selected.matchIdx = -1;\n      this._offset.pageIdx = currentPageIndex;\n      this._offset.matchIdx = null;\n      this._offset.wrapped = false;\n      this._resumePageIdx = null;\n      this._pageMatches.length = 0;\n      this._pageMatchesLength.length = 0;\n      this._matchesCountTotal = 0;\n\n      this._updateAllPages(); // Wipe out any previously highlighted matches.\n\n      for (let i = 0; i < numPages; i++) {\n        // Start finding the matches as soon as the text is extracted.\n        if (this._pendingFindMatches[i] === true) {\n          continue;\n        }\n        this._pendingFindMatches[i] = true;\n        this._extractTextPromises[i].then((pageIdx) => {\n          delete this._pendingFindMatches[pageIdx];\n          this._calculateMatch(pageIdx);\n        });\n      }\n    }\n\n    // If there's no query there's no point in searching.\n    if (this._query === '') {\n      this._updateUIState(FindState.FOUND);\n      return;\n    }\n    // If we're waiting on a page, we return since we can't do anything else.\n    if (this._resumePageIdx) {\n      return;\n    }\n\n    const offset = this._offset;\n    // Keep track of how many pages we should maximally iterate through.\n    this._pagesToSearch = numPages;\n    // If there's already a `matchIdx` that means we are iterating through a\n    // page's matches.\n    if (offset.matchIdx !== null) {\n      const numPageMatches = this._pageMatches[offset.pageIdx].length;\n      if ((!previous && offset.matchIdx + 1 < numPageMatches) ||\n          (previous && offset.matchIdx > 0)) {\n        // The simple case; we just have advance the matchIdx to select\n        // the next match on the page.\n        offset.matchIdx = (previous ? offset.matchIdx - 1 :\n                                      offset.matchIdx + 1);\n        this._updateMatch(/* found = */ true);\n        return;\n      }\n      // We went beyond the current page's matches, so we advance to\n      // the next page.\n      this._advanceOffsetPage(previous);\n    }\n    // Start searching through the page.\n    this._nextPageMatch();\n  }\n\n  _matchesReady(matches) {\n    const offset = this._offset;\n    const numMatches = matches.length;\n    const previous = this._state.findPrevious;\n\n    if (numMatches) {\n      // There were matches for the page, so initialize `matchIdx`.\n      offset.matchIdx = (previous ? numMatches - 1 : 0);\n      this._updateMatch(/* found = */ true);\n      return true;\n    }\n    // No matches, so attempt to search the next page.\n    this._advanceOffsetPage(previous);\n    if (offset.wrapped) {\n      offset.matchIdx = null;\n      if (this._pagesToSearch < 0) {\n        // No point in wrapping again, there were no matches.\n        this._updateMatch(/* found = */ false);\n        // While matches were not found, searching for a page\n        // with matches should nevertheless halt.\n        return true;\n      }\n    }\n    // Matches were not found (and searching is not done).\n    return false;\n  }\n\n  _nextPageMatch() {\n    if (this._resumePageIdx !== null) {\n      console.error('There can only be one pending page.');\n    }\n\n    let matches = null;\n    do {\n      const pageIdx = this._offset.pageIdx;\n      matches = this._pageMatches[pageIdx];\n      if (!matches) {\n        // The matches don't exist yet for processing by `_matchesReady`,\n        // so set a resume point for when they do exist.\n        this._resumePageIdx = pageIdx;\n        break;\n      }\n    } while (!this._matchesReady(matches));\n  }\n\n  _advanceOffsetPage(previous) {\n    const offset = this._offset;\n    const numPages = this._linkService.pagesCount;\n    offset.pageIdx = (previous ? offset.pageIdx - 1 : offset.pageIdx + 1);\n    offset.matchIdx = null;\n\n    this._pagesToSearch--;\n\n    if (offset.pageIdx >= numPages || offset.pageIdx < 0) {\n      offset.pageIdx = (previous ? numPages - 1 : 0);\n      offset.wrapped = true;\n    }\n  }\n\n  _updateMatch(found = false) {\n    let state = FindState.NOT_FOUND;\n    const wrapped = this._offset.wrapped;\n    this._offset.wrapped = false;\n\n    if (found) {\n      const previousPage = this._selected.pageIdx;\n      this._selected.pageIdx = this._offset.pageIdx;\n      this._selected.matchIdx = this._offset.matchIdx;\n      state = (wrapped ? FindState.WRAPPED : FindState.FOUND);\n\n      // Update the currently selected page to wipe out any selected matches.\n      if (previousPage !== -1 && previousPage !== this._selected.pageIdx) {\n        this._updatePage(previousPage);\n      }\n    }\n\n    this._updateUIState(state, this._state.findPrevious);\n    if (this._selected.pageIdx !== -1) {\n      // Ensure that the match will be scrolled into view.\n      this._scrollMatches = true;\n\n      this._updatePage(this._selected.pageIdx);\n    }\n  }\n\n  _onFindBarClose(evt) {\n    const pdfDocument = this._pdfDocument;\n    // Since searching is asynchronous, ensure that the removal of highlighted\n    // matches (from the UI) is async too such that the 'updatetextlayermatches'\n    // events will always be dispatched in the expected order.\n    this._firstPageCapability.promise.then(() => {\n      // Only update the UI if the document is open, and is the current one.\n      if (!this._pdfDocument ||\n          (pdfDocument && this._pdfDocument !== pdfDocument)) {\n        return;\n      }\n      // Ensure that a pending, not yet started, search operation is aborted.\n      if (this._findTimeout) {\n        clearTimeout(this._findTimeout);\n        this._findTimeout = null;\n      }\n      // Abort any long running searches, to avoid a match being scrolled into\n      // view *after* the findbar has been closed. In this case `this._offset`\n      // will most likely differ from `this._selected`, hence we also ensure\n      // that any new search operation will always start with a clean slate.\n      if (this._resumePageIdx) {\n        this._resumePageIdx = null;\n        this._dirtyMatch = true;\n      }\n      // Avoid the UI being in a pending state when the findbar is re-opened.\n      this._updateUIState(FindState.FOUND);\n\n      this._highlightMatches = false;\n      this._updateAllPages(); // Wipe out any previously highlighted matches.\n    });\n  }\n\n  _requestMatchesCount() {\n    const { pageIdx, matchIdx, } = this._selected;\n    let current = 0, total = this._matchesCountTotal;\n    if (matchIdx !== -1) {\n      for (let i = 0; i < pageIdx; i++) {\n        current += (this._pageMatches[i] && this._pageMatches[i].length) || 0;\n      }\n      current += matchIdx + 1;\n    }\n    // When searching starts, this method may be called before the `pageMatches`\n    // have been counted (in `_calculateMatch`). Ensure that the UI won't show\n    // temporarily broken state when the active find result doesn't make sense.\n    if (current < 1 || current > total) {\n      current = total = 0;\n    }\n    return { current, total, };\n  }\n\n  _updateUIResultsCount() {\n    this._eventBus.dispatch('updatefindmatchescount', {\n      source: this,\n      matchesCount: this._requestMatchesCount(),\n    });\n  }\n\n  _updateUIState(state, previous) {\n    this._eventBus.dispatch('updatefindcontrolstate', {\n      source: this,\n      state,\n      previous,\n      matchesCount: this._requestMatchesCount(),\n    });\n  }\n}\n\nexport {\n  FindState,\n  PDFFindController,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  CSS_UNITS, DEFAULT_SCALE, DEFAULT_SCALE_VALUE, getGlobalEventBus,\n  getVisibleElements, isPortraitOrientation, isValidRotation, isValidScrollMode,\n  isValidSpreadMode, MAX_AUTO_SCALE, moveToEndOfArray, NullL10n,\n  PresentationModeState, RendererType, SCROLLBAR_PADDING, scrollIntoView,\n  ScrollMode, SpreadMode, TextLayerMode, UNKNOWN_SCALE, VERTICAL_PADDING,\n  watchScroll\n} from './ui_utils';\nimport { PDFRenderingQueue, RenderingStates } from './pdf_rendering_queue';\nimport { AnnotationLayerBuilder } from './annotation_layer_builder';\nimport { createPromiseCapability } from 'pdfjs-lib';\nimport { PDFPageView } from './pdf_page_view';\nimport { SimpleLinkService } from './pdf_link_service';\nimport { TextLayerBuilder } from './text_layer_builder';\n\nconst DEFAULT_CACHE_SIZE = 10;\n\n/**\n * @typedef {Object} PDFViewerOptions\n * @property {HTMLDivElement} container - The container for the viewer element.\n * @property {HTMLDivElement} [viewer] - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {DownloadManager} [downloadManager] - The download manager\n *   component.\n * @property {PDFFindController} [findController] - The find controller\n *   component.\n * @property {PDFRenderingQueue} [renderingQueue] - The rendering queue object.\n * @property {boolean} [removePageBorders] - Removes the border shadow around\n *   the pages. The default value is `false`.\n * @property {number} [textLayerMode] - Controls if the text layer used for\n *   selection and searching is created, and if the improved text selection\n *   behaviour is enabled. The constants from {TextLayerMode} should be used.\n *   The default value is `TextLayerMode.ENABLE`.\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   mainly for annotation icons. Include trailing slash.\n * @property {boolean} [renderInteractiveForms] - Enables rendering of\n *   interactive form elements. The default is `false`.\n * @property {boolean} [enablePrintAutoRotate] - Enables automatic rotation of\n *   pages whose orientation differ from the first page upon printing. The\n *   default is `false`.\n * @property {string} renderer - 'canvas' or 'svg'. The default is 'canvas'.\n * @property {boolean} [enableWebGL] - Enables WebGL accelerated rendering for\n *   some operations. The default value is `false`.\n * @property {boolean} [useOnlyCssZoom] - Enables CSS only zooming. The default\n *   value is `false`.\n * @property {number} [maxCanvasPixels] - The maximum supported canvas size in\n *   total pixels, i.e. width * height. Use -1 for no limit. The default value\n *   is 4096 * 4096 (16 mega-pixels).\n * @property {IL10n} l10n - Localization service.\n */\n\nfunction PDFPageViewBuffer(size) {\n  let data = [];\n  this.push = function(view) {\n    let i = data.indexOf(view);\n    if (i >= 0) {\n      data.splice(i, 1);\n    }\n    data.push(view);\n    if (data.length > size) {\n      data.shift().destroy();\n    }\n  };\n  /**\n   * After calling resize, the size of the buffer will be newSize. The optional\n   * parameter pagesToKeep is, if present, an array of pages to push to the back\n   * of the buffer, delaying their destruction. The size of pagesToKeep has no\n   * impact on the final size of the buffer; if pagesToKeep has length larger\n   * than newSize, some of those pages will be destroyed anyway.\n   */\n  this.resize = function(newSize, pagesToKeep) {\n    size = newSize;\n    if (pagesToKeep) {\n      const pageIdsToKeep = new Set();\n      for (let i = 0, iMax = pagesToKeep.length; i < iMax; ++i) {\n        pageIdsToKeep.add(pagesToKeep[i].id);\n      }\n      moveToEndOfArray(data, function(page) {\n        return pageIdsToKeep.has(page.id);\n      });\n    }\n    while (data.length > size) {\n      data.shift().destroy();\n    }\n  };\n}\n\nfunction isSameScale(oldScale, newScale) {\n  if (newScale === oldScale) {\n    return true;\n  }\n  if (Math.abs(newScale - oldScale) < 1e-15) {\n    // Prevent unnecessary re-rendering of all pages when the scale\n    // changes only because of limited numerical precision.\n    return true;\n  }\n  return false;\n}\n\n/**\n * Simple viewer control to display PDF content/pages.\n * @implements {IRenderableView}\n */\nclass BaseViewer {\n  /**\n   * @param {PDFViewerOptions} options\n   */\n  constructor(options) {\n    if (this.constructor === BaseViewer) {\n      throw new Error('Cannot initialize BaseViewer.');\n    }\n    this._name = this.constructor.name;\n\n    this.container = options.container;\n    this.viewer = options.viewer || options.container.firstElementChild;\n    this.eventBus = options.eventBus || getGlobalEventBus();\n    this.linkService = options.linkService || new SimpleLinkService();\n    this.downloadManager = options.downloadManager || null;\n    this.findController = options.findController || null;\n    this.removePageBorders = options.removePageBorders || false;\n    this.textLayerMode = Number.isInteger(options.textLayerMode) ?\n      options.textLayerMode : TextLayerMode.ENABLE;\n    this.imageResourcesPath = options.imageResourcesPath || '';\n    this.renderInteractiveForms = options.renderInteractiveForms || false;\n    this.enablePrintAutoRotate = options.enablePrintAutoRotate || false;\n    this.renderer = options.renderer || RendererType.CANVAS;\n    this.enableWebGL = options.enableWebGL || false;\n    this.useOnlyCssZoom = options.useOnlyCssZoom || false;\n    this.maxCanvasPixels = options.maxCanvasPixels;\n    this.l10n = options.l10n || NullL10n;\n\n    this.defaultRenderingQueue = !options.renderingQueue;\n    if (this.defaultRenderingQueue) {\n      // Custom rendering queue is not specified, using default one\n      this.renderingQueue = new PDFRenderingQueue();\n      this.renderingQueue.setViewer(this);\n    } else {\n      this.renderingQueue = options.renderingQueue;\n    }\n\n    this.scroll = watchScroll(this.container, this._scrollUpdate.bind(this));\n    this.presentationModeState = PresentationModeState.UNKNOWN;\n    this._onBeforeDraw = this._onAfterDraw = null;\n    this._resetView();\n\n    if (this.removePageBorders) {\n      this.viewer.classList.add('removePageBorders');\n    }\n    // Defer the dispatching of this event, to give other viewer components\n    // time to initialize *and* register 'baseviewerinit' event listeners.\n    Promise.resolve().then(() => {\n      this.eventBus.dispatch('baseviewerinit', { source: this, });\n    });\n  }\n\n  get pagesCount() {\n    return this._pages.length;\n  }\n\n  getPageView(index) {\n    return this._pages[index];\n  }\n\n  /**\n   * @type {boolean} - True if all {PDFPageView} objects are initialized.\n   */\n  get pageViewsReady() {\n    return this._pageViewsReady;\n  }\n\n  /**\n   * @type {number}\n   */\n  get currentPageNumber() {\n    return this._currentPageNumber;\n  }\n\n  /**\n   * @param {number} val - The page number.\n   */\n  set currentPageNumber(val) {\n    if (!Number.isInteger(val)) {\n      throw new Error('Invalid page number.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    // The intent can be to just reset a scroll position and/or scale.\n    if (!this._setCurrentPageNumber(val, /* resetCurrentPageView = */ true)) {\n      console.error(\n        `${this._name}.currentPageNumber: \"${val}\" is not a valid page.`);\n    }\n  }\n\n  /**\n   * @returns {boolean} Whether the pageNumber is valid (within bounds).\n   * @private\n   */\n  _setCurrentPageNumber(val, resetCurrentPageView = false) {\n    if (this._currentPageNumber === val) {\n      if (resetCurrentPageView) {\n        this._resetCurrentPageView();\n      }\n      return true;\n    }\n\n    if (!(0 < val && val <= this.pagesCount)) {\n      return false;\n    }\n    this._currentPageNumber = val;\n\n    this.eventBus.dispatch('pagechanging', {\n      source: this,\n      pageNumber: val,\n      pageLabel: this._pageLabels && this._pageLabels[val - 1],\n    });\n\n    if (resetCurrentPageView) {\n      this._resetCurrentPageView();\n    }\n    return true;\n  }\n\n  /**\n   * @type {string|null} Returns the current page label, or `null` if no page\n   *   labels exist.\n   */\n  get currentPageLabel() {\n    return this._pageLabels && this._pageLabels[this._currentPageNumber - 1];\n  }\n\n  /**\n   * @param {string} val - The page label.\n   */\n  set currentPageLabel(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let page = val | 0; // Fallback page number.\n    if (this._pageLabels) {\n      let i = this._pageLabels.indexOf(val);\n      if (i >= 0) {\n        page = i + 1;\n      }\n    }\n    // The intent can be to just reset a scroll position and/or scale.\n    if (!this._setCurrentPageNumber(page, /* resetCurrentPageView = */ true)) {\n      console.error(\n        `${this._name}.currentPageLabel: \"${val}\" is not a valid page.`);\n    }\n  }\n\n  /**\n   * @type {number}\n   */\n  get currentScale() {\n    return this._currentScale !== UNKNOWN_SCALE ? this._currentScale :\n                                                  DEFAULT_SCALE;\n  }\n\n  /**\n   * @param {number} val - Scale of the pages in percents.\n   */\n  set currentScale(val) {\n    if (isNaN(val)) {\n      throw new Error('Invalid numeric scale.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    this._setScale(val, false);\n  }\n\n  /**\n   * @type {string}\n   */\n  get currentScaleValue() {\n    return this._currentScaleValue;\n  }\n\n  /**\n   * @param val - The scale of the pages (in percent or predefined value).\n   */\n  set currentScaleValue(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    this._setScale(val, false);\n  }\n\n  /**\n   * @type {number}\n   */\n  get pagesRotation() {\n    return this._pagesRotation;\n  }\n\n  /**\n   * @param {number} rotation - The rotation of the pages (0, 90, 180, 270).\n   */\n  set pagesRotation(rotation) {\n    if (!isValidRotation(rotation)) {\n      throw new Error('Invalid pages rotation angle.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (this._pagesRotation === rotation) {\n      return; // The rotation didn't change.\n    }\n    this._pagesRotation = rotation;\n\n    let pageNumber = this._currentPageNumber;\n\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      let pageView = this._pages[i];\n      pageView.update(pageView.scale, rotation);\n    }\n    // Prevent errors in case the rotation changes *before* the scale has been\n    // set to a non-default value.\n    if (this._currentScaleValue) {\n      this._setScale(this._currentScaleValue, true);\n    }\n\n    this.eventBus.dispatch('rotationchanging', {\n      source: this,\n      pagesRotation: rotation,\n      pageNumber,\n    });\n\n    if (this.defaultRenderingQueue) {\n      this.update();\n    }\n  }\n\n  get _setDocumentViewerElement() {\n    // In most viewers, e.g. `PDFViewer`, this should return `this.viewer`.\n    throw new Error('Not implemented: _setDocumentViewerElement');\n  }\n\n  /**\n   * @param pdfDocument {PDFDocument}\n   */\n  setDocument(pdfDocument) {\n    if (this.pdfDocument) {\n      this._cancelRendering();\n      this._resetView();\n\n      if (this.findController) {\n        this.findController.setDocument(null);\n      }\n    }\n\n    this.pdfDocument = pdfDocument;\n    if (!pdfDocument) {\n      return;\n    }\n    let pagesCount = pdfDocument.numPages;\n\n    let pagesCapability = createPromiseCapability();\n    this.pagesPromise = pagesCapability.promise;\n\n    pagesCapability.promise.then(() => {\n      this._pageViewsReady = true;\n      this.eventBus.dispatch('pagesloaded', {\n        source: this,\n        pagesCount,\n      });\n    });\n\n    const onePageRenderedCapability = createPromiseCapability();\n    this.onePageRendered = onePageRenderedCapability.promise;\n\n    const firstPagePromise = pdfDocument.getPage(1);\n    this.firstPagePromise = firstPagePromise;\n\n    this._onBeforeDraw = (evt) => {\n      const pageView = this._pages[evt.pageNumber - 1];\n      if (!pageView) {\n        return;\n      }\n      // Add the page to the buffer at the start of drawing. That way it can be\n      // evicted from the buffer and destroyed even if we pause its rendering.\n      this._buffer.push(pageView);\n    };\n    this.eventBus.on('pagerender', this._onBeforeDraw);\n\n    this._onAfterDraw = (evt) => {\n      if (evt.cssTransform || onePageRenderedCapability.settled) {\n        return;\n      }\n      onePageRenderedCapability.resolve();\n\n      this.eventBus.off('pagerendered', this._onAfterDraw);\n      this._onAfterDraw = null;\n    };\n    this.eventBus.on('pagerendered', this._onAfterDraw);\n\n    // Fetch a single page so we can get a viewport that will be the default\n    // viewport for all pages\n    firstPagePromise.then((pdfPage) => {\n      let scale = this.currentScale;\n      let viewport = pdfPage.getViewport({ scale: scale * CSS_UNITS, });\n      for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n        let textLayerFactory = null;\n        if (this.textLayerMode !== TextLayerMode.DISABLE) {\n          textLayerFactory = this;\n        }\n        let pageView = new PDFPageView({\n          container: this._setDocumentViewerElement,\n          eventBus: this.eventBus,\n          id: pageNum,\n          scale,\n          defaultViewport: viewport.clone(),\n          renderingQueue: this.renderingQueue,\n          textLayerFactory,\n          textLayerMode: this.textLayerMode,\n          annotationLayerFactory: this,\n          imageResourcesPath: this.imageResourcesPath,\n          renderInteractiveForms: this.renderInteractiveForms,\n          renderer: this.renderer,\n          enableWebGL: this.enableWebGL,\n          useOnlyCssZoom: this.useOnlyCssZoom,\n          maxCanvasPixels: this.maxCanvasPixels,\n          l10n: this.l10n,\n        });\n        this._pages.push(pageView);\n      }\n      if (this._spreadMode !== SpreadMode.NONE) {\n        this._updateSpreadMode();\n      }\n\n      // Fetch all the pages since the viewport is needed before printing\n      // starts to create the correct size canvas. Wait until one page is\n      // rendered so we don't tie up too many resources early on.\n      onePageRenderedCapability.promise.then(() => {\n        if (this.findController) {\n          this.findController.setDocument(pdfDocument); // Enable searching.\n        }\n\n        // In addition to 'disableAutoFetch' being set, also attempt to reduce\n        // resource usage when loading *very* long/large documents.\n        if (pdfDocument.loadingParams['disableAutoFetch'] ||\n            pagesCount > 7500) {\n          // XXX: Printing is semi-broken with auto fetch disabled.\n          pagesCapability.resolve();\n          return;\n        }\n        let getPagesLeft = pagesCount;\n        for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n          pdfDocument.getPage(pageNum).then((pdfPage) => {\n            let pageView = this._pages[pageNum - 1];\n            if (!pageView.pdfPage) {\n              pageView.setPdfPage(pdfPage);\n            }\n            this.linkService.cachePageRef(pageNum, pdfPage.ref);\n            if (--getPagesLeft === 0) {\n              pagesCapability.resolve();\n            }\n          }, (reason) => {\n            console.error(`Unable to get page ${pageNum} to initialize viewer`,\n                          reason);\n            if (--getPagesLeft === 0) {\n              pagesCapability.resolve();\n            }\n          });\n        }\n      });\n\n      this.eventBus.dispatch('pagesinit', { source: this, });\n\n      if (this.defaultRenderingQueue) {\n        this.update();\n      }\n    }).catch((reason) => {\n      console.error('Unable to initialize viewer', reason);\n    });\n  }\n\n  /**\n   * @param {Array|null} labels\n   */\n  setPageLabels(labels) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (!labels) {\n      this._pageLabels = null;\n    } else if (!(Array.isArray(labels) &&\n                 this.pdfDocument.numPages === labels.length)) {\n      this._pageLabels = null;\n      console.error(`${this._name}.setPageLabels: Invalid page labels.`);\n    } else {\n      this._pageLabels = labels;\n    }\n    // Update all the `PDFPageView` instances.\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      let pageView = this._pages[i];\n      let label = this._pageLabels && this._pageLabels[i];\n      pageView.setPageLabel(label);\n    }\n  }\n\n  _resetView() {\n    this._pages = [];\n    this._currentPageNumber = 1;\n    this._currentScale = UNKNOWN_SCALE;\n    this._currentScaleValue = null;\n    this._pageLabels = null;\n    this._buffer = new PDFPageViewBuffer(DEFAULT_CACHE_SIZE);\n    this._location = null;\n    this._pagesRotation = 0;\n    this._pagesRequests = [];\n    this._pageViewsReady = false;\n    this._scrollMode = ScrollMode.VERTICAL;\n    this._spreadMode = SpreadMode.NONE;\n\n    if (this._onBeforeDraw) {\n      this.eventBus.off('pagerender', this._onBeforeDraw);\n      this._onBeforeDraw = null;\n    }\n    if (this._onAfterDraw) {\n      this.eventBus.off('pagerendered', this._onAfterDraw);\n      this._onAfterDraw = null;\n    }\n    // Remove the pages from the DOM...\n    this.viewer.textContent = '';\n    // ... and reset the Scroll mode CSS class(es) afterwards.\n    this._updateScrollMode();\n  }\n\n  _scrollUpdate() {\n    if (this.pagesCount === 0) {\n      return;\n    }\n    this.update();\n  }\n\n  _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null, }) {\n    scrollIntoView(pageDiv, pageSpot);\n  }\n\n  _setScaleUpdatePages(newScale, newValue, noScroll = false, preset = false) {\n    this._currentScaleValue = newValue.toString();\n\n    if (isSameScale(this._currentScale, newScale)) {\n      if (preset) {\n        this.eventBus.dispatch('scalechanging', {\n          source: this,\n          scale: newScale,\n          presetValue: newValue,\n        });\n      }\n      return;\n    }\n\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      this._pages[i].update(newScale);\n    }\n    this._currentScale = newScale;\n\n    if (!noScroll) {\n      let page = this._currentPageNumber, dest;\n      if (this._location &&\n          !(this.isInPresentationMode || this.isChangingPresentationMode)) {\n        page = this._location.pageNumber;\n        dest = [null, { name: 'XYZ', }, this._location.left,\n                this._location.top, null];\n      }\n      this.scrollPageIntoView({\n        pageNumber: page,\n        destArray: dest,\n        allowNegativeOffset: true,\n      });\n    }\n\n    this.eventBus.dispatch('scalechanging', {\n      source: this,\n      scale: newScale,\n      presetValue: preset ? newValue : undefined,\n    });\n\n    if (this.defaultRenderingQueue) {\n      this.update();\n    }\n  }\n\n  _setScale(value, noScroll = false) {\n    let scale = parseFloat(value);\n\n    if (scale > 0) {\n      this._setScaleUpdatePages(scale, value, noScroll, /* preset = */ false);\n    } else {\n      let currentPage = this._pages[this._currentPageNumber - 1];\n      if (!currentPage) {\n        return;\n      }\n      const noPadding = (this.isInPresentationMode || this.removePageBorders);\n      let hPadding = noPadding ? 0 : SCROLLBAR_PADDING;\n      let vPadding = noPadding ? 0 : VERTICAL_PADDING;\n\n      if (!noPadding && this._isScrollModeHorizontal) {\n        [hPadding, vPadding] = [vPadding, hPadding]; // Swap the padding values.\n      }\n      let pageWidthScale = (this.container.clientWidth - hPadding) /\n                           currentPage.width * currentPage.scale;\n      let pageHeightScale = (this.container.clientHeight - vPadding) /\n                            currentPage.height * currentPage.scale;\n      switch (value) {\n        case 'page-actual':\n          scale = 1;\n          break;\n        case 'page-width':\n          scale = pageWidthScale;\n          break;\n        case 'page-height':\n          scale = pageHeightScale;\n          break;\n        case 'page-fit':\n          scale = Math.min(pageWidthScale, pageHeightScale);\n          break;\n        case 'auto':\n          // For pages in landscape mode, fit the page height to the viewer\n          // *unless* the page would thus become too wide to fit horizontally.\n          let horizontalScale = isPortraitOrientation(currentPage) ?\n            pageWidthScale : Math.min(pageHeightScale, pageWidthScale);\n          scale = Math.min(MAX_AUTO_SCALE, horizontalScale);\n          break;\n        default:\n          console.error(\n            `${this._name}._setScale: \"${value}\" is an unknown zoom value.`);\n          return;\n      }\n      this._setScaleUpdatePages(scale, value, noScroll, /* preset = */ true);\n    }\n  }\n\n  /**\n   * Refreshes page view: scrolls to the current page and updates the scale.\n   * @private\n   */\n  _resetCurrentPageView() {\n    if (this.isInPresentationMode) {\n      // Fixes the case when PDF has different page sizes.\n      this._setScale(this._currentScaleValue, true);\n    }\n\n    let pageView = this._pages[this._currentPageNumber - 1];\n    this._scrollIntoView({ pageDiv: pageView.div, });\n  }\n\n  /**\n   * @typedef ScrollPageIntoViewParameters\n   * @property {number} pageNumber - The page number.\n   * @property {Array} [destArray] - The original PDF destination array, in the\n   *   format: <page-ref> </XYZ|/FitXXX> <args..>\n   * @property {boolean} [allowNegativeOffset] - Allow negative page offsets.\n   *   The default value is `false`.\n   */\n\n  /**\n   * Scrolls page into view.\n   * @param {ScrollPageIntoViewParameters} params\n   */\n  scrollPageIntoView({ pageNumber, destArray = null,\n                       allowNegativeOffset = false, }) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const pageView = (Number.isInteger(pageNumber) &&\n                      this._pages[pageNumber - 1]);\n    if (!pageView) {\n      console.error(`${this._name}.scrollPageIntoView: ` +\n        `\"${pageNumber}\" is not a valid pageNumber parameter.`);\n      return;\n    }\n\n    if (this.isInPresentationMode || !destArray) {\n      this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n      return;\n    }\n    let x = 0, y = 0;\n    let width = 0, height = 0, widthScale, heightScale;\n    let changeOrientation = (pageView.rotation % 180 === 0 ? false : true);\n    let pageWidth = (changeOrientation ? pageView.height : pageView.width) /\n      pageView.scale / CSS_UNITS;\n    let pageHeight = (changeOrientation ? pageView.width : pageView.height) /\n      pageView.scale / CSS_UNITS;\n    let scale = 0;\n    switch (destArray[1].name) {\n      case 'XYZ':\n        x = destArray[2];\n        y = destArray[3];\n        scale = destArray[4];\n        // If x and/or y coordinates are not supplied, default to\n        // _top_ left of the page (not the obvious bottom left,\n        // since aligning the bottom of the intended page with the\n        // top of the window is rarely helpful).\n        x = x !== null ? x : 0;\n        y = y !== null ? y : pageHeight;\n        break;\n      case 'Fit':\n      case 'FitB':\n        scale = 'page-fit';\n        break;\n      case 'FitH':\n      case 'FitBH':\n        y = destArray[2];\n        scale = 'page-width';\n        // According to the PDF spec, section 12.3.2.2, a `null` value in the\n        // parameter should maintain the position relative to the new page.\n        if (y === null && this._location) {\n          x = this._location.left;\n          y = this._location.top;\n        }\n        break;\n      case 'FitV':\n      case 'FitBV':\n        x = destArray[2];\n        width = pageWidth;\n        height = pageHeight;\n        scale = 'page-height';\n        break;\n      case 'FitR':\n        x = destArray[2];\n        y = destArray[3];\n        width = destArray[4] - x;\n        height = destArray[5] - y;\n        let hPadding = this.removePageBorders ? 0 : SCROLLBAR_PADDING;\n        let vPadding = this.removePageBorders ? 0 : VERTICAL_PADDING;\n\n        widthScale = (this.container.clientWidth - hPadding) /\n          width / CSS_UNITS;\n        heightScale = (this.container.clientHeight - vPadding) /\n          height / CSS_UNITS;\n        scale = Math.min(Math.abs(widthScale), Math.abs(heightScale));\n        break;\n      default:\n        console.error(`${this._name}.scrollPageIntoView: ` +\n          `\"${destArray[1].name}\" is not a valid destination type.`);\n        return;\n    }\n\n    if (scale && scale !== this._currentScale) {\n      this.currentScaleValue = scale;\n    } else if (this._currentScale === UNKNOWN_SCALE) {\n      this.currentScaleValue = DEFAULT_SCALE_VALUE;\n    }\n\n    if (scale === 'page-fit' && !destArray[4]) {\n      this._scrollIntoView({\n        pageDiv: pageView.div,\n        pageNumber,\n      });\n      return;\n    }\n\n    let boundingRect = [\n      pageView.viewport.convertToViewportPoint(x, y),\n      pageView.viewport.convertToViewportPoint(x + width, y + height)\n    ];\n    let left = Math.min(boundingRect[0][0], boundingRect[1][0]);\n    let top = Math.min(boundingRect[0][1], boundingRect[1][1]);\n\n    if (!allowNegativeOffset) {\n      // Some bad PDF generators will create destinations with e.g. top values\n      // that exceeds the page height. Ensure that offsets are not negative,\n      // to prevent a previous page from becoming visible (fixes bug 874482).\n      left = Math.max(left, 0);\n      top = Math.max(top, 0);\n    }\n    this._scrollIntoView({\n      pageDiv: pageView.div,\n      pageSpot: { left, top, },\n      pageNumber,\n    });\n  }\n\n  _updateLocation(firstPage) {\n    let currentScale = this._currentScale;\n    let currentScaleValue = this._currentScaleValue;\n    let normalizedScaleValue =\n      parseFloat(currentScaleValue) === currentScale ?\n      Math.round(currentScale * 10000) / 100 : currentScaleValue;\n\n    let pageNumber = firstPage.id;\n    let pdfOpenParams = '#page=' + pageNumber;\n    pdfOpenParams += '&zoom=' + normalizedScaleValue;\n    let currentPageView = this._pages[pageNumber - 1];\n    let container = this.container;\n    let topLeft = currentPageView.getPagePoint(\n      (container.scrollLeft - firstPage.x),\n      (container.scrollTop - firstPage.y));\n    let intLeft = Math.round(topLeft[0]);\n    let intTop = Math.round(topLeft[1]);\n    pdfOpenParams += ',' + intLeft + ',' + intTop;\n\n    this._location = {\n      pageNumber,\n      scale: normalizedScaleValue,\n      top: intTop,\n      left: intLeft,\n      rotation: this._pagesRotation,\n      pdfOpenParams,\n    };\n  }\n\n  _updateHelper(visiblePages) {\n    throw new Error('Not implemented: _updateHelper');\n  }\n\n  update() {\n    const visible = this._getVisiblePages();\n    const visiblePages = visible.views, numVisiblePages = visiblePages.length;\n\n    if (numVisiblePages === 0) {\n      return;\n    }\n    const newCacheSize = Math.max(DEFAULT_CACHE_SIZE, 2 * numVisiblePages + 1);\n    this._buffer.resize(newCacheSize, visiblePages);\n\n    this.renderingQueue.renderHighestPriority(visible);\n\n    this._updateHelper(visiblePages); // Run any class-specific update code.\n\n    this._updateLocation(visible.first);\n    this.eventBus.dispatch('updateviewarea', {\n      source: this,\n      location: this._location,\n    });\n  }\n\n  containsElement(element) {\n    return this.container.contains(element);\n  }\n\n  focus() {\n    this.container.focus();\n  }\n\n  get _isScrollModeHorizontal() {\n    // Used to ensure that pre-rendering of the next/previous page works\n    // correctly, since Scroll/Spread modes are ignored in Presentation Mode.\n    return (this.isInPresentationMode ?\n            false : this._scrollMode === ScrollMode.HORIZONTAL);\n  }\n\n  get isInPresentationMode() {\n    return this.presentationModeState === PresentationModeState.FULLSCREEN;\n  }\n\n  get isChangingPresentationMode() {\n    return this.presentationModeState === PresentationModeState.CHANGING;\n  }\n\n  get isHorizontalScrollbarEnabled() {\n    return (this.isInPresentationMode ?\n      false : (this.container.scrollWidth > this.container.clientWidth));\n  }\n\n  get isVerticalScrollbarEnabled() {\n    return (this.isInPresentationMode ?\n      false : (this.container.scrollHeight > this.container.clientHeight));\n  }\n\n  /**\n   * Helper method for `this._getVisiblePages`. Should only ever be used when\n   * the viewer can only display a single page at a time, for example in:\n   *  - `PDFSinglePageViewer`.\n   *  - `PDFViewer` with Presentation Mode active.\n   */\n  _getCurrentVisiblePage() {\n    if (!this.pagesCount) {\n      return { views: [], };\n    }\n    const pageView = this._pages[this._currentPageNumber - 1];\n    // NOTE: Compute the `x` and `y` properties of the current view,\n    // since `this._updateLocation` depends of them being available.\n    const element = pageView.div;\n\n    const view = {\n      id: pageView.id,\n      x: element.offsetLeft + element.clientLeft,\n      y: element.offsetTop + element.clientTop,\n      view: pageView,\n    };\n    return { first: view, last: view, views: [view], };\n  }\n\n  _getVisiblePages() {\n    return getVisibleElements(this.container, this._pages, true,\n                              this._isScrollModeHorizontal);\n  }\n\n  /**\n   * @param {number} pageNumber\n   */\n  isPageVisible(pageNumber) {\n    if (!this.pdfDocument) {\n      return false;\n    }\n    if (this.pageNumber < 1 || pageNumber > this.pagesCount) {\n      console.error(\n        `${this._name}.isPageVisible: \"${pageNumber}\" is out of bounds.`);\n      return false;\n    }\n    return this._getVisiblePages().views.some(function(view) {\n      return (view.id === pageNumber);\n    });\n  }\n\n  cleanup() {\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      if (this._pages[i] &&\n          this._pages[i].renderingState !== RenderingStates.FINISHED) {\n        this._pages[i].reset();\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  _cancelRendering() {\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      if (this._pages[i]) {\n        this._pages[i].cancelRendering();\n      }\n    }\n  }\n\n  /**\n   * @param {PDFPageView} pageView\n   * @returns {Promise} Returns a promise containing a {PDFPageProxy} object.\n   * @private\n   */\n  _ensurePdfPageLoaded(pageView) {\n    if (pageView.pdfPage) {\n      return Promise.resolve(pageView.pdfPage);\n    }\n    let pageNumber = pageView.id;\n    if (this._pagesRequests[pageNumber]) {\n      return this._pagesRequests[pageNumber];\n    }\n    let promise = this.pdfDocument.getPage(pageNumber).then((pdfPage) => {\n      if (!pageView.pdfPage) {\n        pageView.setPdfPage(pdfPage);\n      }\n      this._pagesRequests[pageNumber] = null;\n      return pdfPage;\n    }).catch((reason) => {\n      console.error('Unable to get page for page view', reason);\n      // Page error -- there is nothing can be done.\n      this._pagesRequests[pageNumber] = null;\n    });\n    this._pagesRequests[pageNumber] = promise;\n    return promise;\n  }\n\n  forceRendering(currentlyVisiblePages) {\n    let visiblePages = currentlyVisiblePages || this._getVisiblePages();\n    let scrollAhead = (this._isScrollModeHorizontal ?\n                       this.scroll.right : this.scroll.down);\n    let pageView = this.renderingQueue.getHighestPriority(visiblePages,\n                                                          this._pages,\n                                                          scrollAhead);\n    if (pageView) {\n      this._ensurePdfPageLoaded(pageView).then(() => {\n        this.renderingQueue.renderView(pageView);\n      });\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @param {HTMLDivElement} textLayerDiv\n   * @param {number} pageIndex\n   * @param {PageViewport} viewport\n   * @returns {TextLayerBuilder}\n   */\n  createTextLayerBuilder(textLayerDiv, pageIndex, viewport,\n                         enhanceTextSelection = false) {\n    return new TextLayerBuilder({\n      textLayerDiv,\n      eventBus: this.eventBus,\n      pageIndex,\n      viewport,\n      findController: this.isInPresentationMode ? null : this.findController,\n      enhanceTextSelection: this.isInPresentationMode ? false :\n                                                        enhanceTextSelection,\n    });\n  }\n\n  /**\n   * @param {HTMLDivElement} pageDiv\n   * @param {PDFPage} pdfPage\n   * @param {string} [imageResourcesPath] - Path for image resources, mainly\n   *   for annotation icons. Include trailing slash.\n   * @param {boolean} renderInteractiveForms\n   * @param {IL10n} l10n\n   * @returns {AnnotationLayerBuilder}\n   */\n  createAnnotationLayerBuilder(pageDiv, pdfPage, imageResourcesPath = '',\n                               renderInteractiveForms = false,\n                               l10n = NullL10n) {\n    return new AnnotationLayerBuilder({\n      pageDiv,\n      pdfPage,\n      imageResourcesPath,\n      renderInteractiveForms,\n      linkService: this.linkService,\n      downloadManager: this.downloadManager,\n      l10n,\n    });\n  }\n\n  /**\n   * @type {boolean} Whether all pages of the PDF document have identical\n   *   widths and heights.\n   */\n  get hasEqualPageSizes() {\n    let firstPageView = this._pages[0];\n    for (let i = 1, ii = this._pages.length; i < ii; ++i) {\n      let pageView = this._pages[i];\n      if (pageView.width !== firstPageView.width ||\n          pageView.height !== firstPageView.height) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns sizes of the pages.\n   * @returns {Array} Array of objects with width/height/rotation fields.\n   */\n  getPagesOverview() {\n    let pagesOverview = this._pages.map(function(pageView) {\n      let viewport = pageView.pdfPage.getViewport({ scale: 1, });\n      return {\n        width: viewport.width,\n        height: viewport.height,\n        rotation: viewport.rotation,\n      };\n    });\n    if (!this.enablePrintAutoRotate) {\n      return pagesOverview;\n    }\n    let isFirstPagePortrait = isPortraitOrientation(pagesOverview[0]);\n    return pagesOverview.map(function (size) {\n      if (isFirstPagePortrait === isPortraitOrientation(size)) {\n        return size;\n      }\n      return {\n        width: size.height,\n        height: size.width,\n        rotation: (size.rotation + 90) % 360,\n      };\n    });\n  }\n\n  /**\n   * @type {number} One of the values in {ScrollMode}.\n   */\n  get scrollMode() {\n    return this._scrollMode;\n  }\n\n  /**\n   * @param {number} mode - The direction in which the document pages should be\n   *   laid out within the scrolling container.\n   *   The constants from {ScrollMode} should be used.\n   */\n  set scrollMode(mode) {\n    if (this._scrollMode === mode) {\n      return; // The Scroll mode didn't change.\n    }\n    if (!isValidScrollMode(mode)) {\n      throw new Error(`Invalid scroll mode: ${mode}`);\n    }\n    this._scrollMode = mode;\n    this.eventBus.dispatch('scrollmodechanged', { source: this, mode, });\n\n    this._updateScrollMode(/* pageNumber = */ this._currentPageNumber);\n  }\n\n  _updateScrollMode(pageNumber = null) {\n    const scrollMode = this._scrollMode, viewer = this.viewer;\n\n    viewer.classList.toggle('scrollHorizontal',\n                            scrollMode === ScrollMode.HORIZONTAL);\n    viewer.classList.toggle('scrollWrapped',\n                            scrollMode === ScrollMode.WRAPPED);\n\n    if (!this.pdfDocument || !pageNumber) {\n      return;\n    }\n    // Non-numeric scale values can be sensitive to the scroll orientation.\n    // Call this before re-scrolling to the current page, to ensure that any\n    // changes in scale don't move the current page.\n    if (this._currentScaleValue && isNaN(this._currentScaleValue)) {\n      this._setScale(this._currentScaleValue, true);\n    }\n    this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n    this.update();\n  }\n\n  /**\n   * @type {number} One of the values in {SpreadMode}.\n   */\n  get spreadMode() {\n    return this._spreadMode;\n  }\n\n  /**\n   * @param {number} mode - Group the pages in spreads, starting with odd- or\n   *   even-number pages (unless `SpreadMode.NONE` is used).\n   *   The constants from {SpreadMode} should be used.\n   */\n  set spreadMode(mode) {\n    if (this._spreadMode === mode) {\n      return; // The Spread mode didn't change.\n    }\n    if (!isValidSpreadMode(mode)) {\n      throw new Error(`Invalid spread mode: ${mode}`);\n    }\n    this._spreadMode = mode;\n    this.eventBus.dispatch('spreadmodechanged', { source: this, mode, });\n\n    this._updateSpreadMode(/* pageNumber = */ this._currentPageNumber);\n  }\n\n  _updateSpreadMode(pageNumber = null) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const viewer = this.viewer, pages = this._pages;\n    // Temporarily remove all the pages from the DOM.\n    viewer.textContent = '';\n\n    if (this._spreadMode === SpreadMode.NONE) {\n      for (let i = 0, iMax = pages.length; i < iMax; ++i) {\n        viewer.appendChild(pages[i].div);\n      }\n    } else {\n      const parity = this._spreadMode - 1;\n      let spread = null;\n      for (let i = 0, iMax = pages.length; i < iMax; ++i) {\n        if (spread === null) {\n          spread = document.createElement('div');\n          spread.className = 'spread';\n          viewer.appendChild(spread);\n        } else if (i % 2 === parity) {\n          spread = spread.cloneNode(false);\n          viewer.appendChild(spread);\n        }\n        spread.appendChild(pages[i].div);\n      }\n    }\n\n    if (!pageNumber) {\n      return;\n    }\n    this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n    this.update();\n  }\n}\n\nexport {\n  BaseViewer,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals chrome */\n\n'use strict';\n\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME')) {\n  var defaultUrl; // eslint-disable-line no-var\n\n  (function rewriteUrlClosure() {\n    // Run this code outside DOMContentLoaded to make sure that the URL\n    // is rewritten as soon as possible.\n    let queryString = document.location.search.slice(1);\n    let m = /(^|&)file=([^&]*)/.exec(queryString);\n    defaultUrl = m ? decodeURIComponent(m[2]) : '';\n\n    // Example: chrome-extension://.../http://example.com/file.pdf\n    let humanReadableUrl = '/' + defaultUrl + location.hash;\n    history.replaceState(history.state, '', humanReadableUrl);\n    if (top === window) {\n      chrome.runtime.sendMessage('showPageAction');\n    }\n  })();\n}\n\nlet pdfjsWebApp, pdfjsWebAppOptions;\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('PRODUCTION')) {\n  pdfjsWebApp = require('./app.js');\n  pdfjsWebAppOptions = require('./app_options.js');\n}\n\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n  require('./firefoxcom.js');\n  require('./firefox_print_service.js');\n}\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('GENERIC')) {\n  require('./genericcom.js');\n}\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME')) {\n  require('./chromecom.js');\n}\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME || GENERIC')) {\n  require('./pdf_print_service.js');\n}\n\nfunction getViewerConfiguration() {\n  return {\n    appContainer: document.body,\n    mainContainer: document.getElementById('viewerContainer'),\n    viewerContainer: document.getElementById('viewer'),\n    eventBus: null, // Using global event bus with (optional) DOM events.\n    toolbar: {\n      container: document.getElementById('toolbarViewer'),\n      numPages: document.getElementById('numPages'),\n      pageNumber: document.getElementById('pageNumber'),\n      scaleSelectContainer: document.getElementById('scaleSelectContainer'),\n      scaleSelect: document.getElementById('scaleSelect'),\n      customScaleOption: document.getElementById('customScaleOption'),\n      previous: document.getElementById('previous'),\n      next: document.getElementById('next'),\n      zoomIn: document.getElementById('zoomIn'),\n      zoomOut: document.getElementById('zoomOut'),\n      viewFind: document.getElementById('viewFind'),\n      openFile: document.getElementById('openFile'),\n      print: document.getElementById('print'),\n      presentationModeButton: document.getElementById('presentationMode'),\n      download: document.getElementById('download'),\n      viewBookmark: document.getElementById('viewBookmark'),\n    },\n    secondaryToolbar: {\n      toolbar: document.getElementById('secondaryToolbar'),\n      toggleButton: document.getElementById('secondaryToolbarToggle'),\n      toolbarButtonContainer:\n        document.getElementById('secondaryToolbarButtonContainer'),\n      presentationModeButton:\n        document.getElementById('secondaryPresentationMode'),\n      openFileButton: document.getElementById('secondaryOpenFile'),\n      printButton: document.getElementById('secondaryPrint'),\n      downloadButton: document.getElementById('secondaryDownload'),\n      viewBookmarkButton: document.getElementById('secondaryViewBookmark'),\n      firstPageButton: document.getElementById('firstPage'),\n      lastPageButton: document.getElementById('lastPage'),\n      pageRotateCwButton: document.getElementById('pageRotateCw'),\n      pageRotateCcwButton: document.getElementById('pageRotateCcw'),\n      cursorSelectToolButton: document.getElementById('cursorSelectTool'),\n      cursorHandToolButton: document.getElementById('cursorHandTool'),\n      scrollVerticalButton: document.getElementById('scrollVertical'),\n      scrollHorizontalButton: document.getElementById('scrollHorizontal'),\n      scrollWrappedButton: document.getElementById('scrollWrapped'),\n      spreadNoneButton: document.getElementById('spreadNone'),\n      spreadOddButton: document.getElementById('spreadOdd'),\n      spreadEvenButton: document.getElementById('spreadEven'),\n      documentPropertiesButton: document.getElementById('documentProperties'),\n    },\n    fullscreen: {\n      contextFirstPage: document.getElementById('contextFirstPage'),\n      contextLastPage: document.getElementById('contextLastPage'),\n      contextPageRotateCw: document.getElementById('contextPageRotateCw'),\n      contextPageRotateCcw: document.getElementById('contextPageRotateCcw'),\n    },\n    sidebar: {\n      // Divs (and sidebar button)\n      outerContainer: document.getElementById('outerContainer'),\n      viewerContainer: document.getElementById('viewerContainer'),\n      toggleButton: document.getElementById('sidebarToggle'),\n      // Buttons\n      thumbnailButton: document.getElementById('viewThumbnail'),\n      outlineButton: document.getElementById('viewOutline'),\n      attachmentsButton: document.getElementById('viewAttachments'),\n      // Views\n      thumbnailView: document.getElementById('thumbnailView'),\n      outlineView: document.getElementById('outlineView'),\n      attachmentsView: document.getElementById('attachmentsView'),\n    },\n    sidebarResizer: {\n      outerContainer: document.getElementById('outerContainer'),\n      resizer: document.getElementById('sidebarResizer'),\n    },\n    findBar: {\n      bar: document.getElementById('findbar'),\n      toggleButton: document.getElementById('viewFind'),\n      findField: document.getElementById('findInput'),\n      highlightAllCheckbox: document.getElementById('findHighlightAll'),\n      caseSensitiveCheckbox: document.getElementById('findMatchCase'),\n      entireWordCheckbox: document.getElementById('findEntireWord'),\n      findMsg: document.getElementById('findMsg'),\n      findResultsCount: document.getElementById('findResultsCount'),\n      findPreviousButton: document.getElementById('findPrevious'),\n      findNextButton: document.getElementById('findNext'),\n    },\n    passwordOverlay: {\n      overlayName: 'passwordOverlay',\n      container: document.getElementById('passwordOverlay'),\n      label: document.getElementById('passwordText'),\n      input: document.getElementById('password'),\n      submitButton: document.getElementById('passwordSubmit'),\n      cancelButton: document.getElementById('passwordCancel'),\n    },\n    documentProperties: {\n      overlayName: 'documentPropertiesOverlay',\n      container: document.getElementById('documentPropertiesOverlay'),\n      closeButton: document.getElementById('documentPropertiesClose'),\n      fields: {\n        'fileName': document.getElementById('fileNameField'),\n        'fileSize': document.getElementById('fileSizeField'),\n        'title': document.getElementById('titleField'),\n        'author': document.getElementById('authorField'),\n        'subject': document.getElementById('subjectField'),\n        'keywords': document.getElementById('keywordsField'),\n        'creationDate': document.getElementById('creationDateField'),\n        'modificationDate': document.getElementById('modificationDateField'),\n        'creator': document.getElementById('creatorField'),\n        'producer': document.getElementById('producerField'),\n        'version': document.getElementById('versionField'),\n        'pageCount': document.getElementById('pageCountField'),\n        'pageSize': document.getElementById('pageSizeField'),\n        'linearized': document.getElementById('linearizedField'),\n      },\n    },\n    errorWrapper: {\n      container: document.getElementById('errorWrapper'),\n      errorMessage: document.getElementById('errorMessage'),\n      closeButton: document.getElementById('errorClose'),\n      errorMoreInfo: document.getElementById('errorMoreInfo'),\n      moreInfoButton: document.getElementById('errorShowMore'),\n      lessInfoButton: document.getElementById('errorShowLess'),\n    },\n    printContainer: document.getElementById('printContainer'),\n    openFileInputName: 'fileInput',\n    debuggerScriptPath: './debugger.js',\n  };\n}\n\nfunction webViewerLoad() {\n  let config = getViewerConfiguration();\n  if (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION')) {\n    Promise.all([\n      SystemJS.import('pdfjs-web/app'),\n      SystemJS.import('pdfjs-web/app_options'),\n      SystemJS.import('pdfjs-web/genericcom'),\n      SystemJS.import('pdfjs-web/pdf_print_service'),\n    ]).then(function([app, appOptions, ...otherModules]) {\n      window.PDFViewerApplication = app.PDFViewerApplication;\n      window.PDFViewerApplicationOptions = appOptions.AppOptions;\n      app.PDFViewerApplication.run(config);\n    });\n  } else {\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME')) {\n      pdfjsWebAppOptions.AppOptions.set('defaultUrl', defaultUrl);\n    }\n\n    window.PDFViewerApplication = pdfjsWebApp.PDFViewerApplication;\n    window.PDFViewerApplicationOptions = pdfjsWebAppOptions.AppOptions;\n\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('GENERIC')) {\n      // Give custom implementations of the default viewer a simpler way to\n      // set various `AppOptions`, by dispatching an event once all viewer\n      // files are loaded but *before* the viewer initialization has run.\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('webviewerloaded', true, true, {});\n      document.dispatchEvent(event);\n    }\n\n    pdfjsWebApp.PDFViewerApplication.run(config);\n  }\n}\n\nif (document.readyState === 'interactive' ||\n    document.readyState === 'complete') {\n  webViewerLoad();\n} else {\n  document.addEventListener('DOMContentLoaded', webViewerLoad, true);\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","/* Copyright 2013 Rob Wu <rob@robwu.nl>\n * https://github.com/Rob--W/grab-to-pan.js\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable no-var */\n\n/**\n * Construct a GrabToPan instance for a given HTML element.\n * @param options.element {Element}\n * @param options.ignoreTarget {function} optional. See `ignoreTarget(node)`\n * @param options.onActiveChanged {function(boolean)} optional. Called\n *  when grab-to-pan is (de)activated. The first argument is a boolean that\n *  shows whether grab-to-pan is activated.\n */\nfunction GrabToPan(options) {\n  this.element = options.element;\n  this.document = options.element.ownerDocument;\n  if (typeof options.ignoreTarget === 'function') {\n    this.ignoreTarget = options.ignoreTarget;\n  }\n  this.onActiveChanged = options.onActiveChanged;\n\n  // Bind the contexts to ensure that `this` always points to\n  // the GrabToPan instance.\n  this.activate = this.activate.bind(this);\n  this.deactivate = this.deactivate.bind(this);\n  this.toggle = this.toggle.bind(this);\n  this._onmousedown = this._onmousedown.bind(this);\n  this._onmousemove = this._onmousemove.bind(this);\n  this._endPan = this._endPan.bind(this);\n\n  // This overlay will be inserted in the document when the mouse moves during\n  // a grab operation, to ensure that the cursor has the desired appearance.\n  var overlay = this.overlay = document.createElement('div');\n  overlay.className = 'grab-to-pan-grabbing';\n}\nGrabToPan.prototype = {\n  /**\n   * Class name of element which can be grabbed\n   */\n  CSS_CLASS_GRAB: 'grab-to-pan-grab',\n\n  /**\n   * Bind a mousedown event to the element to enable grab-detection.\n   */\n  activate: function GrabToPan_activate() {\n    if (!this.active) {\n      this.active = true;\n      this.element.addEventListener('mousedown', this._onmousedown, true);\n      this.element.classList.add(this.CSS_CLASS_GRAB);\n      if (this.onActiveChanged) {\n        this.onActiveChanged(true);\n      }\n    }\n  },\n\n  /**\n   * Removes all events. Any pending pan session is immediately stopped.\n   */\n  deactivate: function GrabToPan_deactivate() {\n    if (this.active) {\n      this.active = false;\n      this.element.removeEventListener('mousedown', this._onmousedown, true);\n      this._endPan();\n      this.element.classList.remove(this.CSS_CLASS_GRAB);\n      if (this.onActiveChanged) {\n        this.onActiveChanged(false);\n      }\n    }\n  },\n\n  toggle: function GrabToPan_toggle() {\n    if (this.active) {\n      this.deactivate();\n    } else {\n      this.activate();\n    }\n  },\n\n  /**\n   * Whether to not pan if the target element is clicked.\n   * Override this method to change the default behaviour.\n   *\n   * @param node {Element} The target of the event\n   * @returns {boolean} Whether to not react to the click event.\n   */\n  ignoreTarget: function GrabToPan_ignoreTarget(node) {\n    // Use matchesSelector to check whether the clicked element\n    // is (a child of) an input element / link\n    return node[matchesSelector](\n      'a[href], a[href] *, input, textarea, button, button *, select, option'\n    );\n  },\n\n  /**\n   * @private\n   */\n  _onmousedown: function GrabToPan__onmousedown(event) {\n    if (event.button !== 0 || this.ignoreTarget(event.target)) {\n      return;\n    }\n    if (event.originalTarget) {\n      try {\n        // eslint-disable-next-line no-unused-expressions\n        event.originalTarget.tagName;\n      } catch (e) {\n        // Mozilla-specific: element is a scrollbar (XUL element)\n        return;\n      }\n    }\n\n    this.scrollLeftStart = this.element.scrollLeft;\n    this.scrollTopStart = this.element.scrollTop;\n    this.clientXStart = event.clientX;\n    this.clientYStart = event.clientY;\n    this.document.addEventListener('mousemove', this._onmousemove, true);\n    this.document.addEventListener('mouseup', this._endPan, true);\n    // When a scroll event occurs before a mousemove, assume that the user\n    // dragged a scrollbar (necessary for Opera Presto, Safari and IE)\n    // (not needed for Chrome/Firefox)\n    this.element.addEventListener('scroll', this._endPan, true);\n    event.preventDefault();\n    event.stopPropagation();\n\n    var focusedElement = document.activeElement;\n    if (focusedElement && !focusedElement.contains(event.target)) {\n      focusedElement.blur();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _onmousemove: function GrabToPan__onmousemove(event) {\n    this.element.removeEventListener('scroll', this._endPan, true);\n    if (isLeftMouseReleased(event)) {\n      this._endPan();\n      return;\n    }\n    var xDiff = event.clientX - this.clientXStart;\n    var yDiff = event.clientY - this.clientYStart;\n    var scrollTop = this.scrollTopStart - yDiff;\n    var scrollLeft = this.scrollLeftStart - xDiff;\n    if (this.element.scrollTo) {\n      this.element.scrollTo({\n        top: scrollTop,\n        left: scrollLeft,\n        behavior: 'instant',\n      });\n    } else {\n      this.element.scrollTop = scrollTop;\n      this.element.scrollLeft = scrollLeft;\n    }\n    if (!this.overlay.parentNode) {\n      document.body.appendChild(this.overlay);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _endPan: function GrabToPan__endPan() {\n    this.element.removeEventListener('scroll', this._endPan, true);\n    this.document.removeEventListener('mousemove', this._onmousemove, true);\n    this.document.removeEventListener('mouseup', this._endPan, true);\n    // Note: ChildNode.remove doesn't throw if the parentNode is undefined.\n    this.overlay.remove();\n  },\n};\n\n// Get the correct (vendor-prefixed) name of the matches method.\nvar matchesSelector;\n['webkitM', 'mozM', 'msM', 'oM', 'm'].some(function(prefix) {\n  var name = prefix + 'atches';\n  if (name in document.documentElement) {\n    matchesSelector = name;\n  }\n  name += 'Selector';\n  if (name in document.documentElement) {\n    matchesSelector = name;\n  }\n  return matchesSelector; // If found, then truthy, and [].some() ends.\n});\n\n// Browser sniffing because it's impossible to feature-detect\n// whether event.which for onmousemove is reliable\nvar isNotIEorIsIE10plus = !document.documentMode || document.documentMode > 9;\nvar chrome = window.chrome;\nvar isChrome15OrOpera15plus = chrome && (chrome.webstore || chrome.app);\n//                                       ^ Chrome 15+       ^ Opera 15+\nvar isSafari6plus = /Apple/.test(navigator.vendor) &&\n                    /Version\\/([6-9]\\d*|[1-5]\\d+)/.test(navigator.userAgent);\n\n/**\n * Whether the left mouse is not pressed.\n * @param event {MouseEvent}\n * @returns {boolean} True if the left mouse button is not pressed,\n *                    False if unsure or if the left mouse button is pressed.\n */\nfunction isLeftMouseReleased(event) {\n  if ('buttons' in event && isNotIEorIsIE10plus) {\n    // http://www.w3.org/TR/DOM-Level-3-Events/#events-MouseEvent-buttons\n    // Firefox 15+\n    // Internet Explorer 10+\n    return !(event.buttons & 1);\n  }\n  if (isChrome15OrOpera15plus || isSafari6plus) {\n    // Chrome 14+\n    // Opera 15+\n    // Safari 6.0+\n    return event.which === 0;\n  }\n  return false;\n}\n\nexport {\n  GrabToPan,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NullL10n } from './ui_utils';\nimport { RenderingStates } from './pdf_rendering_queue';\n\nconst UI_NOTIFICATION_CLASS = 'pdfSidebarNotification';\n\nconst SidebarView = {\n  UNKNOWN: -1,\n  NONE: 0,\n  THUMBS: 1, // Default value.\n  OUTLINE: 2,\n  ATTACHMENTS: 3,\n  LAYERS: 4,\n};\n\n/**\n * @typedef {Object} PDFSidebarOptions\n * @property {PDFSidebarElements} elements - The DOM elements.\n * @property {PDFViewer} pdfViewer - The document viewer.\n * @property {PDFThumbnailViewer} pdfThumbnailViewer - The thumbnail viewer.\n * @property {EventBus} eventBus - The application event bus.\n * @property {IL10n} l10n - The localization service.\n * @property {boolean} [disableNotification] - Disable the notification for\n *   documents containing outline/attachments. The default value is `false`.\n */\n\n/**\n * @typedef {Object} PDFSidebarElements\n * @property {HTMLDivElement} outerContainer - The outer container\n *   (encasing both the viewer and sidebar elements).\n * @property {HTMLDivElement} viewerContainer - The viewer container\n *   (in which the viewer element is placed).\n * @property {HTMLButtonElement} toggleButton - The button used for\n *   opening/closing the sidebar.\n * @property {HTMLButtonElement} thumbnailButton - The button used to show\n *   the thumbnail view.\n * @property {HTMLButtonElement} outlineButton - The button used to show\n *   the outline view.\n * @property {HTMLButtonElement} attachmentsButton - The button used to show\n *   the attachments view.\n * @property {HTMLDivElement} thumbnailView - The container in which\n *   the thumbnails are placed.\n * @property {HTMLDivElement} outlineView - The container in which\n *   the outline is placed.\n * @property {HTMLDivElement} attachmentsView - The container in which\n *   the attachments are placed.\n */\n\nclass PDFSidebar {\n  /**\n   * @param {PDFSidebarOptions} options\n   */\n  constructor({ elements, pdfViewer, pdfThumbnailViewer, eventBus,\n                l10n = NullL10n, disableNotification = false, }) {\n    this.isOpen = false;\n    this.active = SidebarView.THUMBS;\n    this.isInitialViewSet = false;\n\n    /**\n     * Callback used when the sidebar has been opened/closed, to ensure that\n     * the viewers (PDFViewer/PDFThumbnailViewer) are updated correctly.\n     */\n    this.onToggled = null;\n\n    this.pdfViewer = pdfViewer;\n    this.pdfThumbnailViewer = pdfThumbnailViewer;\n\n    this.outerContainer = elements.outerContainer;\n    this.viewerContainer = elements.viewerContainer;\n    this.toggleButton = elements.toggleButton;\n\n    this.thumbnailButton = elements.thumbnailButton;\n    this.outlineButton = elements.outlineButton;\n    this.attachmentsButton = elements.attachmentsButton;\n\n    this.thumbnailView = elements.thumbnailView;\n    this.outlineView = elements.outlineView;\n    this.attachmentsView = elements.attachmentsView;\n\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n    this._disableNotification = disableNotification;\n\n    this._addEventListeners();\n  }\n\n  reset() {\n    this.isInitialViewSet = false;\n\n    this._hideUINotification(null);\n    this.switchView(SidebarView.THUMBS);\n\n    this.outlineButton.disabled = false;\n    this.attachmentsButton.disabled = false;\n  }\n\n  /**\n   * @type {number} One of the values in {SidebarView}.\n   */\n  get visibleView() {\n    return (this.isOpen ? this.active : SidebarView.NONE);\n  }\n\n  get isThumbnailViewVisible() {\n    return (this.isOpen && this.active === SidebarView.THUMBS);\n  }\n\n  get isOutlineViewVisible() {\n    return (this.isOpen && this.active === SidebarView.OUTLINE);\n  }\n\n  get isAttachmentsViewVisible() {\n    return (this.isOpen && this.active === SidebarView.ATTACHMENTS);\n  }\n\n  /**\n   * @param {number} view - The sidebar view that should become visible,\n   *                        must be one of the values in {SidebarView}.\n   */\n  setInitialView(view = SidebarView.NONE) {\n    if (this.isInitialViewSet) {\n      return;\n    }\n    this.isInitialViewSet = true;\n\n    // If the user has already manually opened the sidebar, immediately closing\n    // it would be bad UX; also ignore the \"unknown\" sidebar view value.\n    if (view === SidebarView.NONE || view === SidebarView.UNKNOWN) {\n      this._dispatchEvent();\n      return;\n    }\n    // Prevent dispatching two back-to-back `sidebarviewchanged` events,\n    // since `this._switchView` dispatched the event if the view changed.\n    if (!this._switchView(view, /* forceOpen */ true)) {\n      this._dispatchEvent();\n    }\n  }\n\n  /**\n   * @param {number} view - The sidebar view that should be switched to,\n   *                        must be one of the values in {SidebarView}.\n   * @param {boolean} [forceOpen] - Ensure that the sidebar is open.\n   *                                The default value is `false`.\n   */\n  switchView(view, forceOpen = false) {\n    this._switchView(view, forceOpen);\n  }\n\n  /**\n   * @returns {boolean} Indicating if `this._dispatchEvent` was called.\n   * @private\n   */\n  _switchView(view, forceOpen = false) {\n    const isViewChanged = (view !== this.active);\n    let shouldForceRendering = false;\n\n    switch (view) {\n      case SidebarView.NONE:\n        if (this.isOpen) {\n          this.close();\n          return true; // Closing will trigger rendering and dispatch the event.\n        }\n        return false;\n      case SidebarView.THUMBS:\n        if (this.isOpen && isViewChanged) {\n          shouldForceRendering = true;\n        }\n        break;\n      case SidebarView.OUTLINE:\n        if (this.outlineButton.disabled) {\n          return false;\n        }\n        break;\n      case SidebarView.ATTACHMENTS:\n        if (this.attachmentsButton.disabled) {\n          return false;\n        }\n        break;\n      default:\n        console.error(`PDFSidebar._switchView: \"${view}\" is not a valid view.`);\n        return false;\n    }\n    // Update the active view *after* it has been validated above,\n    // in order to prevent setting it to an invalid state.\n    this.active = view;\n\n    // Update the CSS classes, for all buttons...\n    this.thumbnailButton.classList.toggle('toggled',\n      view === SidebarView.THUMBS);\n    this.outlineButton.classList.toggle('toggled',\n      view === SidebarView.OUTLINE);\n    this.attachmentsButton.classList.toggle('toggled',\n      view === SidebarView.ATTACHMENTS);\n    // ... and for all views.\n    this.thumbnailView.classList.toggle('hidden', view !== SidebarView.THUMBS);\n    this.outlineView.classList.toggle('hidden', view !== SidebarView.OUTLINE);\n    this.attachmentsView.classList.toggle('hidden',\n      view !== SidebarView.ATTACHMENTS);\n\n    if (forceOpen && !this.isOpen) {\n      this.open();\n      return true; // Opening will trigger rendering and dispatch the event.\n    }\n    if (shouldForceRendering) {\n      this._updateThumbnailViewer();\n      this._forceRendering();\n    }\n    if (isViewChanged) {\n      this._dispatchEvent();\n    }\n    this._hideUINotification(this.active);\n    return isViewChanged;\n  }\n\n  open() {\n    if (this.isOpen) {\n      return;\n    }\n    this.isOpen = true;\n    this.toggleButton.classList.add('toggled');\n\n    this.outerContainer.classList.add('sidebarMoving', 'sidebarOpen');\n\n    if (this.active === SidebarView.THUMBS) {\n      this._updateThumbnailViewer();\n    }\n    this._forceRendering();\n    this._dispatchEvent();\n\n    this._hideUINotification(this.active);\n  }\n\n  close() {\n    if (!this.isOpen) {\n      return;\n    }\n    this.isOpen = false;\n    this.toggleButton.classList.remove('toggled');\n\n    this.outerContainer.classList.add('sidebarMoving');\n    this.outerContainer.classList.remove('sidebarOpen');\n\n    this._forceRendering();\n    this._dispatchEvent();\n  }\n\n  toggle() {\n    if (this.isOpen) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent() {\n    this.eventBus.dispatch('sidebarviewchanged', {\n      source: this,\n      view: this.visibleView,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _forceRendering() {\n    if (this.onToggled) {\n      this.onToggled();\n    } else { // Fallback\n      this.pdfViewer.forceRendering();\n      this.pdfThumbnailViewer.forceRendering();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _updateThumbnailViewer() {\n    let { pdfViewer, pdfThumbnailViewer, } = this;\n\n    // Use the rendered pages to set the corresponding thumbnail images.\n    let pagesCount = pdfViewer.pagesCount;\n    for (let pageIndex = 0; pageIndex < pagesCount; pageIndex++) {\n      let pageView = pdfViewer.getPageView(pageIndex);\n      if (pageView && pageView.renderingState === RenderingStates.FINISHED) {\n        let thumbnailView = pdfThumbnailViewer.getThumbnail(pageIndex);\n        thumbnailView.setImage(pageView);\n      }\n    }\n    pdfThumbnailViewer.scrollThumbnailIntoView(pdfViewer.currentPageNumber);\n  }\n\n  /**\n   * @private\n   */\n  _showUINotification(view) {\n    if (this._disableNotification) {\n      return;\n    }\n\n    this.l10n.get('toggle_sidebar_notification.title', null,\n                  'Toggle Sidebar (document contains outline/attachments)').\n        then((msg) => {\n      this.toggleButton.title = msg;\n    });\n\n    if (!this.isOpen) {\n      // Only show the notification on the `toggleButton` if the sidebar is\n      // currently closed, to avoid unnecessarily bothering the user.\n      this.toggleButton.classList.add(UI_NOTIFICATION_CLASS);\n    } else if (view === this.active) {\n      // If the sidebar is currently open *and* the `view` is visible, do not\n      // bother the user with a notification on the corresponding button.\n      return;\n    }\n\n    switch (view) {\n      case SidebarView.OUTLINE:\n        this.outlineButton.classList.add(UI_NOTIFICATION_CLASS);\n        break;\n      case SidebarView.ATTACHMENTS:\n        this.attachmentsButton.classList.add(UI_NOTIFICATION_CLASS);\n        break;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _hideUINotification(view) {\n    if (this._disableNotification) {\n      return;\n    }\n\n    let removeNotification = (view) => {\n      switch (view) {\n        case SidebarView.OUTLINE:\n          this.outlineButton.classList.remove(UI_NOTIFICATION_CLASS);\n          break;\n        case SidebarView.ATTACHMENTS:\n          this.attachmentsButton.classList.remove(UI_NOTIFICATION_CLASS);\n          break;\n      }\n    };\n\n    if (!this.isOpen && view !== null) {\n      // Only hide the notifications when the sidebar is currently open,\n      // or when it is being reset (i.e. `view === null`).\n      return;\n    }\n    this.toggleButton.classList.remove(UI_NOTIFICATION_CLASS);\n\n    if (view !== null) {\n      removeNotification(view);\n      return;\n    }\n    for (view in SidebarView) { // Remove all sidebar notifications on reset.\n      removeNotification(SidebarView[view]);\n    }\n\n    this.l10n.get('toggle_sidebar.title', null, 'Toggle Sidebar').\n        then((msg) => {\n      this.toggleButton.title = msg;\n    });\n  }\n\n  /**\n   * @private\n   */\n  _addEventListeners() {\n    this.viewerContainer.addEventListener('transitionend', (evt) => {\n      if (evt.target === this.viewerContainer) {\n        this.outerContainer.classList.remove('sidebarMoving');\n      }\n    });\n\n    this.toggleButton.addEventListener('click', () => {\n      this.toggle();\n    });\n\n    // Buttons for switching views.\n    this.thumbnailButton.addEventListener('click', () => {\n      this.switchView(SidebarView.THUMBS);\n    });\n\n    this.outlineButton.addEventListener('click', () => {\n      this.switchView(SidebarView.OUTLINE);\n    });\n    this.outlineButton.addEventListener('dblclick', () => {\n      this.eventBus.dispatch('toggleoutlinetree', { source: this, });\n    });\n\n    this.attachmentsButton.addEventListener('click', () => {\n      this.switchView(SidebarView.ATTACHMENTS);\n    });\n\n    // Disable/enable views.\n    this.eventBus.on('outlineloaded', (evt) => {\n      let outlineCount = evt.outlineCount;\n\n      this.outlineButton.disabled = !outlineCount;\n\n      if (outlineCount) {\n        this._showUINotification(SidebarView.OUTLINE);\n      } else if (this.active === SidebarView.OUTLINE) {\n        // If the outline view was opened during document load, switch away\n        // from it if it turns out that the document has no outline.\n        this.switchView(SidebarView.THUMBS);\n      }\n    });\n\n    this.eventBus.on('attachmentsloaded', (evt) => {\n      if (evt.attachmentsCount) {\n        this.attachmentsButton.disabled = false;\n\n        this._showUINotification(SidebarView.ATTACHMENTS);\n        return;\n      }\n\n      // Attempt to avoid temporarily disabling, and switching away from, the\n      // attachment view for documents that do not contain proper attachments\n      // but *only* FileAttachment annotations. Hence we defer those operations\n      // slightly to allow time for parsing any FileAttachment annotations that\n      // may be present on the *initially* rendered page of the document.\n      Promise.resolve().then(() => {\n        if (this.attachmentsView.hasChildNodes()) {\n          // FileAttachment annotations were appended to the attachment view.\n          return;\n        }\n        this.attachmentsButton.disabled = true;\n\n        if (this.active === SidebarView.ATTACHMENTS) {\n          // If the attachment view was opened during document load, switch away\n          // from it if it turns out that the document has no attachments.\n          this.switchView(SidebarView.THUMBS);\n        }\n      });\n    });\n\n    // Update the thumbnailViewer, if visible, when exiting presentation mode.\n    this.eventBus.on('presentationmodechanged', (evt) => {\n      if (!evt.active && !evt.switchInProgress && this.isThumbnailViewVisible) {\n        this._updateThumbnailViewer();\n      }\n    });\n  }\n}\n\nexport {\n  SidebarView,\n  PDFSidebar,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nclass OverlayManager {\n  constructor() {\n    this._overlays = {};\n    this._active = null;\n    this._keyDownBound = this._keyDown.bind(this);\n  }\n\n  get active() {\n    return this._active;\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that is registered.\n   * @param {HTMLDivElement} element - The overlay's DOM element.\n   * @param {function} [callerCloseMethod] - The method that, if present, calls\n   *                   `OverlayManager.close` from the object registering the\n   *                   overlay. Access to this method is necessary in order to\n   *                   run cleanup code when e.g. the overlay is force closed.\n   *                   The default is `null`.\n   * @param {boolean} [canForceClose] - Indicates if opening the overlay closes\n   *                  an active overlay. The default is `false`.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    registered.\n   */\n  async register(name, element, callerCloseMethod = null,\n                 canForceClose = false) {\n    let container;\n    if (!name || !element || !(container = element.parentNode)) {\n      throw new Error('Not enough parameters.');\n    } else if (this._overlays[name]) {\n      throw new Error('The overlay is already registered.');\n    }\n    this._overlays[name] = {\n      element,\n      container,\n      callerCloseMethod,\n      canForceClose,\n    };\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that is unregistered.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    unregistered.\n   */\n  async unregister(name) {\n    if (!this._overlays[name]) {\n      throw new Error('The overlay does not exist.');\n    } else if (this._active === name) {\n      throw new Error('The overlay cannot be removed while it is active.');\n    }\n    delete this._overlays[name];\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that should be opened.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    opened.\n   */\n  async open(name) {\n    if (!this._overlays[name]) {\n      throw new Error('The overlay does not exist.');\n    } else if (this._active) {\n      if (this._overlays[name].canForceClose) {\n        this._closeThroughCaller();\n      } else if (this._active === name) {\n        throw new Error('The overlay is already active.');\n      } else {\n        throw new Error('Another overlay is currently active.');\n      }\n    }\n    this._active = name;\n    this._overlays[this._active].element.classList.remove('hidden');\n    this._overlays[this._active].container.classList.remove('hidden');\n\n    window.addEventListener('keydown', this._keyDownBound);\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that should be closed.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    closed.\n   */\n  async close(name) {\n    if (!this._overlays[name]) {\n      throw new Error('The overlay does not exist.');\n    } else if (!this._active) {\n      throw new Error('The overlay is currently not active.');\n    } else if (this._active !== name) {\n      throw new Error('Another overlay is currently active.');\n    }\n    this._overlays[this._active].container.classList.add('hidden');\n    this._overlays[this._active].element.classList.add('hidden');\n    this._active = null;\n\n    window.removeEventListener('keydown', this._keyDownBound);\n  }\n\n  /**\n   * @private\n   */\n  _keyDown(evt) {\n    if (this._active && evt.keyCode === 27) { // Esc key.\n      this._closeThroughCaller();\n      evt.preventDefault();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _closeThroughCaller() {\n    if (this._overlays[this._active].callerCloseMethod) {\n      this._overlays[this._active].callerCloseMethod();\n    }\n    if (this._active) {\n      this.close(this._active);\n    }\n  }\n}\n\nexport {\n  OverlayManager,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NullL10n } from './ui_utils';\nimport { PasswordResponses } from 'pdfjs-lib';\n\n/**\n * @typedef {Object} PasswordPromptOptions\n * @property {string} overlayName - Name of the overlay for the overlay manager.\n * @property {HTMLDivElement} container - Div container for the overlay.\n * @property {HTMLParagraphElement} label - Label containing instructions for\n *                                          entering the password.\n * @property {HTMLInputElement} input - Input field for entering the password.\n * @property {HTMLButtonElement} submitButton - Button for submitting the\n *                                              password.\n * @property {HTMLButtonElement} cancelButton - Button for cancelling password\n *                                              entry.\n */\n\nclass PasswordPrompt {\n  /**\n   * @param {PasswordPromptOptions} options\n   * @param {OverlayManager} overlayManager - Manager for the viewer overlays.\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor(options, overlayManager, l10n = NullL10n) {\n    this.overlayName = options.overlayName;\n    this.container = options.container;\n    this.label = options.label;\n    this.input = options.input;\n    this.submitButton = options.submitButton;\n    this.cancelButton = options.cancelButton;\n    this.overlayManager = overlayManager;\n    this.l10n = l10n;\n\n    this.updateCallback = null;\n    this.reason = null;\n\n    // Attach the event listeners.\n    this.submitButton.addEventListener('click', this.verify.bind(this));\n    this.cancelButton.addEventListener('click', this.close.bind(this));\n    this.input.addEventListener('keydown', (e) => {\n      if (e.keyCode === 13) { // Enter key\n        this.verify();\n      }\n    });\n\n    this.overlayManager.register(this.overlayName, this.container,\n                                 this.close.bind(this), true);\n  }\n\n  open() {\n    this.overlayManager.open(this.overlayName).then(() => {\n      this.input.focus();\n\n      let promptString;\n      if (this.reason === PasswordResponses.INCORRECT_PASSWORD) {\n        promptString = this.l10n.get('password_invalid', null,\n          'Invalid password. Please try again.');\n      } else {\n        promptString = this.l10n.get('password_label', null,\n          'Enter the password to open this PDF file.');\n      }\n\n      promptString.then((msg) => {\n        this.label.textContent = msg;\n      });\n    });\n  }\n\n  close() {\n    this.overlayManager.close(this.overlayName).then(() => {\n      this.input.value = '';\n    });\n  }\n\n  verify() {\n    let password = this.input.value;\n    if (password && password.length > 0) {\n      this.close();\n      this.updateCallback(password);\n    }\n  }\n\n  setUpdateCallback(updateCallback, reason) {\n    this.updateCallback = updateCallback;\n    this.reason = reason;\n  }\n}\n\nexport {\n  PasswordPrompt,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createObjectURL, createPromiseCapability, getFilenameFromUrl,\n  removeNullCharacters\n} from 'pdfjs-lib';\n\n/**\n * @typedef {Object} PDFAttachmentViewerOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {DownloadManager} downloadManager - The download manager.\n */\n\n/**\n * @typedef {Object} PDFAttachmentViewerRenderParameters\n * @property {Object|null} attachments - A lookup table of attachment objects.\n */\n\nclass PDFAttachmentViewer {\n  /**\n   * @param {PDFAttachmentViewerOptions} options\n   */\n  constructor({ container, eventBus, downloadManager, }) {\n    this.container = container;\n    this.eventBus = eventBus;\n    this.downloadManager = downloadManager;\n\n    this.reset();\n\n    this.eventBus.on('fileattachmentannotation',\n      this._appendAttachment.bind(this));\n  }\n\n  reset(keepRenderedCapability = false) {\n    this.attachments = null;\n\n    // Remove the attachments from the DOM.\n    this.container.textContent = '';\n\n    if (!keepRenderedCapability) {\n      // NOTE: The *only* situation in which the `_renderedCapability` should\n      //       not be replaced is when appending file attachment annotations.\n      this._renderedCapability = createPromiseCapability();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent(attachmentsCount) {\n    this._renderedCapability.resolve();\n\n    this.eventBus.dispatch('attachmentsloaded', {\n      source: this,\n      attachmentsCount,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _bindPdfLink(button, content, filename) {\n    if (this.downloadManager.disableCreateObjectURL) {\n      throw new Error(\n        'bindPdfLink: Unsupported \"disableCreateObjectURL\" value.');\n    }\n    let blobUrl;\n    button.onclick = function() {\n      if (!blobUrl) {\n        blobUrl = createObjectURL(content, 'application/pdf');\n      }\n      let viewerUrl;\n      if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n        // The current URL is the viewer, let's use it and append the file.\n        viewerUrl = '?file=' + encodeURIComponent(blobUrl + '#' + filename);\n      } else if (PDFJSDev.test('CHROME')) {\n        // In the Chrome extension, the URL is rewritten using the history API\n        // in viewer.js, so an absolute URL must be generated.\n        // eslint-disable-next-line no-undef\n        viewerUrl = chrome.runtime.getURL('/content/web/viewer.html') +\n          '?file=' + encodeURIComponent(blobUrl + '#' + filename);\n      } else if (PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        // Let Firefox's content handler catch the URL and display the PDF.\n        viewerUrl = blobUrl + '?' + encodeURIComponent(filename);\n      }\n      window.open(viewerUrl);\n      return false;\n    };\n  }\n\n  /**\n   * @private\n   */\n  _bindLink(button, content, filename) {\n    button.onclick = () => {\n      this.downloadManager.downloadData(content, filename, '');\n      return false;\n    };\n  }\n\n  /**\n   * @param {PDFAttachmentViewerRenderParameters} params\n   */\n  render({ attachments, keepRenderedCapability = false, }) {\n    let attachmentsCount = 0;\n\n    if (this.attachments) {\n      this.reset(keepRenderedCapability === true);\n    }\n    this.attachments = attachments || null;\n\n    if (!attachments) {\n      this._dispatchEvent(attachmentsCount);\n      return;\n    }\n\n    let names = Object.keys(attachments).sort(function(a, b) {\n      return a.toLowerCase().localeCompare(b.toLowerCase());\n    });\n    attachmentsCount = names.length;\n\n    for (let i = 0; i < attachmentsCount; i++) {\n      let item = attachments[names[i]];\n      let filename = removeNullCharacters(getFilenameFromUrl(item.filename));\n\n      let div = document.createElement('div');\n      div.className = 'attachmentsItem';\n      let button = document.createElement('button');\n      button.textContent = filename;\n      if (/\\.pdf$/i.test(filename) &&\n          !this.downloadManager.disableCreateObjectURL) {\n        this._bindPdfLink(button, item.content, filename);\n      } else {\n        this._bindLink(button, item.content, filename);\n      }\n\n      div.appendChild(button);\n      this.container.appendChild(div);\n    }\n\n    this._dispatchEvent(attachmentsCount);\n  }\n\n  /**\n   * Used to append FileAttachment annotations to the sidebar.\n   * @private\n   */\n  _appendAttachment({ id, filename, content, }) {\n    this._renderedCapability.promise.then(() => {\n      let attachments = this.attachments;\n\n      if (!attachments) {\n        attachments = Object.create(null);\n      } else {\n        for (let name in attachments) {\n          if (id === name) {\n            return; // Ignore the new attachment if it already exists.\n          }\n        }\n      }\n      attachments[id] = {\n        filename,\n        content,\n      };\n      this.render({\n        attachments,\n        keepRenderedCapability: true,\n      });\n    });\n  }\n}\n\nexport {\n  PDFAttachmentViewer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createPromiseCapability, PDFDateString } from 'pdfjs-lib';\nimport {\n  getPageSizeInches, getPDFFileNameFromURL, isPortraitOrientation, NullL10n\n} from './ui_utils';\n\nconst DEFAULT_FIELD_CONTENT = '-';\n\n// See https://en.wikibooks.org/wiki/Lentis/Conversion_to_the_Metric_Standard_in_the_United_States\nconst NON_METRIC_LOCALES = ['en-us', 'en-lr', 'my'];\n\n// Should use the format: `width x height`, in portrait orientation.\n// See https://en.wikipedia.org/wiki/Paper_size\nconst US_PAGE_NAMES = {\n  '8.5x11': 'Letter',\n  '8.5x14': 'Legal',\n};\nconst METRIC_PAGE_NAMES = {\n  '297x420': 'A3',\n  '210x297': 'A4',\n};\n\nfunction getPageName(size, isPortrait, pageNames) {\n  const width = (isPortrait ? size.width : size.height);\n  const height = (isPortrait ? size.height : size.width);\n\n  return pageNames[`${width}x${height}`];\n}\n\n/**\n * @typedef {Object} PDFDocumentPropertiesOptions\n * @property {string} overlayName - Name/identifier for the overlay.\n * @property {Object} fields - Names and elements of the overlay's fields.\n * @property {HTMLDivElement} container - Div container for the overlay.\n * @property {HTMLButtonElement} closeButton - Button for closing the overlay.\n */\n\nclass PDFDocumentProperties {\n  /**\n   * @param {PDFDocumentPropertiesOptions} options\n   * @param {OverlayManager} overlayManager - Manager for the viewer overlays.\n   * @param {EventBus} eventBus - The application event bus.\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor({ overlayName, fields, container, closeButton, },\n              overlayManager, eventBus, l10n = NullL10n) {\n    this.overlayName = overlayName;\n    this.fields = fields;\n    this.container = container;\n    this.overlayManager = overlayManager;\n    this.l10n = l10n;\n\n    this._reset();\n\n    if (closeButton) { // Bind the event listener for the Close button.\n      closeButton.addEventListener('click', this.close.bind(this));\n    }\n    this.overlayManager.register(this.overlayName, this.container,\n                                 this.close.bind(this));\n\n    if (eventBus) {\n      eventBus.on('pagechanging', (evt) => {\n        this._currentPageNumber = evt.pageNumber;\n      });\n      eventBus.on('rotationchanging', (evt) => {\n        this._pagesRotation = evt.pagesRotation;\n      });\n    }\n\n    this._isNonMetricLocale = true; // The default viewer locale is 'en-us'.\n    l10n.getLanguage().then((locale) => {\n      this._isNonMetricLocale = NON_METRIC_LOCALES.includes(locale);\n    });\n  }\n\n  /**\n   * Open the document properties overlay.\n   */\n  open() {\n    let freezeFieldData = (data) => {\n      Object.defineProperty(this, 'fieldData', {\n        value: Object.freeze(data),\n        writable: false,\n        enumerable: true,\n        configurable: true,\n      });\n    };\n\n    Promise.all([this.overlayManager.open(this.overlayName),\n                 this._dataAvailableCapability.promise]).then(() => {\n      const currentPageNumber = this._currentPageNumber;\n      const pagesRotation = this._pagesRotation;\n\n      // If the document properties were previously fetched (for this PDF file),\n      // just update the dialog immediately to avoid redundant lookups.\n      if (this.fieldData &&\n          currentPageNumber === this.fieldData['_currentPageNumber'] &&\n          pagesRotation === this.fieldData['_pagesRotation']) {\n        this._updateUI();\n        return;\n      }\n\n      // Get the document properties.\n      this.pdfDocument.getMetadata().then(\n          ({ info, metadata, contentDispositionFilename, }) => {\n        return Promise.all([\n          info,\n          metadata,\n          contentDispositionFilename || getPDFFileNameFromURL(this.url || ''),\n          this._parseFileSize(this.maybeFileSize),\n          this._parseDate(info.CreationDate),\n          this._parseDate(info.ModDate),\n          this.pdfDocument.getPage(currentPageNumber).then((pdfPage) => {\n            return this._parsePageSize(getPageSizeInches(pdfPage),\n                                       pagesRotation);\n          }),\n          this._parseLinearization(info.IsLinearized),\n        ]);\n      }).then(([info, metadata, fileName, fileSize, creationDate, modDate,\n                pageSize, isLinearized]) => {\n        freezeFieldData({\n          'fileName': fileName,\n          'fileSize': fileSize,\n          'title': info.Title,\n          'author': info.Author,\n          'subject': info.Subject,\n          'keywords': info.Keywords,\n          'creationDate': creationDate,\n          'modificationDate': modDate,\n          'creator': info.Creator,\n          'producer': info.Producer,\n          'version': info.PDFFormatVersion,\n          'pageCount': this.pdfDocument.numPages,\n          'pageSize': pageSize,\n          'linearized': isLinearized,\n          '_currentPageNumber': currentPageNumber,\n          '_pagesRotation': pagesRotation,\n        });\n        this._updateUI();\n\n        // Get the correct fileSize, since it may not have been set (if\n        // `this.setFileSize` wasn't called) or may be incorrectly set.\n        return this.pdfDocument.getDownloadInfo();\n      }).then(({ length, }) => {\n        this.maybeFileSize = length;\n        return this._parseFileSize(length);\n      }).then((fileSize) => {\n        if (fileSize === this.fieldData['fileSize']) {\n          return; // The fileSize has already been correctly set.\n        }\n        let data = Object.assign(Object.create(null), this.fieldData);\n        data['fileSize'] = fileSize;\n\n        freezeFieldData(data);\n        this._updateUI();\n      });\n    });\n  }\n\n  /**\n   * Close the document properties overlay.\n   */\n  close() {\n    this.overlayManager.close(this.overlayName);\n  }\n\n  /**\n   * Set a reference to the PDF document and the URL in order\n   * to populate the overlay fields with the document properties.\n   * Note that the overlay will contain no information if this method\n   * is not called.\n   *\n   * @param {PDFDocumentProxy} pdfDocument - A reference to the PDF document.\n   * @param {string} url - The URL of the document.\n   */\n  setDocument(pdfDocument, url = null) {\n    if (this.pdfDocument) {\n      this._reset();\n      this._updateUI(true);\n    }\n    if (!pdfDocument) {\n      return;\n    }\n    this.pdfDocument = pdfDocument;\n    this.url = url;\n\n    this._dataAvailableCapability.resolve();\n  }\n\n  /**\n   * Set the file size of the PDF document. This method is used to\n   * update the file size in the document properties overlay once it\n   * is known so we do not have to wait until the entire file is loaded.\n   *\n   * @param {number} fileSize - The file size of the PDF document.\n   */\n  setFileSize(fileSize) {\n    if (Number.isInteger(fileSize) && fileSize > 0) {\n      this.maybeFileSize = fileSize;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _reset() {\n    this.pdfDocument = null;\n    this.url = null;\n\n    this.maybeFileSize = 0;\n    delete this.fieldData;\n    this._dataAvailableCapability = createPromiseCapability();\n    this._currentPageNumber = 1;\n    this._pagesRotation = 0;\n  }\n\n  /**\n   * Always updates all of the dialog fields, to prevent inconsistent UI state.\n   * NOTE: If the contents of a particular field is neither a non-empty string,\n   *       nor a number, it will fall back to `DEFAULT_FIELD_CONTENT`.\n   * @private\n   */\n  _updateUI(reset = false) {\n    if (reset || !this.fieldData) {\n      for (let id in this.fields) {\n        this.fields[id].textContent = DEFAULT_FIELD_CONTENT;\n      }\n      return;\n    }\n    if (this.overlayManager.active !== this.overlayName) {\n      // Don't bother updating the dialog if has already been closed,\n      // since it will be updated the next time `this.open` is called.\n      return;\n    }\n    for (let id in this.fields) {\n      let content = this.fieldData[id];\n      this.fields[id].textContent = (content || content === 0) ?\n                                    content : DEFAULT_FIELD_CONTENT;\n    }\n  }\n\n  /**\n   * @private\n   */\n  async _parseFileSize(fileSize = 0) {\n    let kb = fileSize / 1024;\n    if (!kb) {\n      return undefined;\n    } else if (kb < 1024) {\n      return this.l10n.get('document_properties_kb', {\n        size_kb: (+kb.toPrecision(3)).toLocaleString(),\n        size_b: fileSize.toLocaleString(),\n      }, '{{size_kb}} KB ({{size_b}} bytes)');\n    }\n    return this.l10n.get('document_properties_mb', {\n      size_mb: (+(kb / 1024).toPrecision(3)).toLocaleString(),\n      size_b: fileSize.toLocaleString(),\n    }, '{{size_mb}} MB ({{size_b}} bytes)');\n  }\n\n  /**\n   * @private\n   */\n  async _parsePageSize(pageSizeInches, pagesRotation) {\n    if (!pageSizeInches) {\n      return undefined;\n    }\n    // Take the viewer rotation into account as well; compare with Adobe Reader.\n    if (pagesRotation % 180 !== 0) {\n      pageSizeInches = {\n        width: pageSizeInches.height,\n        height: pageSizeInches.width,\n      };\n    }\n    const isPortrait = isPortraitOrientation(pageSizeInches);\n\n    let sizeInches = {\n      width: Math.round(pageSizeInches.width * 100) / 100,\n      height: Math.round(pageSizeInches.height * 100) / 100,\n    };\n    // 1in == 25.4mm; no need to round to 2 decimals for millimeters.\n    let sizeMillimeters = {\n      width: Math.round(pageSizeInches.width * 25.4 * 10) / 10,\n      height: Math.round(pageSizeInches.height * 25.4 * 10) / 10,\n    };\n\n    let pageName = null;\n    let name = getPageName(sizeInches, isPortrait, US_PAGE_NAMES) ||\n               getPageName(sizeMillimeters, isPortrait, METRIC_PAGE_NAMES);\n\n    if (!name && !(Number.isInteger(sizeMillimeters.width) &&\n                   Number.isInteger(sizeMillimeters.height))) {\n      // Attempt to improve the page name detection by falling back to fuzzy\n      // matching of the metric dimensions, to account for e.g. rounding errors\n      // and/or PDF files that define the page sizes in an imprecise manner.\n      const exactMillimeters = {\n        width: pageSizeInches.width * 25.4,\n        height: pageSizeInches.height * 25.4,\n      };\n      const intMillimeters = {\n        width: Math.round(sizeMillimeters.width),\n        height: Math.round(sizeMillimeters.height),\n      };\n\n      // Try to avoid false positives, by only considering \"small\" differences.\n      if (Math.abs(exactMillimeters.width - intMillimeters.width) < 0.1 &&\n          Math.abs(exactMillimeters.height - intMillimeters.height) < 0.1) {\n\n        name = getPageName(intMillimeters, isPortrait, METRIC_PAGE_NAMES);\n        if (name) {\n          // Update *both* sizes, computed above, to ensure that the displayed\n          // dimensions always correspond to the detected page name.\n          sizeInches = {\n            width: Math.round(intMillimeters.width / 25.4 * 100) / 100,\n            height: Math.round(intMillimeters.height / 25.4 * 100) / 100,\n          };\n          sizeMillimeters = intMillimeters;\n        }\n      }\n    }\n    if (name) {\n      pageName = this.l10n.get('document_properties_page_size_name_' +\n                               name.toLowerCase(), null, name);\n    }\n\n    return Promise.all([\n      (this._isNonMetricLocale ? sizeInches : sizeMillimeters),\n      this.l10n.get('document_properties_page_size_unit_' +\n                    (this._isNonMetricLocale ? 'inches' : 'millimeters'), null,\n                    this._isNonMetricLocale ? 'in' : 'mm'),\n      pageName,\n      this.l10n.get('document_properties_page_size_orientation_' +\n                    (isPortrait ? 'portrait' : 'landscape'), null,\n                    isPortrait ? 'portrait' : 'landscape'),\n    ]).then(([{ width, height, }, unit, name, orientation]) => {\n      return this.l10n.get('document_properties_page_size_dimension_' +\n                           (name ? 'name_' : '') + 'string', {\n          width: width.toLocaleString(),\n          height: height.toLocaleString(),\n          unit,\n          name,\n          orientation,\n        }, '{{width}}  {{height}} {{unit}} (' +\n           (name ? '{{name}}, ' : '') + '{{orientation}})');\n    });\n  }\n\n  /**\n   * @private\n   */\n  async _parseDate(inputDate) {\n    const dateObject = PDFDateString.toDateObject(inputDate);\n    if (!dateObject) {\n      return undefined;\n    }\n    return this.l10n.get('document_properties_date_string', {\n        date: dateObject.toLocaleDateString(),\n        time: dateObject.toLocaleTimeString(),\n      }, '{{date}}, {{time}}');\n  }\n\n  /**\n   * @private\n   */\n  _parseLinearization(isLinearized) {\n    return this.l10n.get('document_properties_linearized_' +\n                         (isLinearized ? 'yes' : 'no'), null,\n                         (isLinearized ? 'Yes' : 'No'));\n  }\n}\n\nexport {\n  PDFDocumentProperties,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus, NullL10n } from './ui_utils';\nimport { FindState } from './pdf_find_controller';\n\nconst MATCHES_COUNT_LIMIT = 1000;\n\n/**\n * Creates a \"search bar\" given a set of DOM elements that act as controls\n * for searching or for setting search preferences in the UI. This object\n * also sets up the appropriate events for the controls. Actual searching\n * is done by PDFFindController.\n */\nclass PDFFindBar {\n  constructor(options, eventBus = getGlobalEventBus(), l10n = NullL10n) {\n    this.opened = false;\n\n    this.bar = options.bar || null;\n    this.toggleButton = options.toggleButton || null;\n    this.findField = options.findField || null;\n    this.highlightAll = options.highlightAllCheckbox || null;\n    this.caseSensitive = options.caseSensitiveCheckbox || null;\n    this.entireWord = options.entireWordCheckbox || null;\n    this.findMsg = options.findMsg || null;\n    this.findResultsCount = options.findResultsCount || null;\n    this.findPreviousButton = options.findPreviousButton || null;\n    this.findNextButton = options.findNextButton || null;\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n\n    // Add event listeners to the DOM elements.\n    this.toggleButton.addEventListener('click', () => {\n      this.toggle();\n    });\n\n    this.findField.addEventListener('input', () => {\n      this.dispatchEvent('');\n    });\n\n    this.bar.addEventListener('keydown', (e) => {\n      switch (e.keyCode) {\n        case 13: // Enter\n          if (e.target === this.findField) {\n            this.dispatchEvent('again', e.shiftKey);\n          }\n          break;\n        case 27: // Escape\n          this.close();\n          break;\n      }\n    });\n\n    this.findPreviousButton.addEventListener('click', () => {\n      this.dispatchEvent('again', true);\n    });\n\n    this.findNextButton.addEventListener('click', () => {\n      this.dispatchEvent('again', false);\n    });\n\n    this.highlightAll.addEventListener('click', () => {\n      this.dispatchEvent('highlightallchange');\n    });\n\n    this.caseSensitive.addEventListener('click', () => {\n      this.dispatchEvent('casesensitivitychange');\n    });\n\n    this.entireWord.addEventListener('click', () => {\n      this.dispatchEvent('entirewordchange');\n    });\n\n    this.eventBus.on('resize', this._adjustWidth.bind(this));\n  }\n\n  reset() {\n    this.updateUIState();\n  }\n\n  dispatchEvent(type, findPrev) {\n    this.eventBus.dispatch('find', {\n      source: this,\n      type,\n      query: this.findField.value,\n      phraseSearch: true,\n      caseSensitive: this.caseSensitive.checked,\n      entireWord: this.entireWord.checked,\n      highlightAll: this.highlightAll.checked,\n      findPrevious: findPrev,\n    });\n  }\n\n  updateUIState(state, previous, matchesCount) {\n    let notFound = false;\n    let findMsg = '';\n    let status = '';\n\n    switch (state) {\n      case FindState.FOUND:\n        break;\n\n      case FindState.PENDING:\n        status = 'pending';\n        break;\n\n      case FindState.NOT_FOUND:\n        findMsg = this.l10n.get('find_not_found', null, 'Phrase not found');\n        notFound = true;\n        break;\n\n      case FindState.WRAPPED:\n        if (previous) {\n          findMsg = this.l10n.get('find_reached_top', null,\n            'Reached top of document, continued from bottom');\n        } else {\n          findMsg = this.l10n.get('find_reached_bottom', null,\n            'Reached end of document, continued from top');\n        }\n        break;\n    }\n\n    this.findField.classList.toggle('notFound', notFound);\n    this.findField.setAttribute('data-status', status);\n\n    Promise.resolve(findMsg).then((msg) => {\n      this.findMsg.textContent = msg;\n      this._adjustWidth();\n    });\n\n    this.updateResultsCount(matchesCount);\n  }\n\n  updateResultsCount({ current = 0, total = 0, } = {}) {\n    if (!this.findResultsCount) {\n      return; // No UI control is provided.\n    }\n    let matchesCountMsg = '', limit = MATCHES_COUNT_LIMIT;\n\n    if (total > 0) {\n      if (total > limit) {\n        if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('MOZCENTRAL')) {\n          // TODO: Remove this hard-coded `[other]` form once plural support has\n          // been implemented in the mozilla-central specific `l10n.js` file.\n          matchesCountMsg = this.l10n.get('find_match_count_limit[other]', {\n            limit,\n          }, 'More than {{limit}} matches');\n        } else {\n          matchesCountMsg = this.l10n.get('find_match_count_limit', {\n            limit,\n          }, 'More than {{limit}} match' + (limit !== 1 ? 'es' : ''));\n        }\n      } else {\n        if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('MOZCENTRAL')) {\n          // TODO: Remove this hard-coded `[other]` form once plural support has\n          // been implemented in the mozilla-central specific `l10n.js` file.\n          matchesCountMsg = this.l10n.get('find_match_count[other]', {\n            current,\n            total,\n          }, '{{current}} of {{total}} matches');\n        } else {\n          matchesCountMsg = this.l10n.get('find_match_count', {\n            current,\n            total,\n          }, '{{current}} of {{total}} match' + (total !== 1 ? 'es' : ''));\n        }\n      }\n    }\n    Promise.resolve(matchesCountMsg).then((msg) => {\n      this.findResultsCount.textContent = msg;\n      this.findResultsCount.classList.toggle('hidden', !total);\n      // Since `updateResultsCount` may be called from `PDFFindController`,\n      // ensure that the width of the findbar is always updated correctly.\n      this._adjustWidth();\n    });\n  }\n\n  open() {\n    if (!this.opened) {\n      this.opened = true;\n      this.toggleButton.classList.add('toggled');\n      this.bar.classList.remove('hidden');\n    }\n    this.findField.select();\n    this.findField.focus();\n\n    this._adjustWidth();\n  }\n\n  close() {\n    if (!this.opened) {\n      return;\n    }\n    this.opened = false;\n    this.toggleButton.classList.remove('toggled');\n    this.bar.classList.add('hidden');\n\n    this.eventBus.dispatch('findbarclose', { source: this, });\n  }\n\n  toggle() {\n    if (this.opened) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _adjustWidth() {\n    if (!this.opened) {\n      return;\n    }\n\n    // The find bar has an absolute position and thus the browser extends\n    // its width to the maximum possible width once the find bar does not fit\n    // entirely within the window anymore (and its elements are automatically\n    // wrapped). Here we detect and fix that.\n    this.bar.classList.remove('wrapContainers');\n\n    let findbarHeight = this.bar.clientHeight;\n    let inputContainerHeight = this.bar.firstElementChild.clientHeight;\n\n    if (findbarHeight > inputContainerHeight) {\n      // The findbar is taller than the input container, which means that\n      // the browser wrapped some of the elements. For a consistent look,\n      // wrap all of them to adjust the width of the find bar.\n      this.bar.classList.add('wrapContainers');\n    }\n  }\n}\n\nexport {\n  PDFFindBar,\n};\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CharacterType = {\n  SPACE: 0,\n  ALPHA_LETTER: 1,\n  PUNCT: 2,\n  HAN_LETTER: 3,\n  KATAKANA_LETTER: 4,\n  HIRAGANA_LETTER: 5,\n  HALFWIDTH_KATAKANA_LETTER: 6,\n  THAI_LETTER: 7,\n};\n\nfunction isAlphabeticalScript(charCode) {\n  return charCode < 0x2E80;\n}\n\nfunction isAscii(charCode) {\n  return (charCode & 0xFF80) === 0;\n}\n\nfunction isAsciiAlpha(charCode) {\n  return (charCode >= /* a = */ 0x61 && charCode <= /* z = */ 0x7A) ||\n         (charCode >= /* A = */ 0x41 && charCode <= /* Z = */ 0x5A);\n}\n\nfunction isAsciiDigit(charCode) {\n  return (charCode >= /* 0 = */ 0x30 && charCode <= /* 9 = */ 0x39);\n}\n\nfunction isAsciiSpace(charCode) {\n  return (charCode === /* SPACE = */ 0x20 || charCode === /* TAB = */ 0x09 ||\n          charCode === /* CR = */ 0x0D || charCode === /* LF = */ 0x0A);\n}\n\nfunction isHan(charCode) {\n  return (charCode >= 0x3400 && charCode <= 0x9FFF) ||\n         (charCode >= 0xF900 && charCode <= 0xFAFF);\n}\n\nfunction isKatakana(charCode) {\n  return (charCode >= 0x30A0 && charCode <= 0x30FF);\n}\n\nfunction isHiragana(charCode) {\n  return (charCode >= 0x3040 && charCode <= 0x309F);\n}\n\nfunction isHalfwidthKatakana(charCode) {\n  return (charCode >= 0xFF60 && charCode <= 0xFF9F);\n}\n\nfunction isThai(charCode) {\n  return (charCode & 0xFF80) === 0x0E00;\n}\n\n/**\n * This function is based on the word-break detection implemented in:\n * https://hg.mozilla.org/mozilla-central/file/tip/intl/lwbrk/WordBreaker.cpp\n */\nfunction getCharacterType(charCode) {\n  if (isAlphabeticalScript(charCode)) {\n    if (isAscii(charCode)) {\n      if (isAsciiSpace(charCode)) {\n        return CharacterType.SPACE;\n      } else if (isAsciiAlpha(charCode) || isAsciiDigit(charCode) ||\n                 charCode === /* UNDERSCORE = */ 0x5F) {\n        return CharacterType.ALPHA_LETTER;\n      }\n      return CharacterType.PUNCT;\n    } else if (isThai(charCode)) {\n      return CharacterType.THAI_LETTER;\n    } else if (charCode === /* NBSP = */ 0xA0) {\n      return CharacterType.SPACE;\n    }\n    return CharacterType.ALPHA_LETTER;\n  }\n\n  if (isHan(charCode)) {\n    return CharacterType.HAN_LETTER;\n  } else if (isKatakana(charCode)) {\n    return CharacterType.KATAKANA_LETTER;\n  } else if (isHiragana(charCode)) {\n    return CharacterType.HIRAGANA_LETTER;\n  } else if (isHalfwidthKatakana(charCode)) {\n    return CharacterType.HALFWIDTH_KATAKANA_LETTER;\n  }\n  return CharacterType.ALPHA_LETTER;\n}\n\nexport {\n  CharacterType,\n  getCharacterType,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getGlobalEventBus, isValidRotation, parseQueryString, waitOnEventOrTimeout\n} from './ui_utils';\n\n// Heuristic value used when force-resetting `this._blockHashChange`.\nconst HASH_CHANGE_TIMEOUT = 1000; // milliseconds\n// Heuristic value used when adding the current position to the browser history.\nconst POSITION_UPDATED_THRESHOLD = 50;\n// Heuristic value used when adding a temporary position to the browser history.\nconst UPDATE_VIEWAREA_TIMEOUT = 1000; // milliseconds\n\n/**\n * @typedef {Object} PDFHistoryOptions\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * @typedef {Object} InitializeParameters\n * @property {string} fingerprint - The PDF document's unique fingerprint.\n * @property {boolean} [resetHistory] - Reset the browsing history.\n * @property {boolean} [updateUrl] - Attempt to update the document URL, with\n *   the current hash, when pushing/replacing browser history entries.\n */\n\n/**\n * @typedef {Object} PushParameters\n * @property {string} [namedDest] - The named destination. If absent, a\n *   stringified version of `explicitDest` is used.\n * @property {Array} explicitDest - The explicit destination array.\n * @property {number} pageNumber - The page to which the destination points.\n */\n\nfunction getCurrentHash() {\n  return document.location.hash;\n}\n\nfunction parseCurrentHash(linkService) {\n  let hash = unescape(getCurrentHash()).substring(1);\n  let params = parseQueryString(hash);\n\n  let page = params.page | 0;\n  if (!(Number.isInteger(page) && page > 0 && page <= linkService.pagesCount)) {\n    page = null;\n  }\n  return { hash, page, rotation: linkService.rotation, };\n}\n\nclass PDFHistory {\n  /**\n   * @param {PDFHistoryOptions} options\n   */\n  constructor({ linkService, eventBus, }) {\n    this.linkService = linkService;\n    this.eventBus = eventBus || getGlobalEventBus();\n\n    this.initialized = false;\n    this.initialBookmark = null;\n    this.initialRotation = null;\n\n    this._boundEvents = Object.create(null);\n    this._isViewerInPresentationMode = false;\n    this._isPagesLoaded = false;\n\n    // Ensure that we don't miss either a 'presentationmodechanged' or a\n    // 'pagesloaded' event, by registering the listeners immediately.\n    this.eventBus.on('presentationmodechanged', (evt) => {\n      this._isViewerInPresentationMode = evt.active || evt.switchInProgress;\n    });\n    this.eventBus.on('pagesloaded', (evt) => {\n      this._isPagesLoaded = !!evt.pagesCount;\n    });\n  }\n\n  /**\n   * Initialize the history for the PDF document, using either the current\n   * browser history entry or the document hash, whichever is present.\n   * @param {InitializeParameters} params\n   */\n  initialize({ fingerprint, resetHistory = false, updateUrl = false, }) {\n    if (!fingerprint || typeof fingerprint !== 'string') {\n      console.error(\n        'PDFHistory.initialize: The \"fingerprint\" must be a non-empty string.');\n      return;\n    }\n    let reInitialized = this.initialized && this.fingerprint !== fingerprint;\n    this.fingerprint = fingerprint;\n    this._updateUrl = (updateUrl === true);\n\n    if (!this.initialized) {\n      this._bindEvents();\n    }\n    let state = window.history.state;\n\n    this.initialized = true;\n    this.initialBookmark = null;\n    this.initialRotation = null;\n\n    this._popStateInProgress = false;\n    this._blockHashChange = 0;\n    this._currentHash = getCurrentHash();\n    this._numPositionUpdates = 0;\n\n    this._uid = this._maxUid = 0;\n    this._destination = null;\n    this._position = null;\n\n    if (!this._isValidState(state, /* checkReload = */ true) || resetHistory) {\n      let { hash, page, rotation, } = parseCurrentHash(this.linkService);\n\n      if (!hash || reInitialized || resetHistory) {\n        // Ensure that the browser history is reset on PDF document load.\n        this._pushOrReplaceState(null, /* forceReplace = */ true);\n        return;\n      }\n      // Ensure that the browser history is initialized correctly when\n      // the document hash is present on PDF document load.\n      this._pushOrReplaceState({ hash, page, rotation, },\n                               /* forceReplace = */ true);\n      return;\n    }\n\n    // The browser history contains a valid entry, ensure that the history is\n    // initialized correctly on PDF document load.\n    let destination = state.destination;\n    this._updateInternalState(destination, state.uid,\n                              /* removeTemporary = */ true);\n    if (this._uid > this._maxUid) {\n      this._maxUid = this._uid;\n    }\n\n    if (destination.rotation !== undefined) {\n      this.initialRotation = destination.rotation;\n    }\n    if (destination.dest) {\n      this.initialBookmark = JSON.stringify(destination.dest);\n\n      // If the history is updated, e.g. through the user changing the hash,\n      // before the initial destination has become visible, then we do *not*\n      // want to potentially add `this._position` to the browser history.\n      this._destination.page = null;\n    } else if (destination.hash) {\n      this.initialBookmark = destination.hash;\n    } else if (destination.page) {\n      // Fallback case; shouldn't be necessary, but better safe than sorry.\n      this.initialBookmark = `page=${destination.page}`;\n    }\n  }\n\n  /**\n   * Push an internal destination to the browser history.\n   * @param {PushParameters}\n   */\n  push({ namedDest = null, explicitDest, pageNumber, }) {\n    if (!this.initialized) {\n      return;\n    }\n    if (namedDest && typeof namedDest !== 'string') {\n      console.error('PDFHistory.push: ' +\n                    `\"${namedDest}\" is not a valid namedDest parameter.`);\n      return;\n    } else if (!Array.isArray(explicitDest)) {\n      console.error('PDFHistory.push: ' +\n                    `\"${explicitDest}\" is not a valid explicitDest parameter.`);\n      return;\n    } else if (!(Number.isInteger(pageNumber) &&\n                 pageNumber > 0 && pageNumber <= this.linkService.pagesCount)) {\n      // Allow an unset `pageNumber` if and only if the history is still empty;\n      // please refer to the `this._destination.page = null;` comment above.\n      if (pageNumber !== null || this._destination) {\n        console.error('PDFHistory.push: ' +\n                      `\"${pageNumber}\" is not a valid pageNumber parameter.`);\n        return;\n      }\n    }\n\n    let hash = namedDest || JSON.stringify(explicitDest);\n    if (!hash) {\n      // The hash *should* never be undefined, but if that were to occur,\n      // avoid any possible issues by not updating the browser history.\n      return;\n    }\n\n    let forceReplace = false;\n    if (this._destination &&\n        (isDestHashesEqual(this._destination.hash, hash) ||\n         isDestArraysEqual(this._destination.dest, explicitDest))) {\n      // When the new destination is identical to `this._destination`, and\n      // its `page` is undefined, replace the current browser history entry.\n      // NOTE: This can only occur if `this._destination` was set either:\n      //  - through the document hash being specified on load.\n      //  - through the user changing the hash of the document.\n      if (this._destination.page) {\n        return;\n      }\n      forceReplace = true;\n    }\n    if (this._popStateInProgress && !forceReplace) {\n      return;\n    }\n\n    this._pushOrReplaceState({\n      dest: explicitDest,\n      hash,\n      page: pageNumber,\n      rotation: this.linkService.rotation,\n    }, forceReplace);\n\n    if (!this._popStateInProgress) {\n      // Prevent the browser history from updating while the new destination is\n      // being scrolled into view, to avoid potentially inconsistent state.\n      this._popStateInProgress = true;\n      // We defer the resetting of `this._popStateInProgress`, to account for\n      // e.g. zooming occuring when the new destination is being navigated to.\n      Promise.resolve().then(() => {\n        this._popStateInProgress = false;\n      });\n    }\n  }\n\n  /**\n   * Push the current position to the browser history.\n   */\n  pushCurrentPosition() {\n    if (!this.initialized || this._popStateInProgress) {\n      return;\n    }\n    this._tryPushCurrentPosition();\n  }\n\n  /**\n   * Go back one step in the browser history.\n   * NOTE: Avoids navigating away from the document, useful for \"named actions\".\n   */\n  back() {\n    if (!this.initialized || this._popStateInProgress) {\n      return;\n    }\n    let state = window.history.state;\n    if (this._isValidState(state) && state.uid > 0) {\n      window.history.back();\n    }\n  }\n\n  /**\n   * Go forward one step in the browser history.\n   * NOTE: Avoids navigating away from the document, useful for \"named actions\".\n   */\n  forward() {\n    if (!this.initialized || this._popStateInProgress) {\n      return;\n    }\n    let state = window.history.state;\n    if (this._isValidState(state) && state.uid < this._maxUid) {\n      window.history.forward();\n    }\n  }\n\n  /**\n   * @type {boolean} Indicating if the user is currently moving through the\n   *   browser history, useful e.g. for skipping the next 'hashchange' event.\n   */\n  get popStateInProgress() {\n    return this.initialized &&\n           (this._popStateInProgress || this._blockHashChange > 0);\n  }\n\n  /**\n   * @private\n   */\n  _pushOrReplaceState(destination, forceReplace = false) {\n    let shouldReplace = forceReplace || !this._destination;\n    let newState = {\n      fingerprint: this.fingerprint,\n      uid: shouldReplace ? this._uid : (this._uid + 1),\n      destination,\n    };\n\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME') &&\n        window.history.state && window.history.state.chromecomState) {\n      // history.state.chromecomState is managed by chromecom.js.\n      newState.chromecomState = window.history.state.chromecomState;\n    }\n    this._updateInternalState(destination, newState.uid);\n\n    let newUrl;\n    if (this._updateUrl && destination && destination.hash) {\n      const baseUrl = document.location.href.split('#')[0];\n      if (!baseUrl.startsWith('file://')) { // Prevent errors in Firefox.\n        newUrl = `${baseUrl}#${destination.hash}`;\n      }\n    }\n    if (shouldReplace) {\n      if (newUrl) {\n        window.history.replaceState(newState, '', newUrl);\n      } else {\n        window.history.replaceState(newState, '');\n      }\n    } else {\n      this._maxUid = this._uid;\n      if (newUrl) {\n        window.history.pushState(newState, '', newUrl);\n      } else {\n        window.history.pushState(newState, '');\n      }\n    }\n\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME') &&\n        top === window) {\n      // eslint-disable-next-line no-undef\n      chrome.runtime.sendMessage('showPageAction');\n    }\n  }\n\n  /**\n   * @private\n   */\n  _tryPushCurrentPosition(temporary = false) {\n    if (!this._position) {\n      return;\n    }\n    let position = this._position;\n    if (temporary) {\n      position = Object.assign(Object.create(null), this._position);\n      position.temporary = true;\n    }\n\n    if (!this._destination) {\n      this._pushOrReplaceState(position);\n      return;\n    }\n    if (this._destination.temporary) {\n      // Always replace a previous *temporary* position.\n      this._pushOrReplaceState(position, /* forceReplace = */ true);\n      return;\n    }\n    if (this._destination.hash === position.hash) {\n      return; // The current document position has not changed.\n    }\n    if (!this._destination.page &&\n        (POSITION_UPDATED_THRESHOLD <= 0 ||\n         this._numPositionUpdates <= POSITION_UPDATED_THRESHOLD)) {\n      // `this._destination` was set through the user changing the hash of\n      // the document. Do not add `this._position` to the browser history,\n      // to avoid \"flooding\" it with lots of (nearly) identical entries,\n      // since we cannot ensure that the document position has changed.\n      return;\n    }\n\n    let forceReplace = false;\n    if (this._destination.page >= position.first &&\n        this._destination.page <= position.page) {\n      // When the `page` of `this._destination` is still visible, do not\n      // update the browsing history when `this._destination` either:\n      //  - contains an internal destination, since in this case we\n      //    cannot ensure that the document position has actually changed.\n      //  - was set through the user changing the hash of the document.\n      if (this._destination.dest || !this._destination.first) {\n        return;\n      }\n      // To avoid \"flooding\" the browser history, replace the current entry.\n      forceReplace = true;\n    }\n    this._pushOrReplaceState(position, forceReplace);\n  }\n\n  /**\n   * @private\n   */\n  _isValidState(state, checkReload = false) {\n    if (!state) {\n      return false;\n    }\n    if (state.fingerprint !== this.fingerprint) {\n      if (checkReload) {\n        // Potentially accept the history entry, even if the fingerprints don't\n        // match, when the viewer was reloaded (see issue 6847).\n        if (typeof state.fingerprint !== 'string' ||\n            state.fingerprint.length !== this.fingerprint.length) {\n          return false;\n        }\n        const [perfEntry] = performance.getEntriesByType('navigation');\n        if (!perfEntry || perfEntry.type !== 'reload') {\n          return false;\n        }\n      } else {\n        // This should only occur in viewers with support for opening more than\n        // one PDF document, e.g. the GENERIC viewer.\n        return false;\n      }\n    }\n    if (!Number.isInteger(state.uid) || state.uid < 0) {\n      return false;\n    }\n    if (state.destination === null || typeof state.destination !== 'object') {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _updateInternalState(destination, uid, removeTemporary = false) {\n    if (this._updateViewareaTimeout) {\n      // When updating `this._destination`, make sure that we always wait for\n      // the next 'updateviewarea' event before (potentially) attempting to\n      // push the current position to the browser history.\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n    if (removeTemporary && destination && destination.temporary) {\n      // When the `destination` comes from the browser history,\n      // we no longer treat it as a *temporary* position.\n      delete destination.temporary;\n    }\n    this._destination = destination;\n    this._uid = uid;\n    // This should always be reset when `this._destination` is updated.\n    this._numPositionUpdates = 0;\n  }\n\n  /**\n   * @private\n   */\n  _updateViewarea({ location, }) {\n    if (this._updateViewareaTimeout) {\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n\n    this._position = {\n      hash: this._isViewerInPresentationMode ?\n        `page=${location.pageNumber}` : location.pdfOpenParams.substring(1),\n      page: this.linkService.page,\n      first: location.pageNumber,\n      rotation: location.rotation,\n    };\n\n    if (this._popStateInProgress) {\n      return;\n    }\n\n    if (POSITION_UPDATED_THRESHOLD > 0 && this._isPagesLoaded &&\n        this._destination && !this._destination.page) {\n      // If the current destination was set through the user changing the hash\n      // of the document, we will usually not try to push the current position\n      // to the browser history; see `this._tryPushCurrentPosition()`.\n      //\n      // To prevent `this._tryPushCurrentPosition()` from effectively being\n      // reduced to a no-op in this case, we will assume that the position\n      // *did* in fact change if the 'updateviewarea' event was dispatched\n      // more than `POSITION_UPDATED_THRESHOLD` times.\n      this._numPositionUpdates++;\n    }\n\n    if (UPDATE_VIEWAREA_TIMEOUT > 0) {\n      // When closing the browser, a 'pagehide' event will be dispatched which\n      // *should* allow us to push the current position to the browser history.\n      // In practice, it seems that the event is arriving too late in order for\n      // the session history to be successfully updated.\n      // (For additional details, please refer to the discussion in\n      //  https://bugzilla.mozilla.org/show_bug.cgi?id=1153393.)\n      //\n      // To workaround this we attempt to *temporarily* add the current position\n      // to the browser history only when the viewer is *idle*,\n      // i.e. when scrolling and/or zooming does not occur.\n      //\n      // PLEASE NOTE: It's absolutely imperative that the browser history is\n      // *not* updated too often, since that would render the viewer more or\n      // less unusable. Hence the use of a timeout to delay the update until\n      // the viewer has been idle for `UPDATE_VIEWAREA_TIMEOUT` milliseconds.\n      this._updateViewareaTimeout = setTimeout(() => {\n        if (!this._popStateInProgress) {\n          this._tryPushCurrentPosition(/* temporary = */ true);\n        }\n        this._updateViewareaTimeout = null;\n      }, UPDATE_VIEWAREA_TIMEOUT);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _popState({ state, }) {\n    let newHash = getCurrentHash(), hashChanged = this._currentHash !== newHash;\n    this._currentHash = newHash;\n\n    if (!state ||\n        (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME') &&\n         state.chromecomState && !this._isValidState(state))) {\n      // This case corresponds to the user changing the hash of the document.\n      this._uid++;\n\n      let { hash, page, rotation, } = parseCurrentHash(this.linkService);\n      this._pushOrReplaceState({ hash, page, rotation, },\n                               /* forceReplace = */ true);\n      return;\n    }\n    if (!this._isValidState(state)) {\n      // This should only occur in viewers with support for opening more than\n      // one PDF document, e.g. the GENERIC viewer.\n      return;\n    }\n\n    // Prevent the browser history from updating until the new destination,\n    // as stored in the browser history, has been scrolled into view.\n    this._popStateInProgress = true;\n\n    if (hashChanged) {\n      // When the hash changed, implying that the 'popstate' event will be\n      // followed by a 'hashchange' event, then we do *not* want to update the\n      // browser history when handling the 'hashchange' event (in web/app.js)\n      // since that would *overwrite* the new destination navigated to below.\n      //\n      // To avoid accidentally disabling all future user-initiated hash changes,\n      // if there's e.g. another 'hashchange' listener that stops the event\n      // propagation, we make sure to always force-reset `this._blockHashChange`\n      // after `HASH_CHANGE_TIMEOUT` milliseconds have passed.\n      this._blockHashChange++;\n      waitOnEventOrTimeout({\n        target: window,\n        name: 'hashchange',\n        delay: HASH_CHANGE_TIMEOUT,\n      }).then(() => {\n        this._blockHashChange--;\n      });\n    }\n\n    // Navigate to the new destination.\n    let destination = state.destination;\n    this._updateInternalState(destination, state.uid,\n                              /* removeTemporary = */ true);\n    if (this._uid > this._maxUid) {\n      this._maxUid = this._uid;\n    }\n\n    if (isValidRotation(destination.rotation)) {\n      this.linkService.rotation = destination.rotation;\n    }\n    if (destination.dest) {\n      this.linkService.navigateTo(destination.dest);\n    } else if (destination.hash) {\n      this.linkService.setHash(destination.hash);\n    } else if (destination.page) {\n      // Fallback case; shouldn't be necessary, but better safe than sorry.\n      this.linkService.page = destination.page;\n    }\n\n    // Since `PDFLinkService.navigateTo` is asynchronous, we thus defer the\n    // resetting of `this._popStateInProgress` slightly.\n    Promise.resolve().then(() => {\n      this._popStateInProgress = false;\n    });\n  }\n\n  /**\n   * @private\n   */\n  _bindEvents() {\n    let { _boundEvents, eventBus, } = this;\n\n    _boundEvents.updateViewarea = this._updateViewarea.bind(this);\n    _boundEvents.popState = this._popState.bind(this);\n    _boundEvents.pageHide = (evt) => {\n      // Attempt to push the `this._position` into the browser history when\n      // navigating away from the document. This is *only* done if the history\n      // is empty/temporary, since otherwise an existing browser history entry\n      // will end up being overwritten (given that new entries cannot be pushed\n      // into the browser history when the 'unload' event has already fired).\n      if (!this._destination || this._destination.temporary) {\n        this._tryPushCurrentPosition();\n      }\n    };\n\n    eventBus.on('updateviewarea', _boundEvents.updateViewarea);\n    window.addEventListener('popstate', _boundEvents.popState);\n    window.addEventListener('pagehide', _boundEvents.pageHide);\n  }\n}\n\nfunction isDestHashesEqual(destHash, pushHash) {\n  if (typeof destHash !== 'string' || typeof pushHash !== 'string') {\n    return false;\n  }\n  if (destHash === pushHash) {\n    return true;\n  }\n  let { nameddest, } = parseQueryString(destHash);\n  if (nameddest === pushHash) {\n    return true;\n  }\n  return false;\n}\n\nfunction isDestArraysEqual(firstDest, secondDest) {\n  function isEntryEqual(first, second) {\n    if (typeof first !== typeof second) {\n      return false;\n    }\n    if (Array.isArray(first) || Array.isArray(second)) {\n      return false;\n    }\n    if (first !== null && typeof first === 'object' && second !== null) {\n      if (Object.keys(first).length !== Object.keys(second).length) {\n        return false;\n      }\n      for (let key in first) {\n        if (!isEntryEqual(first[key], second[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return first === second || (Number.isNaN(first) && Number.isNaN(second));\n  }\n\n  if (!(Array.isArray(firstDest) && Array.isArray(secondDest))) {\n    return false;\n  }\n  if (firstDest.length !== secondDest.length) {\n    return false;\n  }\n  for (let i = 0, ii = firstDest.length; i < ii; i++) {\n    if (!isEntryEqual(firstDest[i], secondDest[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport {\n  PDFHistory,\n  isDestHashesEqual,\n  isDestArraysEqual,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { addLinkAttributes, LinkTarget, removeNullCharacters } from 'pdfjs-lib';\n\nconst DEFAULT_TITLE = '\\u2013';\n\n/**\n * @typedef {Object} PDFOutlineViewerOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * @typedef {Object} PDFOutlineViewerRenderParameters\n * @property {Array|null} outline - An array of outline objects.\n */\n\nclass PDFOutlineViewer {\n  /**\n   * @param {PDFOutlineViewerOptions} options\n   */\n  constructor({ container, linkService, eventBus, }) {\n    this.container = container;\n    this.linkService = linkService;\n    this.eventBus = eventBus;\n\n    this.reset();\n\n    eventBus.on('toggleoutlinetree', this.toggleOutlineTree.bind(this));\n  }\n\n  reset() {\n    this.outline = null;\n    this.lastToggleIsShow = true;\n\n    // Remove the outline from the DOM.\n    this.container.textContent = '';\n\n    // Ensure that the left (right in RTL locales) margin is always reset,\n    // to prevent incorrect outline alignment if a new document is opened.\n    this.container.classList.remove('outlineWithDeepNesting');\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent(outlineCount) {\n    this.eventBus.dispatch('outlineloaded', {\n      source: this,\n      outlineCount,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _bindLink(element, { url, newWindow, dest, }) {\n    let { linkService, } = this;\n\n    if (url) {\n      addLinkAttributes(element, {\n        url,\n        target: (newWindow ? LinkTarget.BLANK : linkService.externalLinkTarget),\n        rel: linkService.externalLinkRel,\n        enabled: linkService.externalLinkEnabled,\n      });\n      return;\n    }\n\n    element.href = linkService.getDestinationHash(dest);\n    element.onclick = () => {\n      if (dest) {\n        linkService.navigateTo(dest);\n      }\n      return false;\n    };\n  }\n\n  /**\n   * @private\n   */\n  _setStyles(element, { bold, italic, }) {\n    let styleStr = '';\n    if (bold) {\n      styleStr += 'font-weight: bold;';\n    }\n    if (italic) {\n      styleStr += 'font-style: italic;';\n    }\n\n    if (styleStr) {\n      element.setAttribute('style', styleStr);\n    }\n  }\n\n  /**\n   * Prepend a button before an outline item which allows the user to toggle\n   * the visibility of all outline items at that level.\n   *\n   * @private\n   */\n  _addToggleButton(div, { count, items, }) {\n    let toggler = document.createElement('div');\n    toggler.className = 'outlineItemToggler';\n    if (count < 0 && Math.abs(count) === items.length) {\n      toggler.classList.add('outlineItemsHidden');\n    }\n    toggler.onclick = (evt) => {\n      evt.stopPropagation();\n      toggler.classList.toggle('outlineItemsHidden');\n\n      if (evt.shiftKey) {\n        let shouldShowAll = !toggler.classList.contains('outlineItemsHidden');\n        this._toggleOutlineItem(div, shouldShowAll);\n      }\n    };\n    div.insertBefore(toggler, div.firstChild);\n  }\n\n  /**\n   * Toggle the visibility of the subtree of an outline item.\n   *\n   * @param {Element} root - the root of the outline (sub)tree.\n   * @param {boolean} show - whether to show the outline (sub)tree. If false,\n   *   the outline subtree rooted at |root| will be collapsed.\n   *\n   * @private\n   */\n  _toggleOutlineItem(root, show = false) {\n    this.lastToggleIsShow = show;\n    for (const toggler of root.querySelectorAll('.outlineItemToggler')) {\n      toggler.classList.toggle('outlineItemsHidden', !show);\n    }\n  }\n\n  /**\n   * Collapse or expand all subtrees of the outline.\n   */\n  toggleOutlineTree() {\n    if (!this.outline) {\n      return;\n    }\n    this._toggleOutlineItem(this.container, !this.lastToggleIsShow);\n  }\n\n  /**\n   * @param {PDFOutlineViewerRenderParameters} params\n   */\n  render({ outline, }) {\n    let outlineCount = 0;\n\n    if (this.outline) {\n      this.reset();\n    }\n    this.outline = outline || null;\n\n    if (!outline) {\n      this._dispatchEvent(outlineCount);\n      return;\n    }\n\n    let fragment = document.createDocumentFragment();\n    let queue = [{ parent: fragment, items: this.outline, }];\n    let hasAnyNesting = false;\n    while (queue.length > 0) {\n      const levelData = queue.shift();\n      for (const item of levelData.items) {\n        let div = document.createElement('div');\n        div.className = 'outlineItem';\n\n        let element = document.createElement('a');\n        this._bindLink(element, item);\n        this._setStyles(element, item);\n        element.textContent =\n          removeNullCharacters(item.title) || DEFAULT_TITLE;\n\n        div.appendChild(element);\n\n        if (item.items.length > 0) {\n          hasAnyNesting = true;\n          this._addToggleButton(div, item);\n\n          let itemsDiv = document.createElement('div');\n          itemsDiv.className = 'outlineItems';\n          div.appendChild(itemsDiv);\n          queue.push({ parent: itemsDiv, items: item.items, });\n        }\n\n        levelData.parent.appendChild(div);\n        outlineCount++;\n      }\n    }\n    if (hasAnyNesting) {\n      this.container.classList.add('outlineWithDeepNesting');\n\n      this.lastToggleIsShow =\n        (fragment.querySelectorAll('.outlineItemsHidden').length === 0);\n    }\n\n    this.container.appendChild(fragment);\n\n    this._dispatchEvent(outlineCount);\n  }\n}\n\nexport {\n  PDFOutlineViewer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { normalizeWheelEventDelta } from './ui_utils';\n\nconst DELAY_BEFORE_RESETTING_SWITCH_IN_PROGRESS = 1500; // in ms\nconst DELAY_BEFORE_HIDING_CONTROLS = 3000; // in ms\nconst ACTIVE_SELECTOR = 'pdfPresentationMode';\nconst CONTROLS_SELECTOR = 'pdfPresentationModeControls';\nconst MOUSE_SCROLL_COOLDOWN_TIME = 50; // in ms\nconst PAGE_SWITCH_THRESHOLD = 0.1;\n\n// Number of CSS pixels for a movement to count as a swipe.\nconst SWIPE_MIN_DISTANCE_THRESHOLD = 50;\n\n// Swipe angle deviation from the x or y axis before it is not\n// considered a swipe in that direction any more.\nconst SWIPE_ANGLE_THRESHOLD = Math.PI / 6;\n\n/**\n * @typedef {Object} PDFPresentationModeOptions\n * @property {HTMLDivElement} container - The container for the viewer element.\n * @property {HTMLDivElement} [viewer] - The viewer element.\n * @property {PDFViewer} pdfViewer - The document viewer.\n * @property {EventBus} eventBus - The application event bus.\n * @property {Array} [contextMenuItems] - The menu items that are added to the\n *   context menu in Presentation Mode.\n */\n\nclass PDFPresentationMode {\n  /**\n   * @param {PDFPresentationModeOptions} options\n   */\n  constructor({ container, viewer = null, pdfViewer, eventBus,\n                contextMenuItems = null, }) {\n    this.container = container;\n    this.viewer = viewer || container.firstElementChild;\n    this.pdfViewer = pdfViewer;\n    this.eventBus = eventBus;\n\n    this.active = false;\n    this.args = null;\n    this.contextMenuOpen = false;\n    this.mouseScrollTimeStamp = 0;\n    this.mouseScrollDelta = 0;\n    this.touchSwipeState = null;\n\n    if (contextMenuItems) {\n      contextMenuItems.contextFirstPage.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('firstpage', { source: this, });\n      });\n      contextMenuItems.contextLastPage.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('lastpage', { source: this, });\n      });\n      contextMenuItems.contextPageRotateCw.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('rotatecw', { source: this, });\n      });\n      contextMenuItems.contextPageRotateCcw.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('rotateccw', { source: this, });\n      });\n    }\n  }\n\n  /**\n   * Request the browser to enter fullscreen mode.\n   * @returns {boolean} Indicating if the request was successful.\n   */\n  request() {\n    if (this.switchInProgress || this.active || !this.viewer.hasChildNodes()) {\n      return false;\n    }\n    this._addFullscreenChangeListeners();\n    this._setSwitchInProgress();\n    this._notifyStateChange();\n\n    if (this.container.requestFullscreen) {\n      this.container.requestFullscreen();\n    } else if (this.container.mozRequestFullScreen) {\n      this.container.mozRequestFullScreen();\n    } else if (this.container.webkitRequestFullscreen) {\n      this.container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n    } else if (this.container.msRequestFullscreen) {\n      this.container.msRequestFullscreen();\n    } else {\n      return false;\n    }\n\n    this.args = {\n      page: this.pdfViewer.currentPageNumber,\n      previousScale: this.pdfViewer.currentScaleValue,\n    };\n\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _mouseWheel(evt) {\n    if (!this.active) {\n      return;\n    }\n\n    evt.preventDefault();\n\n    let delta = normalizeWheelEventDelta(evt);\n    let currentTime = (new Date()).getTime();\n    let storedTime = this.mouseScrollTimeStamp;\n\n    // If we've already switched page, avoid accidentally switching again.\n    if (currentTime > storedTime &&\n        currentTime - storedTime < MOUSE_SCROLL_COOLDOWN_TIME) {\n      return;\n    }\n    // If the scroll direction changed, reset the accumulated scroll delta.\n    if ((this.mouseScrollDelta > 0 && delta < 0) ||\n        (this.mouseScrollDelta < 0 && delta > 0)) {\n      this._resetMouseScrollState();\n    }\n    this.mouseScrollDelta += delta;\n\n    if (Math.abs(this.mouseScrollDelta) >= PAGE_SWITCH_THRESHOLD) {\n      let totalDelta = this.mouseScrollDelta;\n      this._resetMouseScrollState();\n      let success = totalDelta > 0 ? this._goToPreviousPage()\n                                   : this._goToNextPage();\n      if (success) {\n        this.mouseScrollTimeStamp = currentTime;\n      }\n    }\n  }\n\n  get isFullscreen() {\n    return !!(document.fullscreenElement || document.mozFullScreen ||\n              document.webkitIsFullScreen || document.msFullscreenElement);\n  }\n\n  /**\n   * @private\n   */\n  _goToPreviousPage() {\n    let page = this.pdfViewer.currentPageNumber;\n    // If we're at the first page, we don't need to do anything.\n    if (page <= 1) {\n      return false;\n    }\n    this.pdfViewer.currentPageNumber = (page - 1);\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _goToNextPage() {\n    let page = this.pdfViewer.currentPageNumber;\n    // If we're at the last page, we don't need to do anything.\n    if (page >= this.pdfViewer.pagesCount) {\n      return false;\n    }\n    this.pdfViewer.currentPageNumber = (page + 1);\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _notifyStateChange() {\n    this.eventBus.dispatch('presentationmodechanged', {\n      source: this,\n      active: this.active,\n      switchInProgress: !!this.switchInProgress,\n    });\n  }\n\n  /**\n   * Used to initialize a timeout when requesting Presentation Mode,\n   * i.e. when the browser is requested to enter fullscreen mode.\n   * This timeout is used to prevent the current page from being scrolled\n   * partially, or completely, out of view when entering Presentation Mode.\n   * NOTE: This issue seems limited to certain zoom levels (e.g. page-width).\n   *\n   * @private\n   */\n  _setSwitchInProgress() {\n    if (this.switchInProgress) {\n      clearTimeout(this.switchInProgress);\n    }\n    this.switchInProgress = setTimeout(() => {\n      this._removeFullscreenChangeListeners();\n      delete this.switchInProgress;\n      this._notifyStateChange();\n    }, DELAY_BEFORE_RESETTING_SWITCH_IN_PROGRESS);\n  }\n\n  /**\n   * @private\n   */\n  _resetSwitchInProgress() {\n    if (this.switchInProgress) {\n      clearTimeout(this.switchInProgress);\n      delete this.switchInProgress;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _enter() {\n    this.active = true;\n    this._resetSwitchInProgress();\n    this._notifyStateChange();\n    this.container.classList.add(ACTIVE_SELECTOR);\n\n    // Ensure that the correct page is scrolled into view when entering\n    // Presentation Mode, by waiting until fullscreen mode in enabled.\n    setTimeout(() => {\n      this.pdfViewer.currentPageNumber = this.args.page;\n      this.pdfViewer.currentScaleValue = 'page-fit';\n    }, 0);\n\n    this._addWindowListeners();\n    this._showControls();\n    this.contextMenuOpen = false;\n    this.container.setAttribute('contextmenu', 'viewerContextMenu');\n\n    // Text selection is disabled in Presentation Mode, thus it's not possible\n    // for the user to deselect text that is selected (e.g. with \"Select all\")\n    // when entering Presentation Mode, hence we remove any active selection.\n    window.getSelection().removeAllRanges();\n  }\n\n  /**\n   * @private\n   */\n  _exit() {\n    let page = this.pdfViewer.currentPageNumber;\n    this.container.classList.remove(ACTIVE_SELECTOR);\n\n    // Ensure that the correct page is scrolled into view when exiting\n    // Presentation Mode, by waiting until fullscreen mode is disabled.\n    setTimeout(() => {\n      this.active = false;\n      this._removeFullscreenChangeListeners();\n      this._notifyStateChange();\n\n      this.pdfViewer.currentScaleValue = this.args.previousScale;\n      this.pdfViewer.currentPageNumber = page;\n      this.args = null;\n    }, 0);\n\n    this._removeWindowListeners();\n    this._hideControls();\n    this._resetMouseScrollState();\n    this.container.removeAttribute('contextmenu');\n    this.contextMenuOpen = false;\n  }\n\n  /**\n   * @private\n   */\n  _mouseDown(evt) {\n    if (this.contextMenuOpen) {\n      this.contextMenuOpen = false;\n      evt.preventDefault();\n      return;\n    }\n    if (evt.button === 0) {\n      // Enable clicking of links in presentation mode. Note: only links\n      // pointing to destinations in the current PDF document work.\n      let isInternalLink = (evt.target.href &&\n                            evt.target.classList.contains('internalLink'));\n      if (!isInternalLink) {\n        // Unless an internal link was clicked, advance one page.\n        evt.preventDefault();\n\n        if (evt.shiftKey) {\n          this._goToPreviousPage();\n        } else {\n          this._goToNextPage();\n        }\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  _contextMenu() {\n    this.contextMenuOpen = true;\n  }\n\n  /**\n   * @private\n   */\n  _showControls() {\n    if (this.controlsTimeout) {\n      clearTimeout(this.controlsTimeout);\n    } else {\n      this.container.classList.add(CONTROLS_SELECTOR);\n    }\n    this.controlsTimeout = setTimeout(() => {\n      this.container.classList.remove(CONTROLS_SELECTOR);\n      delete this.controlsTimeout;\n    }, DELAY_BEFORE_HIDING_CONTROLS);\n  }\n\n  /**\n   * @private\n   */\n  _hideControls() {\n    if (!this.controlsTimeout) {\n      return;\n    }\n    clearTimeout(this.controlsTimeout);\n    this.container.classList.remove(CONTROLS_SELECTOR);\n    delete this.controlsTimeout;\n  }\n\n  /**\n   * Resets the properties used for tracking mouse scrolling events.\n   *\n   * @private\n   */\n  _resetMouseScrollState() {\n    this.mouseScrollTimeStamp = 0;\n    this.mouseScrollDelta = 0;\n  }\n\n  /**\n   * @private\n   */\n  _touchSwipe(evt) {\n    if (!this.active) {\n      return;\n    }\n    if (evt.touches.length > 1) {\n      // Multiple touch points detected; cancel the swipe.\n      this.touchSwipeState = null;\n      return;\n    }\n\n    switch (evt.type) {\n      case 'touchstart':\n        this.touchSwipeState = {\n          startX: evt.touches[0].pageX,\n          startY: evt.touches[0].pageY,\n          endX: evt.touches[0].pageX,\n          endY: evt.touches[0].pageY,\n        };\n        break;\n      case 'touchmove':\n        if (this.touchSwipeState === null) {\n          return;\n        }\n        this.touchSwipeState.endX = evt.touches[0].pageX;\n        this.touchSwipeState.endY = evt.touches[0].pageY;\n        // Avoid the swipe from triggering browser gestures (Chrome in\n        // particular has some sort of swipe gesture in fullscreen mode).\n        evt.preventDefault();\n        break;\n      case 'touchend':\n        if (this.touchSwipeState === null) {\n          return;\n        }\n        let delta = 0;\n        let dx = this.touchSwipeState.endX - this.touchSwipeState.startX;\n        let dy = this.touchSwipeState.endY - this.touchSwipeState.startY;\n        let absAngle = Math.abs(Math.atan2(dy, dx));\n        if (Math.abs(dx) > SWIPE_MIN_DISTANCE_THRESHOLD &&\n            (absAngle <= SWIPE_ANGLE_THRESHOLD ||\n             absAngle >= (Math.PI - SWIPE_ANGLE_THRESHOLD))) {\n          // Horizontal swipe.\n          delta = dx;\n        } else if (Math.abs(dy) > SWIPE_MIN_DISTANCE_THRESHOLD &&\n            Math.abs(absAngle - (Math.PI / 2)) <= SWIPE_ANGLE_THRESHOLD) {\n          // Vertical swipe.\n          delta = dy;\n        }\n        if (delta > 0) {\n          this._goToPreviousPage();\n        } else if (delta < 0) {\n          this._goToNextPage();\n        }\n        break;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _addWindowListeners() {\n    this.showControlsBind = this._showControls.bind(this);\n    this.mouseDownBind = this._mouseDown.bind(this);\n    this.mouseWheelBind = this._mouseWheel.bind(this);\n    this.resetMouseScrollStateBind = this._resetMouseScrollState.bind(this);\n    this.contextMenuBind = this._contextMenu.bind(this);\n    this.touchSwipeBind = this._touchSwipe.bind(this);\n\n    window.addEventListener('mousemove', this.showControlsBind);\n    window.addEventListener('mousedown', this.mouseDownBind);\n    window.addEventListener('wheel', this.mouseWheelBind);\n    window.addEventListener('keydown', this.resetMouseScrollStateBind);\n    window.addEventListener('contextmenu', this.contextMenuBind);\n    window.addEventListener('touchstart', this.touchSwipeBind);\n    window.addEventListener('touchmove', this.touchSwipeBind);\n    window.addEventListener('touchend', this.touchSwipeBind);\n  }\n\n  /**\n   * @private\n   */\n  _removeWindowListeners() {\n    window.removeEventListener('mousemove', this.showControlsBind);\n    window.removeEventListener('mousedown', this.mouseDownBind);\n    window.removeEventListener('wheel', this.mouseWheelBind);\n    window.removeEventListener('keydown', this.resetMouseScrollStateBind);\n    window.removeEventListener('contextmenu', this.contextMenuBind);\n    window.removeEventListener('touchstart', this.touchSwipeBind);\n    window.removeEventListener('touchmove', this.touchSwipeBind);\n    window.removeEventListener('touchend', this.touchSwipeBind);\n\n    delete this.showControlsBind;\n    delete this.mouseDownBind;\n    delete this.mouseWheelBind;\n    delete this.resetMouseScrollStateBind;\n    delete this.contextMenuBind;\n    delete this.touchSwipeBind;\n  }\n\n  /**\n   * @private\n   */\n  _fullscreenChange() {\n    if (this.isFullscreen) {\n      this._enter();\n    } else {\n      this._exit();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _addFullscreenChangeListeners() {\n    this.fullscreenChangeBind = this._fullscreenChange.bind(this);\n\n    window.addEventListener('fullscreenchange', this.fullscreenChangeBind);\n    window.addEventListener('mozfullscreenchange', this.fullscreenChangeBind);\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      window.addEventListener('webkitfullscreenchange',\n                              this.fullscreenChangeBind);\n      window.addEventListener('MSFullscreenChange',\n                              this.fullscreenChangeBind);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _removeFullscreenChangeListeners() {\n    window.removeEventListener('fullscreenchange', this.fullscreenChangeBind);\n    window.removeEventListener('mozfullscreenchange',\n                               this.fullscreenChangeBind);\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      window.removeEventListener('webkitfullscreenchange',\n                                 this.fullscreenChangeBind);\n      window.removeEventListener('MSFullscreenChange',\n                                 this.fullscreenChangeBind);\n    }\n\n    delete this.fullscreenChangeBind;\n  }\n}\n\nexport {\n  PDFPresentationMode,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clamp, NullL10n } from './ui_utils';\n\nconst SIDEBAR_WIDTH_VAR = '--sidebar-width';\nconst SIDEBAR_MIN_WIDTH = 200; // pixels\nconst SIDEBAR_RESIZING_CLASS = 'sidebarResizing';\n\n/**\n * @typedef {Object} PDFSidebarResizerOptions\n * @property {HTMLDivElement} outerContainer - The outer container\n *   (encasing both the viewer and sidebar elements).\n * @property {HTMLDivElement} resizer - The DOM element that can be dragged in\n *   order to adjust the width of the sidebar.\n */\n\nclass PDFSidebarResizer {\n  /**\n   * @param {PDFSidebarResizerOptions} options\n   * @param {EventBus} eventBus - The application event bus.\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor(options, eventBus, l10n = NullL10n) {\n    this.enabled = false;\n    this.isRTL = false;\n    this.sidebarOpen = false;\n    this.doc = document.documentElement;\n    this._width = null;\n    this._outerContainerWidth = null;\n    this._boundEvents = Object.create(null);\n\n    this.outerContainer = options.outerContainer;\n    this.resizer = options.resizer;\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n\n    if ((typeof PDFJSDev === 'undefined' || !PDFJSDev.test('MOZCENTRAL')) &&\n        (typeof CSS === 'undefined' || typeof CSS.supports !== 'function' ||\n         !CSS.supports(SIDEBAR_WIDTH_VAR,\n                       `calc(-1 * ${SIDEBAR_MIN_WIDTH}px)`))) {\n      console.warn('PDFSidebarResizer: ' +\n                   'The browser does not support resizing of the sidebar.');\n      return;\n    }\n    this.enabled = true;\n    this.resizer.classList.remove('hidden'); // Show the resizer DOM element.\n\n    this.l10n.getDirection().then((dir) => {\n      this.isRTL = (dir === 'rtl');\n    });\n    this._addEventListeners();\n  }\n\n  /**\n   * @type {number}\n   */\n  get outerContainerWidth() {\n    if (!this._outerContainerWidth) {\n      this._outerContainerWidth = this.outerContainer.clientWidth;\n    }\n    return this._outerContainerWidth;\n  }\n\n  /**\n   * @private\n   * returns {boolean} Indicating if the sidebar width was updated.\n   */\n  _updateWidth(width = 0) {\n    if (!this.enabled) {\n      return false;\n    }\n    // Prevent the sidebar from becoming too narrow, or from occupying more\n    // than half of the available viewer width.\n    const newWidth = clamp(width, SIDEBAR_MIN_WIDTH,\n                           Math.floor(this.outerContainerWidth / 2));\n    // Only update the UI when the sidebar width did in fact change.\n    if (newWidth === this._width) {\n      return false;\n    }\n    this._width = newWidth;\n    this.doc.style.setProperty(SIDEBAR_WIDTH_VAR, `${newWidth}px`);\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _mouseMove(evt) {\n    let width = evt.clientX;\n    // For sidebar resizing to work correctly in RTL mode, invert the width.\n    if (this.isRTL) {\n      width = this.outerContainerWidth - width;\n    }\n    this._updateWidth(width);\n  }\n\n  /**\n   * @private\n   */\n  _mouseUp(evt) {\n    // Re-enable the `transition-duration` rules when sidebar resizing ends...\n    this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS);\n    // ... and ensure that rendering will always be triggered.\n    this.eventBus.dispatch('resize', { source: this, });\n\n    let _boundEvents = this._boundEvents;\n    window.removeEventListener('mousemove', _boundEvents.mouseMove);\n    window.removeEventListener('mouseup', _boundEvents.mouseUp);\n  }\n\n  /**\n   * @private\n   */\n  _addEventListeners() {\n    if (!this.enabled) {\n      return;\n    }\n    let _boundEvents = this._boundEvents;\n    _boundEvents.mouseMove = this._mouseMove.bind(this);\n    _boundEvents.mouseUp = this._mouseUp.bind(this);\n\n    this.resizer.addEventListener('mousedown', (evt) => {\n      if (evt.button !== 0) {\n        return;\n      }\n      // Disable the `transition-duration` rules when sidebar resizing begins,\n      // in order to improve responsiveness and to avoid visual glitches.\n      this.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);\n\n      window.addEventListener('mousemove', _boundEvents.mouseMove);\n      window.addEventListener('mouseup', _boundEvents.mouseUp);\n    });\n\n    this.eventBus.on('sidebarviewchanged', (evt) => {\n      this.sidebarOpen = !!(evt && evt.view);\n    });\n\n    this.eventBus.on('resize', (evt) => {\n      // When the *entire* viewer is resized, such that it becomes narrower,\n      // ensure that the sidebar doesn't end up being too wide.\n      if (!evt || evt.source !== window) {\n        return;\n      }\n      // Always reset the cached width when the viewer is resized.\n      this._outerContainerWidth = null;\n\n      if (!this._width) {\n        // The sidebar hasn't been resized, hence no need to adjust its width.\n        return;\n      }\n      // NOTE: If the sidebar is closed, we don't need to worry about\n      //       visual glitches nor ensure that rendering is triggered.\n      if (!this.sidebarOpen) {\n        this._updateWidth(this._width);\n        return;\n      }\n      this.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);\n      let updated = this._updateWidth(this._width);\n\n      Promise.resolve().then(() => {\n        this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS);\n        // Trigger rendering if the sidebar width changed, to avoid\n        // depending on the order in which 'resize' events are handled.\n        if (updated) {\n          this.eventBus.dispatch('resize', { source: this, });\n        }\n      });\n    });\n  }\n}\n\nexport {\n  PDFSidebarResizer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getVisibleElements, isValidRotation, NullL10n, scrollIntoView, watchScroll\n} from './ui_utils';\nimport { PDFThumbnailView } from './pdf_thumbnail_view';\n\nconst THUMBNAIL_SCROLL_MARGIN = -19;\nconst THUMBNAIL_SELECTED_CLASS = 'selected';\n\n/**\n * @typedef {Object} PDFThumbnailViewerOptions\n * @property {HTMLDivElement} container - The container for the thumbnail\n *   elements.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {IL10n} l10n - Localization service.\n */\n\n/**\n * Viewer control to display thumbnails for pages in a PDF document.\n *\n * @implements {IRenderableView}\n */\nclass PDFThumbnailViewer {\n  /**\n   * @param {PDFThumbnailViewerOptions} options\n   */\n  constructor({ container, linkService, renderingQueue, l10n = NullL10n, }) {\n    this.container = container;\n    this.linkService = linkService;\n    this.renderingQueue = renderingQueue;\n    this.l10n = l10n;\n\n    this.scroll = watchScroll(this.container, this._scrollUpdated.bind(this));\n    this._resetView();\n  }\n\n  /**\n   * @private\n   */\n  _scrollUpdated() {\n    this.renderingQueue.renderHighestPriority();\n  }\n\n  getThumbnail(index) {\n    return this._thumbnails[index];\n  }\n\n  /**\n   * @private\n   */\n  _getVisibleThumbs() {\n    return getVisibleElements(this.container, this._thumbnails);\n  }\n\n  scrollThumbnailIntoView(pageNumber) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const thumbnailView = this._thumbnails[pageNumber - 1];\n\n    if (!thumbnailView) {\n      console.error('scrollThumbnailIntoView: Invalid \"pageNumber\" parameter.');\n      return;\n    }\n\n    if (pageNumber !== this._currentPageNumber) {\n      const prevThumbnailView = this._thumbnails[this._currentPageNumber - 1];\n      // Remove the highlight from the previous thumbnail...\n      prevThumbnailView.div.classList.remove(THUMBNAIL_SELECTED_CLASS);\n      // ... and add the highlight to the new thumbnail.\n      thumbnailView.div.classList.add(THUMBNAIL_SELECTED_CLASS);\n    }\n    let visibleThumbs = this._getVisibleThumbs();\n    let numVisibleThumbs = visibleThumbs.views.length;\n\n    // If the thumbnail isn't currently visible, scroll it into view.\n    if (numVisibleThumbs > 0) {\n      let first = visibleThumbs.first.id;\n      // Account for only one thumbnail being visible.\n      let last = (numVisibleThumbs > 1 ? visibleThumbs.last.id : first);\n\n      let shouldScroll = false;\n      if (pageNumber <= first || pageNumber >= last) {\n        shouldScroll = true;\n      } else {\n        visibleThumbs.views.some(function(view) {\n          if (view.id !== pageNumber) {\n            return false;\n          }\n          shouldScroll = view.percent < 100;\n          return true;\n        });\n      }\n      if (shouldScroll) {\n        scrollIntoView(thumbnailView.div, { top: THUMBNAIL_SCROLL_MARGIN, });\n      }\n    }\n\n    this._currentPageNumber = pageNumber;\n  }\n\n  get pagesRotation() {\n    return this._pagesRotation;\n  }\n\n  set pagesRotation(rotation) {\n    if (!isValidRotation(rotation)) {\n      throw new Error('Invalid thumbnails rotation angle.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (this._pagesRotation === rotation) {\n      return; // The rotation didn't change.\n    }\n    this._pagesRotation = rotation;\n\n    for (let i = 0, ii = this._thumbnails.length; i < ii; i++) {\n      this._thumbnails[i].update(rotation);\n    }\n  }\n\n  cleanup() {\n    PDFThumbnailView.cleanup();\n  }\n\n  /**\n   * @private\n   */\n  _resetView() {\n    this._thumbnails = [];\n    this._currentPageNumber = 1;\n    this._pageLabels = null;\n    this._pagesRotation = 0;\n    this._pagesRequests = [];\n\n    // Remove the thumbnails from the DOM.\n    this.container.textContent = '';\n  }\n\n  setDocument(pdfDocument) {\n    if (this.pdfDocument) {\n      this._cancelRendering();\n      this._resetView();\n    }\n\n    this.pdfDocument = pdfDocument;\n    if (!pdfDocument) {\n      return;\n    }\n\n    pdfDocument.getPage(1).then((firstPage) => {\n      let pagesCount = pdfDocument.numPages;\n      let viewport = firstPage.getViewport({ scale: 1, });\n      for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n        let thumbnail = new PDFThumbnailView({\n          container: this.container,\n          id: pageNum,\n          defaultViewport: viewport.clone(),\n          linkService: this.linkService,\n          renderingQueue: this.renderingQueue,\n          disableCanvasToImageConversion: false,\n          l10n: this.l10n,\n        });\n        this._thumbnails.push(thumbnail);\n      }\n\n      // Ensure that the current thumbnail is always highlighted on load.\n      const thumbnailView = this._thumbnails[this._currentPageNumber - 1];\n      thumbnailView.div.classList.add(THUMBNAIL_SELECTED_CLASS);\n    }).catch((reason) => {\n      console.error('Unable to initialize thumbnail viewer', reason);\n    });\n  }\n\n  /**\n   * @private\n   */\n  _cancelRendering() {\n    for (let i = 0, ii = this._thumbnails.length; i < ii; i++) {\n      if (this._thumbnails[i]) {\n        this._thumbnails[i].cancelRendering();\n      }\n    }\n  }\n\n  /**\n   * @param {Array|null} labels\n   */\n  setPageLabels(labels) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (!labels) {\n      this._pageLabels = null;\n    } else if (!(Array.isArray(labels) &&\n                 this.pdfDocument.numPages === labels.length)) {\n      this._pageLabels = null;\n      console.error('PDFThumbnailViewer_setPageLabels: Invalid page labels.');\n    } else {\n      this._pageLabels = labels;\n    }\n    // Update all the `PDFThumbnailView` instances.\n    for (let i = 0, ii = this._thumbnails.length; i < ii; i++) {\n      let label = this._pageLabels && this._pageLabels[i];\n      this._thumbnails[i].setPageLabel(label);\n    }\n  }\n\n  /**\n   * @param {PDFThumbnailView} thumbView\n   * @returns {PDFPage}\n   * @private\n   */\n  _ensurePdfPageLoaded(thumbView) {\n    if (thumbView.pdfPage) {\n      return Promise.resolve(thumbView.pdfPage);\n    }\n    let pageNumber = thumbView.id;\n    if (this._pagesRequests[pageNumber]) {\n      return this._pagesRequests[pageNumber];\n    }\n    let promise = this.pdfDocument.getPage(pageNumber).then((pdfPage) => {\n      thumbView.setPdfPage(pdfPage);\n      this._pagesRequests[pageNumber] = null;\n      return pdfPage;\n    }).catch((reason) => {\n      console.error('Unable to get page for thumb view', reason);\n      // Page error -- there is nothing can be done.\n      this._pagesRequests[pageNumber] = null;\n    });\n    this._pagesRequests[pageNumber] = promise;\n    return promise;\n  }\n\n  forceRendering() {\n    let visibleThumbs = this._getVisibleThumbs();\n    let thumbView = this.renderingQueue.getHighestPriority(visibleThumbs,\n                                                           this._thumbnails,\n                                                           this.scroll.down);\n    if (thumbView) {\n      this._ensurePdfPageLoaded(thumbView).then(() => {\n        this.renderingQueue.renderView(thumbView);\n      });\n      return true;\n    }\n    return false;\n  }\n}\n\nexport {\n  PDFThumbnailViewer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createPromiseCapability, RenderingCancelledException\n} from 'pdfjs-lib';\nimport { getOutputScale, NullL10n } from './ui_utils';\nimport { RenderingStates } from './pdf_rendering_queue';\n\nconst MAX_NUM_SCALING_STEPS = 3;\nconst THUMBNAIL_CANVAS_BORDER_WIDTH = 1; // px\nconst THUMBNAIL_WIDTH = 98; // px\n\n/**\n * @typedef {Object} PDFThumbnailViewOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {number} id - The thumbnail's unique ID (normally its number).\n * @property {PageViewport} defaultViewport - The page viewport.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {boolean} [disableCanvasToImageConversion] - Don't convert the\n *   canvas thumbnails to images. This prevents `toDataURL` calls, but\n *   increases the overall memory usage. The default value is `false`.\n * @property {IL10n} l10n - Localization service.\n */\n\nconst TempImageFactory = (function TempImageFactoryClosure() {\n  let tempCanvasCache = null;\n\n  return {\n    getCanvas(width, height) {\n      let tempCanvas = tempCanvasCache;\n      if (!tempCanvas) {\n        tempCanvas = document.createElement('canvas');\n        tempCanvasCache = tempCanvas;\n      }\n      tempCanvas.width = width;\n      tempCanvas.height = height;\n\n      // Since this is a temporary canvas, we need to fill it with a white\n      // background ourselves. `_getPageDrawContext` uses CSS rules for this.\n      if (typeof PDFJSDev === 'undefined' ||\n          PDFJSDev.test('MOZCENTRAL || FIREFOX || GENERIC')) {\n        tempCanvas.mozOpaque = true;\n      }\n\n      let ctx = tempCanvas.getContext('2d', { alpha: false, });\n      ctx.save();\n      ctx.fillStyle = 'rgb(255, 255, 255)';\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n      return tempCanvas;\n    },\n\n    destroyCanvas() {\n      let tempCanvas = tempCanvasCache;\n      if (tempCanvas) {\n        // Zeroing the width and height causes Firefox to release graphics\n        // resources immediately, which can greatly reduce memory consumption.\n        tempCanvas.width = 0;\n        tempCanvas.height = 0;\n      }\n      tempCanvasCache = null;\n    },\n  };\n})();\n\n/**\n * @implements {IRenderableView}\n */\nclass PDFThumbnailView {\n  /**\n   * @param {PDFThumbnailViewOptions} options\n   */\n  constructor({ container, id, defaultViewport, linkService, renderingQueue,\n                disableCanvasToImageConversion = false, l10n = NullL10n, }) {\n    this.id = id;\n    this.renderingId = 'thumbnail' + id;\n    this.pageLabel = null;\n\n    this.pdfPage = null;\n    this.rotation = 0;\n    this.viewport = defaultViewport;\n    this.pdfPageRotate = defaultViewport.rotation;\n\n    this.linkService = linkService;\n    this.renderingQueue = renderingQueue;\n\n    this.renderTask = null;\n    this.renderingState = RenderingStates.INITIAL;\n    this.resume = null;\n    this.disableCanvasToImageConversion = disableCanvasToImageConversion;\n\n    this.pageWidth = this.viewport.width;\n    this.pageHeight = this.viewport.height;\n    this.pageRatio = this.pageWidth / this.pageHeight;\n\n    this.canvasWidth = THUMBNAIL_WIDTH;\n    this.canvasHeight = (this.canvasWidth / this.pageRatio) | 0;\n    this.scale = this.canvasWidth / this.pageWidth;\n\n    this.l10n = l10n;\n\n    let anchor = document.createElement('a');\n    anchor.href = linkService.getAnchorUrl('#page=' + id);\n    this.l10n.get('thumb_page_title', { page: id, }, 'Page {{page}}').\n        then((msg) => {\n      anchor.title = msg;\n    });\n    anchor.onclick = function() {\n      linkService.page = id;\n      return false;\n    };\n    this.anchor = anchor;\n\n    let div = document.createElement('div');\n    div.className = 'thumbnail';\n    div.setAttribute('data-page-number', this.id);\n    this.div = div;\n\n    let ring = document.createElement('div');\n    ring.className = 'thumbnailSelectionRing';\n    let borderAdjustment = 2 * THUMBNAIL_CANVAS_BORDER_WIDTH;\n    ring.style.width = this.canvasWidth + borderAdjustment + 'px';\n    ring.style.height = this.canvasHeight + borderAdjustment + 'px';\n    this.ring = ring;\n\n    div.appendChild(ring);\n    anchor.appendChild(div);\n    container.appendChild(anchor);\n  }\n\n  setPdfPage(pdfPage) {\n    this.pdfPage = pdfPage;\n    this.pdfPageRotate = pdfPage.rotate;\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = pdfPage.getViewport({ scale: 1, rotation: totalRotation, });\n    this.reset();\n  }\n\n  reset() {\n    this.cancelRendering();\n    this.renderingState = RenderingStates.INITIAL;\n\n    this.pageWidth = this.viewport.width;\n    this.pageHeight = this.viewport.height;\n    this.pageRatio = this.pageWidth / this.pageHeight;\n\n    this.canvasHeight = (this.canvasWidth / this.pageRatio) | 0;\n    this.scale = (this.canvasWidth / this.pageWidth);\n\n    this.div.removeAttribute('data-loaded');\n    let ring = this.ring;\n    let childNodes = ring.childNodes;\n    for (let i = childNodes.length - 1; i >= 0; i--) {\n      ring.removeChild(childNodes[i]);\n    }\n    let borderAdjustment = 2 * THUMBNAIL_CANVAS_BORDER_WIDTH;\n    ring.style.width = this.canvasWidth + borderAdjustment + 'px';\n    ring.style.height = this.canvasHeight + borderAdjustment + 'px';\n\n    if (this.canvas) {\n      // Zeroing the width and height causes Firefox to release graphics\n      // resources immediately, which can greatly reduce memory consumption.\n      this.canvas.width = 0;\n      this.canvas.height = 0;\n      delete this.canvas;\n    }\n    if (this.image) {\n      this.image.removeAttribute('src');\n      delete this.image;\n    }\n  }\n\n  update(rotation) {\n    if (typeof rotation !== 'undefined') {\n      this.rotation = rotation;\n    }\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = this.viewport.clone({\n      scale: 1,\n      rotation: totalRotation,\n    });\n    this.reset();\n  }\n\n  /**\n   * PLEASE NOTE: Most likely you want to use the `this.reset()` method,\n   *              rather than calling this one directly.\n   */\n  cancelRendering() {\n    if (this.renderTask) {\n      this.renderTask.cancel();\n      this.renderTask = null;\n    }\n    this.resume = null;\n  }\n\n  /**\n   * @private\n   */\n  _getPageDrawContext(noCtxScale = false) {\n    let canvas = document.createElement('canvas');\n    // Keep the no-thumbnail outline visible, i.e. `data-loaded === false`,\n    // until rendering/image conversion is complete, to avoid display issues.\n    this.canvas = canvas;\n\n    if (typeof PDFJSDev === 'undefined' ||\n        PDFJSDev.test('MOZCENTRAL || FIREFOX || GENERIC')) {\n      canvas.mozOpaque = true;\n    }\n    let ctx = canvas.getContext('2d', { alpha: false, });\n    let outputScale = getOutputScale(ctx);\n\n    canvas.width = (this.canvasWidth * outputScale.sx) | 0;\n    canvas.height = (this.canvasHeight * outputScale.sy) | 0;\n    canvas.style.width = this.canvasWidth + 'px';\n    canvas.style.height = this.canvasHeight + 'px';\n\n    if (!noCtxScale && outputScale.scaled) {\n      ctx.scale(outputScale.sx, outputScale.sy);\n    }\n    return ctx;\n  }\n\n  /**\n   * @private\n   */\n  _convertCanvasToImage() {\n    if (!this.canvas) {\n      return;\n    }\n    if (this.renderingState !== RenderingStates.FINISHED) {\n      return;\n    }\n    let id = this.renderingId;\n    let className = 'thumbnailImage';\n\n    if (this.disableCanvasToImageConversion) {\n      this.canvas.id = id;\n      this.canvas.className = className;\n      this.l10n.get('thumb_page_canvas', { page: this.pageId, },\n                    'Thumbnail of Page {{page}}').then((msg) => {\n        this.canvas.setAttribute('aria-label', msg);\n      });\n\n      this.div.setAttribute('data-loaded', true);\n      this.ring.appendChild(this.canvas);\n      return;\n    }\n    let image = document.createElement('img');\n    image.id = id;\n    image.className = className;\n    this.l10n.get('thumb_page_canvas', { page: this.pageId, },\n      'Thumbnail of Page {{page}}').\n        then((msg) => {\n      image.setAttribute('aria-label', msg);\n    });\n\n    image.style.width = this.canvasWidth + 'px';\n    image.style.height = this.canvasHeight + 'px';\n\n    image.src = this.canvas.toDataURL();\n    this.image = image;\n\n    this.div.setAttribute('data-loaded', true);\n    this.ring.appendChild(image);\n\n    // Zeroing the width and height causes Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    this.canvas.width = 0;\n    this.canvas.height = 0;\n    delete this.canvas;\n  }\n\n  draw() {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      console.error('Must be in new state before drawing');\n      return Promise.resolve(undefined);\n    }\n    this.renderingState = RenderingStates.RUNNING;\n\n    let renderCapability = createPromiseCapability();\n    let finishRenderTask = (error) => {\n      // The renderTask may have been replaced by a new one, so only remove\n      // the reference to the renderTask if it matches the one that is\n      // triggering this callback.\n      if (renderTask === this.renderTask) {\n        this.renderTask = null;\n      }\n\n      if (error instanceof RenderingCancelledException) {\n        renderCapability.resolve(undefined);\n        return;\n      }\n\n      this.renderingState = RenderingStates.FINISHED;\n      this._convertCanvasToImage();\n\n      if (!error) {\n        renderCapability.resolve(undefined);\n      } else {\n        renderCapability.reject(error);\n      }\n    };\n\n    let ctx = this._getPageDrawContext();\n    let drawViewport = this.viewport.clone({ scale: this.scale, });\n    let renderContinueCallback = (cont) => {\n      if (!this.renderingQueue.isHighestPriority(this)) {\n        this.renderingState = RenderingStates.PAUSED;\n        this.resume = () => {\n          this.renderingState = RenderingStates.RUNNING;\n          cont();\n        };\n        return;\n      }\n      cont();\n    };\n\n    let renderContext = {\n      canvasContext: ctx,\n      viewport: drawViewport,\n    };\n    let renderTask = this.renderTask = this.pdfPage.render(renderContext);\n    renderTask.onContinue = renderContinueCallback;\n\n    renderTask.promise.then(function() {\n      finishRenderTask(null);\n    }, function(error) {\n      finishRenderTask(error);\n    });\n    return renderCapability.promise;\n  }\n\n  setImage(pageView) {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      return;\n    }\n    let img = pageView.canvas;\n    if (!img) {\n      return;\n    }\n    if (!this.pdfPage) {\n      this.setPdfPage(pageView.pdfPage);\n    }\n\n    this.renderingState = RenderingStates.FINISHED;\n\n    let ctx = this._getPageDrawContext(true);\n    let canvas = ctx.canvas;\n    if (img.width <= 2 * canvas.width) {\n      ctx.drawImage(img, 0, 0, img.width, img.height,\n                    0, 0, canvas.width, canvas.height);\n      this._convertCanvasToImage();\n      return;\n    }\n\n    // drawImage does an awful job of rescaling the image, doing it gradually.\n    let reducedWidth = canvas.width << MAX_NUM_SCALING_STEPS;\n    let reducedHeight = canvas.height << MAX_NUM_SCALING_STEPS;\n    let reducedImage = TempImageFactory.getCanvas(reducedWidth,\n                                                  reducedHeight);\n    let reducedImageCtx = reducedImage.getContext('2d');\n\n    while (reducedWidth > img.width || reducedHeight > img.height) {\n      reducedWidth >>= 1;\n      reducedHeight >>= 1;\n    }\n    reducedImageCtx.drawImage(img, 0, 0, img.width, img.height,\n                              0, 0, reducedWidth, reducedHeight);\n    while (reducedWidth > 2 * canvas.width) {\n      reducedImageCtx.drawImage(reducedImage,\n                                0, 0, reducedWidth, reducedHeight,\n                                0, 0, reducedWidth >> 1, reducedHeight >> 1);\n      reducedWidth >>= 1;\n      reducedHeight >>= 1;\n    }\n    ctx.drawImage(reducedImage, 0, 0, reducedWidth, reducedHeight,\n                  0, 0, canvas.width, canvas.height);\n    this._convertCanvasToImage();\n  }\n\n  get pageId() {\n    return (this.pageLabel !== null ? this.pageLabel : this.id);\n  }\n\n  /**\n   * @param {string|null} label\n   */\n  setPageLabel(label) {\n    this.pageLabel = (typeof label === 'string' ? label : null);\n\n    this.l10n.get('thumb_page_title', { page: this.pageId, },\n                  'Page {{page}}').then((msg) => {\n      this.anchor.title = msg;\n    });\n\n    if (this.renderingState !== RenderingStates.FINISHED) {\n      return;\n    }\n\n    this.l10n.get('thumb_page_canvas', { page: this.pageId, },\n                  'Thumbnail of Page {{page}}').then((ariaLabel) => {\n      if (this.image) {\n        this.image.setAttribute('aria-label', ariaLabel);\n      } else if (this.disableCanvasToImageConversion && this.canvas) {\n        this.canvas.setAttribute('aria-label', ariaLabel);\n      }\n    });\n  }\n\n  static cleanup() {\n    TempImageFactory.destroyCanvas();\n  }\n}\n\nexport {\n  PDFThumbnailView,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseViewer } from './base_viewer';\nimport { shadow } from 'pdfjs-lib';\n\nclass PDFViewer extends BaseViewer {\n  get _setDocumentViewerElement() {\n    return shadow(this, '_setDocumentViewerElement', this.viewer);\n  }\n\n  _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null, }) {\n    if (!pageSpot && !this.isInPresentationMode) {\n      const left = pageDiv.offsetLeft + pageDiv.clientLeft;\n      const right = left + pageDiv.clientWidth;\n      const { scrollLeft, clientWidth, } = this.container;\n      if (this._isScrollModeHorizontal ||\n          left < scrollLeft || right > scrollLeft + clientWidth) {\n        pageSpot = { left: 0, top: 0, };\n      }\n    }\n    super._scrollIntoView({ pageDiv, pageSpot, pageNumber, });\n  }\n\n  _getVisiblePages() {\n    if (this.isInPresentationMode) {\n      // The algorithm in `getVisibleElements` doesn't work in all browsers and\n      // configurations (e.g. Chrome) when Presentation Mode is active.\n      return this._getCurrentVisiblePage();\n    }\n    return super._getVisiblePages();\n  }\n\n  _updateHelper(visiblePages) {\n    if (this.isInPresentationMode) {\n      return;\n    }\n    let currentId = this._currentPageNumber;\n    let stillFullyVisible = false;\n\n    for (const page of visiblePages) {\n      if (page.percent < 100) {\n        break;\n      }\n      if (page.id === currentId) {\n        stillFullyVisible = true;\n        break;\n      }\n    }\n    if (!stillFullyVisible) {\n      currentId = visiblePages[0].id;\n    }\n    this._setCurrentPageNumber(currentId);\n  }\n}\n\nexport {\n  PDFViewer,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AnnotationLayer } from 'pdfjs-lib';\nimport { NullL10n } from './ui_utils';\nimport { SimpleLinkService } from './pdf_link_service';\n\n/**\n * @typedef {Object} AnnotationLayerBuilderOptions\n * @property {HTMLDivElement} pageDiv\n * @property {PDFPage} pdfPage\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderInteractiveForms\n * @property {IPDFLinkService} linkService\n * @property {DownloadManager} downloadManager\n * @property {IL10n} l10n - Localization service.\n */\n\nclass AnnotationLayerBuilder {\n  /**\n   * @param {AnnotationLayerBuilderOptions} options\n   */\n  constructor({ pageDiv, pdfPage, linkService, downloadManager,\n                imageResourcesPath = '', renderInteractiveForms = false,\n                l10n = NullL10n, }) {\n    this.pageDiv = pageDiv;\n    this.pdfPage = pdfPage;\n    this.linkService = linkService;\n    this.downloadManager = downloadManager;\n    this.imageResourcesPath = imageResourcesPath;\n    this.renderInteractiveForms = renderInteractiveForms;\n    this.l10n = l10n;\n\n    this.div = null;\n    this._cancelled = false;\n  }\n\n  /**\n   * @param {PageViewport} viewport\n   * @param {string} intent (default value is 'display')\n   */\n  render(viewport, intent = 'display') {\n    this.pdfPage.getAnnotations({ intent, }).then((annotations) => {\n      if (this._cancelled) {\n        return;\n      }\n\n      let parameters = {\n        viewport: viewport.clone({ dontFlip: true, }),\n        div: this.div,\n        annotations,\n        page: this.pdfPage,\n        imageResourcesPath: this.imageResourcesPath,\n        renderInteractiveForms: this.renderInteractiveForms,\n        linkService: this.linkService,\n        downloadManager: this.downloadManager,\n      };\n\n      if (this.div) {\n        // If an annotationLayer already exists, refresh its children's\n        // transformation matrices.\n        AnnotationLayer.update(parameters);\n      } else {\n        // Create an annotation layer div and render the annotations\n        // if there is at least one annotation.\n        if (annotations.length === 0) {\n          return;\n        }\n        this.div = document.createElement('div');\n        this.div.className = 'annotationLayer';\n        this.pageDiv.appendChild(this.div);\n        parameters.div = this.div;\n\n        AnnotationLayer.render(parameters);\n        this.l10n.translate(this.div);\n      }\n    });\n  }\n\n  cancel() {\n    this._cancelled = true;\n  }\n\n  hide() {\n    if (!this.div) {\n      return;\n    }\n    this.div.setAttribute('hidden', 'true');\n  }\n}\n\n/**\n * @implements IPDFAnnotationLayerFactory\n */\nclass DefaultAnnotationLayerFactory {\n  /**\n   * @param {HTMLDivElement} pageDiv\n   * @param {PDFPage} pdfPage\n   * @param {string} [imageResourcesPath] - Path for image resources, mainly\n   *   for annotation icons. Include trailing slash.\n   * @param {boolean} renderInteractiveForms\n   * @param {IL10n} l10n\n   * @returns {AnnotationLayerBuilder}\n   */\n  createAnnotationLayerBuilder(pageDiv, pdfPage, imageResourcesPath = '',\n                               renderInteractiveForms = false,\n                               l10n = NullL10n) {\n    return new AnnotationLayerBuilder({\n      pageDiv,\n      pdfPage,\n      imageResourcesPath,\n      renderInteractiveForms,\n      linkService: new SimpleLinkService(),\n      l10n,\n    });\n  }\n}\n\nexport {\n  AnnotationLayerBuilder,\n  DefaultAnnotationLayerFactory,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  approximateFraction, CSS_UNITS, DEFAULT_SCALE, getGlobalEventBus,\n  getOutputScale, NullL10n, RendererType, roundToDivide, TextLayerMode\n} from './ui_utils';\nimport {\n  createPromiseCapability, RenderingCancelledException, SVGGraphics\n} from 'pdfjs-lib';\nimport { RenderingStates } from './pdf_rendering_queue';\nimport { viewerCompatibilityParams } from './viewer_compatibility';\n\n/**\n * @typedef {Object} PDFPageViewOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} id - The page unique ID (normally its number).\n * @property {number} scale - The page scale display.\n * @property {PageViewport} defaultViewport - The page viewport.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {IPDFTextLayerFactory} textLayerFactory\n * @property {number} [textLayerMode] - Controls if the text layer used for\n *   selection and searching is created, and if the improved text selection\n *   behaviour is enabled. The constants from {TextLayerMode} should be used.\n *   The default value is `TextLayerMode.ENABLE`.\n * @property {IPDFAnnotationLayerFactory} annotationLayerFactory\n * @property {string} [imageResourcesPath] - Path for image resources, mainly\n *   for annotation icons. Include trailing slash.\n * @property {boolean} renderInteractiveForms - Turns on rendering of\n *   interactive form elements. The default is `false`.\n * @property {string} renderer - 'canvas' or 'svg'. The default is 'canvas'.\n * @property {boolean} [enableWebGL] - Enables WebGL accelerated rendering for\n *   some operations. The default value is `false`.\n * @property {boolean} [useOnlyCssZoom] - Enables CSS only zooming. The default\n *   value is `false`.\n * @property {number} [maxCanvasPixels] - The maximum supported canvas size in\n *   total pixels, i.e. width * height. Use -1 for no limit. The default value\n *   is 4096 * 4096 (16 mega-pixels).\n * @property {IL10n} l10n - Localization service.\n */\n\nconst MAX_CANVAS_PIXELS = viewerCompatibilityParams.maxCanvasPixels || 16777216;\n\n/**\n * @implements {IRenderableView}\n */\nclass PDFPageView {\n  /**\n   * @param {PDFPageViewOptions} options\n   */\n  constructor(options) {\n    let container = options.container;\n    let defaultViewport = options.defaultViewport;\n\n    this.id = options.id;\n    this.renderingId = 'page' + this.id;\n\n    this.pdfPage = null;\n    this.pageLabel = null;\n    this.rotation = 0;\n    this.scale = options.scale || DEFAULT_SCALE;\n    this.viewport = defaultViewport;\n    this.pdfPageRotate = defaultViewport.rotation;\n    this.hasRestrictedScaling = false;\n    this.textLayerMode = Number.isInteger(options.textLayerMode) ?\n      options.textLayerMode : TextLayerMode.ENABLE;\n    this.imageResourcesPath = options.imageResourcesPath || '';\n    this.renderInteractiveForms = options.renderInteractiveForms || false;\n    this.useOnlyCssZoom = options.useOnlyCssZoom || false;\n    this.maxCanvasPixels = options.maxCanvasPixels || MAX_CANVAS_PIXELS;\n\n    this.eventBus = options.eventBus || getGlobalEventBus();\n    this.renderingQueue = options.renderingQueue;\n    this.textLayerFactory = options.textLayerFactory;\n    this.annotationLayerFactory = options.annotationLayerFactory;\n    this.renderer = options.renderer || RendererType.CANVAS;\n    this.enableWebGL = options.enableWebGL || false;\n    this.l10n = options.l10n || NullL10n;\n\n    this.paintTask = null;\n    this.paintedViewportMap = new WeakMap();\n    this.renderingState = RenderingStates.INITIAL;\n    this.resume = null;\n    this.error = null;\n\n    this.annotationLayer = null;\n    this.textLayer = null;\n    this.zoomLayer = null;\n\n    let div = document.createElement('div');\n    div.className = 'page';\n    div.style.width = Math.floor(this.viewport.width) + 'px';\n    div.style.height = Math.floor(this.viewport.height) + 'px';\n    div.setAttribute('data-page-number', this.id);\n    this.div = div;\n\n    container.appendChild(div);\n  }\n\n  setPdfPage(pdfPage) {\n    this.pdfPage = pdfPage;\n    this.pdfPageRotate = pdfPage.rotate;\n\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = pdfPage.getViewport({ scale: this.scale * CSS_UNITS,\n                                          rotation: totalRotation, });\n    this.stats = pdfPage.stats;\n    this.reset();\n  }\n\n  destroy() {\n    this.reset();\n    if (this.pdfPage) {\n      this.pdfPage.cleanup();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _resetZoomLayer(removeFromDOM = false) {\n    if (!this.zoomLayer) {\n      return;\n    }\n    let zoomLayerCanvas = this.zoomLayer.firstChild;\n    this.paintedViewportMap.delete(zoomLayerCanvas);\n    // Zeroing the width and height causes Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    zoomLayerCanvas.width = 0;\n    zoomLayerCanvas.height = 0;\n\n    if (removeFromDOM) {\n      // Note: `ChildNode.remove` doesn't throw if the parent node is undefined.\n      this.zoomLayer.remove();\n    }\n    this.zoomLayer = null;\n  }\n\n  reset(keepZoomLayer = false, keepAnnotations = false) {\n    this.cancelRendering(keepAnnotations);\n    this.renderingState = RenderingStates.INITIAL;\n\n    let div = this.div;\n    div.style.width = Math.floor(this.viewport.width) + 'px';\n    div.style.height = Math.floor(this.viewport.height) + 'px';\n\n    let childNodes = div.childNodes;\n    let currentZoomLayerNode = (keepZoomLayer && this.zoomLayer) || null;\n    let currentAnnotationNode = (keepAnnotations && this.annotationLayer &&\n                                 this.annotationLayer.div) || null;\n    for (let i = childNodes.length - 1; i >= 0; i--) {\n      let node = childNodes[i];\n      if (currentZoomLayerNode === node || currentAnnotationNode === node) {\n        continue;\n      }\n      div.removeChild(node);\n    }\n    div.removeAttribute('data-loaded');\n\n    if (currentAnnotationNode) {\n      // Hide the annotation layer until all elements are resized\n      // so they are not displayed on the already resized page.\n      this.annotationLayer.hide();\n    } else if (this.annotationLayer) {\n      this.annotationLayer.cancel();\n      this.annotationLayer = null;\n    }\n\n    if (!currentZoomLayerNode) {\n      if (this.canvas) {\n        this.paintedViewportMap.delete(this.canvas);\n        // Zeroing the width and height causes Firefox to release graphics\n        // resources immediately, which can greatly reduce memory consumption.\n        this.canvas.width = 0;\n        this.canvas.height = 0;\n        delete this.canvas;\n      }\n      this._resetZoomLayer();\n    }\n    if (this.svg) {\n      this.paintedViewportMap.delete(this.svg);\n      delete this.svg;\n    }\n\n    this.loadingIconDiv = document.createElement('div');\n    this.loadingIconDiv.className = 'loadingIcon';\n    div.appendChild(this.loadingIconDiv);\n  }\n\n  update(scale, rotation) {\n    this.scale = scale || this.scale;\n    if (typeof rotation !== 'undefined') { // The rotation may be zero.\n      this.rotation = rotation;\n    }\n\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = this.viewport.clone({\n      scale: this.scale * CSS_UNITS,\n      rotation: totalRotation,\n    });\n\n    if (this.svg) {\n      this.cssTransform(this.svg, true);\n\n      this.eventBus.dispatch('pagerendered', {\n        source: this,\n        pageNumber: this.id,\n        cssTransform: true,\n        timestamp: performance.now(),\n      });\n      return;\n    }\n\n    let isScalingRestricted = false;\n    if (this.canvas && this.maxCanvasPixels > 0) {\n      let outputScale = this.outputScale;\n      if (((Math.floor(this.viewport.width) * outputScale.sx) | 0) *\n          ((Math.floor(this.viewport.height) * outputScale.sy) | 0) >\n          this.maxCanvasPixels) {\n        isScalingRestricted = true;\n      }\n    }\n\n    if (this.canvas) {\n      if (this.useOnlyCssZoom ||\n          (this.hasRestrictedScaling && isScalingRestricted)) {\n        this.cssTransform(this.canvas, true);\n\n        this.eventBus.dispatch('pagerendered', {\n          source: this,\n          pageNumber: this.id,\n          cssTransform: true,\n          timestamp: performance.now(),\n        });\n        return;\n      }\n      if (!this.zoomLayer && !this.canvas.hasAttribute('hidden')) {\n        this.zoomLayer = this.canvas.parentNode;\n        this.zoomLayer.style.position = 'absolute';\n      }\n    }\n    if (this.zoomLayer) {\n      this.cssTransform(this.zoomLayer.firstChild);\n    }\n    this.reset(/* keepZoomLayer = */ true, /* keepAnnotations = */ true);\n  }\n\n  /**\n   * PLEASE NOTE: Most likely you want to use the `this.reset()` method,\n   *              rather than calling this one directly.\n   */\n  cancelRendering(keepAnnotations = false) {\n    if (this.paintTask) {\n      this.paintTask.cancel();\n      this.paintTask = null;\n    }\n    this.resume = null;\n\n    if (this.textLayer) {\n      this.textLayer.cancel();\n      this.textLayer = null;\n    }\n    if (!keepAnnotations && this.annotationLayer) {\n      this.annotationLayer.cancel();\n      this.annotationLayer = null;\n    }\n  }\n\n  cssTransform(target, redrawAnnotations = false) {\n    // Scale target (canvas or svg), its wrapper and page container.\n    let width = this.viewport.width;\n    let height = this.viewport.height;\n    let div = this.div;\n    target.style.width = target.parentNode.style.width = div.style.width =\n      Math.floor(width) + 'px';\n    target.style.height = target.parentNode.style.height = div.style.height =\n      Math.floor(height) + 'px';\n    // The canvas may have been originally rotated; rotate relative to that.\n    let relativeRotation = this.viewport.rotation -\n                           this.paintedViewportMap.get(target).rotation;\n    let absRotation = Math.abs(relativeRotation);\n    let scaleX = 1, scaleY = 1;\n    if (absRotation === 90 || absRotation === 270) {\n      // Scale x and y because of the rotation.\n      scaleX = height / width;\n      scaleY = width / height;\n    }\n    let cssTransform = 'rotate(' + relativeRotation + 'deg) ' +\n      'scale(' + scaleX + ',' + scaleY + ')';\n    target.style.transform = cssTransform;\n\n    if (this.textLayer) {\n      // Rotating the text layer is more complicated since the divs inside the\n      // the text layer are rotated.\n      // TODO: This could probably be simplified by drawing the text layer in\n      // one orientation and then rotating overall.\n      let textLayerViewport = this.textLayer.viewport;\n      let textRelativeRotation = this.viewport.rotation -\n        textLayerViewport.rotation;\n      let textAbsRotation = Math.abs(textRelativeRotation);\n      let scale = width / textLayerViewport.width;\n      if (textAbsRotation === 90 || textAbsRotation === 270) {\n        scale = width / textLayerViewport.height;\n      }\n      let textLayerDiv = this.textLayer.textLayerDiv;\n      let transX, transY;\n      switch (textAbsRotation) {\n        case 0:\n          transX = transY = 0;\n          break;\n        case 90:\n          transX = 0;\n          transY = '-' + textLayerDiv.style.height;\n          break;\n        case 180:\n          transX = '-' + textLayerDiv.style.width;\n          transY = '-' + textLayerDiv.style.height;\n          break;\n        case 270:\n          transX = '-' + textLayerDiv.style.width;\n          transY = 0;\n          break;\n        default:\n          console.error('Bad rotation value.');\n          break;\n      }\n\n      textLayerDiv.style.transform =\n        'rotate(' + textAbsRotation + 'deg) ' +\n        'scale(' + scale + ', ' + scale + ') ' +\n        'translate(' + transX + ', ' + transY + ')';\n      textLayerDiv.style.transformOrigin = '0% 0%';\n    }\n\n    if (redrawAnnotations && this.annotationLayer) {\n      this.annotationLayer.render(this.viewport, 'display');\n    }\n  }\n\n  get width() {\n    return this.viewport.width;\n  }\n\n  get height() {\n    return this.viewport.height;\n  }\n\n  getPagePoint(x, y) {\n    return this.viewport.convertToPdfPoint(x, y);\n  }\n\n  draw() {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      console.error('Must be in new state before drawing');\n      this.reset(); // Ensure that we reset all state to prevent issues.\n    }\n\n    if (!this.pdfPage) {\n      this.renderingState = RenderingStates.FINISHED;\n      return Promise.reject(new Error('Page is not loaded'));\n    }\n\n    this.renderingState = RenderingStates.RUNNING;\n\n    let pdfPage = this.pdfPage;\n    let div = this.div;\n    // Wrap the canvas so that if it has a CSS transform for high DPI the\n    // overflow will be hidden in Firefox.\n    let canvasWrapper = document.createElement('div');\n    canvasWrapper.style.width = div.style.width;\n    canvasWrapper.style.height = div.style.height;\n    canvasWrapper.classList.add('canvasWrapper');\n\n    if (this.annotationLayer && this.annotationLayer.div) {\n      // The annotation layer needs to stay on top.\n      div.insertBefore(canvasWrapper, this.annotationLayer.div);\n    } else {\n      div.appendChild(canvasWrapper);\n    }\n\n    let textLayer = null;\n    if (this.textLayerMode !== TextLayerMode.DISABLE && this.textLayerFactory) {\n      let textLayerDiv = document.createElement('div');\n      textLayerDiv.className = 'textLayer';\n      textLayerDiv.style.width = canvasWrapper.style.width;\n      textLayerDiv.style.height = canvasWrapper.style.height;\n      if (this.annotationLayer && this.annotationLayer.div) {\n        // The annotation layer needs to stay on top.\n        div.insertBefore(textLayerDiv, this.annotationLayer.div);\n      } else {\n        div.appendChild(textLayerDiv);\n      }\n\n      textLayer = this.textLayerFactory.\n        createTextLayerBuilder(textLayerDiv, this.id - 1, this.viewport,\n            this.textLayerMode === TextLayerMode.ENABLE_ENHANCE);\n    }\n    this.textLayer = textLayer;\n\n    let renderContinueCallback = null;\n    if (this.renderingQueue) {\n      renderContinueCallback = (cont) => {\n        if (!this.renderingQueue.isHighestPriority(this)) {\n          this.renderingState = RenderingStates.PAUSED;\n          this.resume = () => {\n            this.renderingState = RenderingStates.RUNNING;\n            cont();\n          };\n          return;\n        }\n        cont();\n      };\n    }\n\n    const finishPaintTask = async (error) => {\n      // The paintTask may have been replaced by a new one, so only remove\n      // the reference to the paintTask if it matches the one that is\n      // triggering this callback.\n      if (paintTask === this.paintTask) {\n        this.paintTask = null;\n      }\n\n      if (error instanceof RenderingCancelledException) {\n        this.error = null;\n        return;\n      }\n\n      this.renderingState = RenderingStates.FINISHED;\n\n      if (this.loadingIconDiv) {\n        div.removeChild(this.loadingIconDiv);\n        delete this.loadingIconDiv;\n      }\n      this._resetZoomLayer(/* removeFromDOM = */ true);\n\n      this.error = error;\n      this.stats = pdfPage.stats;\n\n      this.eventBus.dispatch('pagerendered', {\n        source: this,\n        pageNumber: this.id,\n        cssTransform: false,\n        timestamp: performance.now(),\n      });\n\n      if (error) {\n        throw error;\n      }\n    };\n\n    let paintTask = this.renderer === RendererType.SVG ?\n      this.paintOnSvg(canvasWrapper) :\n      this.paintOnCanvas(canvasWrapper);\n    paintTask.onRenderContinue = renderContinueCallback;\n    this.paintTask = paintTask;\n\n    let resultPromise = paintTask.promise.then(function() {\n      return finishPaintTask(null).then(function () {\n        if (textLayer) {\n          let readableStream = pdfPage.streamTextContent({\n            normalizeWhitespace: true,\n          });\n          textLayer.setTextContentStream(readableStream);\n          textLayer.render();\n        }\n      });\n    }, function(reason) {\n      return finishPaintTask(reason);\n    });\n\n    if (this.annotationLayerFactory) {\n      if (!this.annotationLayer) {\n        this.annotationLayer = this.annotationLayerFactory.\n          createAnnotationLayerBuilder(div, pdfPage, this.imageResourcesPath,\n                                       this.renderInteractiveForms, this.l10n);\n      }\n      this.annotationLayer.render(this.viewport, 'display');\n    }\n    div.setAttribute('data-loaded', true);\n\n    this.eventBus.dispatch('pagerender', {\n      source: this,\n      pageNumber: this.id,\n    });\n    return resultPromise;\n  }\n\n  paintOnCanvas(canvasWrapper) {\n    let renderCapability = createPromiseCapability();\n    let result = {\n      promise: renderCapability.promise,\n      onRenderContinue(cont) {\n        cont();\n      },\n      cancel() {\n        renderTask.cancel();\n      },\n    };\n\n    let viewport = this.viewport;\n    let canvas = document.createElement('canvas');\n    canvas.id = this.renderingId;\n\n    // Keep the canvas hidden until the first draw callback, or until drawing\n    // is complete when `!this.renderingQueue`, to prevent black flickering.\n    canvas.setAttribute('hidden', 'hidden');\n    let isCanvasHidden = true;\n    let showCanvas = function () {\n      if (isCanvasHidden) {\n        canvas.removeAttribute('hidden');\n        isCanvasHidden = false;\n      }\n    };\n\n    canvasWrapper.appendChild(canvas);\n    this.canvas = canvas;\n\n    if (typeof PDFJSDev === 'undefined' ||\n        PDFJSDev.test('MOZCENTRAL || FIREFOX || GENERIC')) {\n      canvas.mozOpaque = true;\n    }\n\n    let ctx = canvas.getContext('2d', { alpha: false, });\n    let outputScale = getOutputScale(ctx);\n    this.outputScale = outputScale;\n\n    if (this.useOnlyCssZoom) {\n      let actualSizeViewport = viewport.clone({ scale: CSS_UNITS, });\n      // Use a scale that makes the canvas have the originally intended size\n      // of the page.\n      outputScale.sx *= actualSizeViewport.width / viewport.width;\n      outputScale.sy *= actualSizeViewport.height / viewport.height;\n      outputScale.scaled = true;\n    }\n\n    if (this.maxCanvasPixels > 0) {\n      let pixelsInViewport = viewport.width * viewport.height;\n      let maxScale = Math.sqrt(this.maxCanvasPixels / pixelsInViewport);\n      if (outputScale.sx > maxScale || outputScale.sy > maxScale) {\n        outputScale.sx = maxScale;\n        outputScale.sy = maxScale;\n        outputScale.scaled = true;\n        this.hasRestrictedScaling = true;\n      } else {\n        this.hasRestrictedScaling = false;\n      }\n    }\n\n    let sfx = approximateFraction(outputScale.sx);\n    let sfy = approximateFraction(outputScale.sy);\n    canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n    canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n    canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n    canvas.style.height = roundToDivide(viewport.height, sfy[1]) + 'px';\n    // Add the viewport so it's known what it was originally drawn with.\n    this.paintedViewportMap.set(canvas, viewport);\n\n    // Rendering area\n    let transform = !outputScale.scaled ? null :\n      [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n    let renderContext = {\n      canvasContext: ctx,\n      transform,\n      viewport: this.viewport,\n      enableWebGL: this.enableWebGL,\n      renderInteractiveForms: this.renderInteractiveForms,\n    };\n    let renderTask = this.pdfPage.render(renderContext);\n    renderTask.onContinue = function (cont) {\n      showCanvas();\n      if (result.onRenderContinue) {\n        result.onRenderContinue(cont);\n      } else {\n        cont();\n      }\n    };\n\n    renderTask.promise.then(function() {\n      showCanvas();\n      renderCapability.resolve(undefined);\n    }, function(error) {\n      showCanvas();\n      renderCapability.reject(error);\n    });\n    return result;\n  }\n\n  paintOnSvg(wrapper) {\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n      // Return a mock object, to prevent errors such as e.g.\n      // \"TypeError: paintTask.promise is undefined\".\n      return {\n        promise: Promise.reject(new Error('SVG rendering is not supported.')),\n        onRenderContinue(cont) { },\n        cancel() { },\n      };\n    }\n\n    let cancelled = false;\n    let ensureNotCancelled = () => {\n      if (cancelled) {\n        throw new RenderingCancelledException(\n          'Rendering cancelled, page ' + this.id, 'svg');\n      }\n    };\n\n    let pdfPage = this.pdfPage;\n    let actualSizeViewport = this.viewport.clone({ scale: CSS_UNITS, });\n    let promise = pdfPage.getOperatorList().then((opList) => {\n      ensureNotCancelled();\n      let svgGfx = new SVGGraphics(pdfPage.commonObjs, pdfPage.objs);\n      return svgGfx.getSVG(opList, actualSizeViewport).then((svg) => {\n        ensureNotCancelled();\n        this.svg = svg;\n        this.paintedViewportMap.set(svg, actualSizeViewport);\n\n        svg.style.width = wrapper.style.width;\n        svg.style.height = wrapper.style.height;\n        this.renderingState = RenderingStates.FINISHED;\n        wrapper.appendChild(svg);\n      });\n    });\n\n    return {\n      promise,\n      onRenderContinue(cont) {\n        cont();\n      },\n      cancel() {\n        cancelled = true;\n      },\n    };\n  }\n\n  /**\n   * @param {string|null} label\n   */\n  setPageLabel(label) {\n    this.pageLabel = (typeof label === 'string' ? label : null);\n\n    if (this.pageLabel !== null) {\n      this.div.setAttribute('data-page-label', this.pageLabel);\n    } else {\n      this.div.removeAttribute('data-page-label');\n    }\n  }\n}\n\nexport {\n  PDFPageView,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus } from './ui_utils';\nimport { renderTextLayer } from 'pdfjs-lib';\n\nconst EXPAND_DIVS_TIMEOUT = 300; // ms\n\n/**\n * @typedef {Object} TextLayerBuilderOptions\n * @property {HTMLDivElement} textLayerDiv - The text layer container.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} pageIndex - The page index.\n * @property {PageViewport} viewport - The viewport of the text layer.\n * @property {PDFFindController} findController\n * @property {boolean} enhanceTextSelection - Option to turn on improved\n *   text selection.\n */\n\n/**\n * The text layer builder provides text selection functionality for the PDF.\n * It does this by creating overlay divs over the PDF's text. These divs\n * contain text that matches the PDF text they are overlaying. This object\n * also provides a way to highlight text that is being searched for.\n */\nclass TextLayerBuilder {\n  constructor({ textLayerDiv, eventBus, pageIndex, viewport,\n                findController = null, enhanceTextSelection = false, }) {\n    this.textLayerDiv = textLayerDiv;\n    this.eventBus = eventBus || getGlobalEventBus();\n    this.textContent = null;\n    this.textContentItemsStr = [];\n    this.textContentStream = null;\n    this.renderingDone = false;\n    this.pageIdx = pageIndex;\n    this.pageNumber = this.pageIdx + 1;\n    this.matches = [];\n    this.viewport = viewport;\n    this.textDivs = [];\n    this.findController = findController;\n    this.textLayerRenderTask = null;\n    this.enhanceTextSelection = enhanceTextSelection;\n\n    this._onUpdateTextLayerMatches = null;\n    this._bindMouse();\n  }\n\n  /**\n   * @private\n   */\n  _finishRendering() {\n    this.renderingDone = true;\n\n    if (!this.enhanceTextSelection) {\n      let endOfContent = document.createElement('div');\n      endOfContent.className = 'endOfContent';\n      this.textLayerDiv.appendChild(endOfContent);\n    }\n\n    this.eventBus.dispatch('textlayerrendered', {\n      source: this,\n      pageNumber: this.pageNumber,\n      numTextDivs: this.textDivs.length,\n    });\n  }\n\n  /**\n   * Renders the text layer.\n   *\n   * @param {number} [timeout] - Wait for a specified amount of milliseconds\n   *                             before rendering.\n   */\n  render(timeout = 0) {\n    if (!(this.textContent || this.textContentStream) || this.renderingDone) {\n      return;\n    }\n    this.cancel();\n\n    this.textDivs = [];\n    let textLayerFrag = document.createDocumentFragment();\n    this.textLayerRenderTask = renderTextLayer({\n      textContent: this.textContent,\n      textContentStream: this.textContentStream,\n      container: textLayerFrag,\n      viewport: this.viewport,\n      textDivs: this.textDivs,\n      textContentItemsStr: this.textContentItemsStr,\n      timeout,\n      enhanceTextSelection: this.enhanceTextSelection,\n    });\n    this.textLayerRenderTask.promise.then(() => {\n      this.textLayerDiv.appendChild(textLayerFrag);\n      this._finishRendering();\n      this._updateMatches();\n    }, function (reason) {\n      // Cancelled or failed to render text layer; skipping errors.\n    });\n\n    if (!this._onUpdateTextLayerMatches) {\n      this._onUpdateTextLayerMatches = (evt) => {\n        if (evt.pageIndex === this.pageIdx || evt.pageIndex === -1) {\n          this._updateMatches();\n        }\n      };\n      this.eventBus.on('updatetextlayermatches',\n                       this._onUpdateTextLayerMatches);\n    }\n  }\n\n  /**\n   * Cancel rendering of the text layer.\n   */\n  cancel() {\n    if (this.textLayerRenderTask) {\n      this.textLayerRenderTask.cancel();\n      this.textLayerRenderTask = null;\n    }\n    if (this._onUpdateTextLayerMatches) {\n      this.eventBus.off('updatetextlayermatches',\n                        this._onUpdateTextLayerMatches);\n      this._onUpdateTextLayerMatches = null;\n    }\n  }\n\n  setTextContentStream(readableStream) {\n    this.cancel();\n    this.textContentStream = readableStream;\n  }\n\n  setTextContent(textContent) {\n    this.cancel();\n    this.textContent = textContent;\n  }\n\n  _convertMatches(matches, matchesLength) {\n    // Early exit if there is nothing to convert.\n    if (!matches) {\n      return [];\n    }\n    const { findController, textContentItemsStr, } = this;\n\n    let i = 0, iIndex = 0;\n    const end = textContentItemsStr.length - 1;\n    const queryLen = findController.state.query.length;\n    const result = [];\n\n    for (let m = 0, mm = matches.length; m < mm; m++) {\n      // Calculate the start position.\n      let matchIdx = matches[m];\n\n      // Loop over the divIdxs.\n      while (i !== end &&\n             matchIdx >= (iIndex + textContentItemsStr[i].length)) {\n        iIndex += textContentItemsStr[i].length;\n        i++;\n      }\n\n      if (i === textContentItemsStr.length) {\n        console.error('Could not find a matching mapping');\n      }\n\n      let match = {\n        begin: {\n          divIdx: i,\n          offset: matchIdx - iIndex,\n        },\n      };\n\n      // Calculate the end position.\n      if (matchesLength) { // Multiterm search.\n        matchIdx += matchesLength[m];\n      } else { // Phrase search.\n        matchIdx += queryLen;\n      }\n\n      // Somewhat the same array as above, but use > instead of >= to get\n      // the end position right.\n      while (i !== end &&\n             matchIdx > (iIndex + textContentItemsStr[i].length)) {\n        iIndex += textContentItemsStr[i].length;\n        i++;\n      }\n\n      match.end = {\n        divIdx: i,\n        offset: matchIdx - iIndex,\n      };\n      result.push(match);\n    }\n    return result;\n  }\n\n  _renderMatches(matches) {\n    // Early exit if there is nothing to render.\n    if (matches.length === 0) {\n      return;\n    }\n    const { findController, pageIdx, textContentItemsStr, textDivs, } = this;\n\n    const isSelectedPage = (pageIdx === findController.selected.pageIdx);\n    const selectedMatchIdx = findController.selected.matchIdx;\n    const highlightAll = findController.state.highlightAll;\n    let prevEnd = null;\n    let infinity = {\n      divIdx: -1,\n      offset: undefined,\n    };\n\n    function beginText(begin, className) {\n      let divIdx = begin.divIdx;\n      textDivs[divIdx].textContent = '';\n      appendTextToDiv(divIdx, 0, begin.offset, className);\n    }\n\n    function appendTextToDiv(divIdx, fromOffset, toOffset, className) {\n      let div = textDivs[divIdx];\n      let content = textContentItemsStr[divIdx].substring(fromOffset, toOffset);\n      let node = document.createTextNode(content);\n      if (className) {\n        let span = document.createElement('span');\n        span.className = className;\n        span.appendChild(node);\n        div.appendChild(span);\n        return;\n      }\n      div.appendChild(node);\n    }\n\n    let i0 = selectedMatchIdx, i1 = i0 + 1;\n    if (highlightAll) {\n      i0 = 0;\n      i1 = matches.length;\n    } else if (!isSelectedPage) {\n      // Not highlighting all and this isn't the selected page, so do nothing.\n      return;\n    }\n\n    for (let i = i0; i < i1; i++) {\n      let match = matches[i];\n      let begin = match.begin;\n      let end = match.end;\n      const isSelected = (isSelectedPage && i === selectedMatchIdx);\n      const highlightSuffix = (isSelected ? ' selected' : '');\n\n      if (isSelected) { // Attempt to scroll the selected match into view.\n        findController.scrollMatchIntoView({\n          element: textDivs[begin.divIdx],\n          pageIndex: pageIdx,\n          matchIndex: selectedMatchIdx,\n        });\n      }\n\n      // Match inside new div.\n      if (!prevEnd || begin.divIdx !== prevEnd.divIdx) {\n        // If there was a previous div, then add the text at the end.\n        if (prevEnd !== null) {\n          appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n        }\n        // Clear the divs and set the content until the starting point.\n        beginText(begin);\n      } else {\n        appendTextToDiv(prevEnd.divIdx, prevEnd.offset, begin.offset);\n      }\n\n      if (begin.divIdx === end.divIdx) {\n        appendTextToDiv(begin.divIdx, begin.offset, end.offset,\n                        'highlight' + highlightSuffix);\n      } else {\n        appendTextToDiv(begin.divIdx, begin.offset, infinity.offset,\n                        'highlight begin' + highlightSuffix);\n        for (let n0 = begin.divIdx + 1, n1 = end.divIdx; n0 < n1; n0++) {\n          textDivs[n0].className = 'highlight middle' + highlightSuffix;\n        }\n        beginText(end, 'highlight end' + highlightSuffix);\n      }\n      prevEnd = end;\n    }\n\n    if (prevEnd) {\n      appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n    }\n  }\n\n  _updateMatches() {\n    // Only show matches when all rendering is done.\n    if (!this.renderingDone) {\n      return;\n    }\n    const {\n      findController, matches, pageIdx, textContentItemsStr, textDivs,\n    } = this;\n    let clearedUntilDivIdx = -1;\n\n    // Clear all current matches.\n    for (let i = 0, ii = matches.length; i < ii; i++) {\n      let match = matches[i];\n      let begin = Math.max(clearedUntilDivIdx, match.begin.divIdx);\n      for (let n = begin, end = match.end.divIdx; n <= end; n++) {\n        let div = textDivs[n];\n        div.textContent = textContentItemsStr[n];\n        div.className = '';\n      }\n      clearedUntilDivIdx = match.end.divIdx + 1;\n    }\n\n    if (!findController || !findController.highlightMatches) {\n      return;\n    }\n    // Convert the matches on the `findController` into the match format\n    // used for the textLayer.\n    const pageMatches = findController.pageMatches[pageIdx] || null;\n    const pageMatchesLength = findController.pageMatchesLength[pageIdx] || null;\n\n    this.matches = this._convertMatches(pageMatches, pageMatchesLength);\n    this._renderMatches(this.matches);\n  }\n\n  /**\n   * Improves text selection by adding an additional div where the mouse was\n   * clicked. This reduces flickering of the content if the mouse is slowly\n   * dragged up or down.\n   *\n   * @private\n   */\n  _bindMouse() {\n    let div = this.textLayerDiv;\n    let expandDivsTimer = null;\n\n    div.addEventListener('mousedown', (evt) => {\n      if (this.enhanceTextSelection && this.textLayerRenderTask) {\n        this.textLayerRenderTask.expandTextDivs(true);\n        if ((typeof PDFJSDev === 'undefined' ||\n             !PDFJSDev.test('FIREFOX || MOZCENTRAL')) &&\n            expandDivsTimer) {\n          clearTimeout(expandDivsTimer);\n          expandDivsTimer = null;\n        }\n        return;\n      }\n\n      let end = div.querySelector('.endOfContent');\n      if (!end) {\n        return;\n      }\n      if (typeof PDFJSDev === 'undefined' ||\n          !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        // On non-Firefox browsers, the selection will feel better if the height\n        // of the `endOfContent` div is adjusted to start at mouse click\n        // location. This avoids flickering when the selection moves up.\n        // However it does not work when selection is started on empty space.\n        let adjustTop = evt.target !== div;\n        if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n          adjustTop = adjustTop && window.getComputedStyle(end).\n            getPropertyValue('-moz-user-select') !== 'none';\n        }\n        if (adjustTop) {\n          let divBounds = div.getBoundingClientRect();\n          let r = Math.max(0, (evt.pageY - divBounds.top) / divBounds.height);\n          end.style.top = (r * 100).toFixed(2) + '%';\n        }\n      }\n      end.classList.add('active');\n    });\n\n    div.addEventListener('mouseup', () => {\n      if (this.enhanceTextSelection && this.textLayerRenderTask) {\n        if (typeof PDFJSDev === 'undefined' ||\n            !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n          expandDivsTimer = setTimeout(() => {\n            if (this.textLayerRenderTask) {\n              this.textLayerRenderTask.expandTextDivs(false);\n            }\n            expandDivsTimer = null;\n          }, EXPAND_DIVS_TIMEOUT);\n        } else {\n          this.textLayerRenderTask.expandTextDivs(false);\n        }\n        return;\n      }\n\n      let end = div.querySelector('.endOfContent');\n      if (!end) {\n        return;\n      }\n      if (typeof PDFJSDev === 'undefined' ||\n          !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        end.style.top = '';\n      }\n      end.classList.remove('active');\n    });\n  }\n}\n\n/**\n * @implements IPDFTextLayerFactory\n */\nclass DefaultTextLayerFactory {\n  /**\n   * @param {HTMLDivElement} textLayerDiv\n   * @param {number} pageIndex\n   * @param {PageViewport} viewport\n   * @param {boolean} enhanceTextSelection\n   * @returns {TextLayerBuilder}\n   */\n  createTextLayerBuilder(textLayerDiv, pageIndex, viewport,\n                         enhanceTextSelection = false) {\n    return new TextLayerBuilder({\n      textLayerDiv,\n      pageIndex,\n      viewport,\n      enhanceTextSelection,\n    });\n  }\n}\n\nexport {\n  TextLayerBuilder,\n  DefaultTextLayerFactory,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SCROLLBAR_PADDING, ScrollMode, SpreadMode } from './ui_utils';\nimport { CursorTool } from './pdf_cursor_tools';\nimport { PDFSinglePageViewer } from './pdf_single_page_viewer';\n\n/**\n * @typedef {Object} SecondaryToolbarOptions\n * @property {HTMLDivElement} toolbar - Container for the secondary toolbar.\n * @property {HTMLButtonElement} toggleButton - Button to toggle the visibility\n *   of the secondary toolbar.\n * @property {HTMLDivElement} toolbarButtonContainer - Container where all the\n *   toolbar buttons are placed. The maximum height of the toolbar is controlled\n *   dynamically by adjusting the 'max-height' CSS property of this DOM element.\n * @property {HTMLButtonElement} presentationModeButton - Button for entering\n *   presentation mode.\n * @property {HTMLButtonElement} openFileButton - Button to open a file.\n * @property {HTMLButtonElement} printButton - Button to print the document.\n * @property {HTMLButtonElement} downloadButton - Button to download the\n *   document.\n * @property {HTMLLinkElement} viewBookmarkButton - Button to obtain a bookmark\n *   link to the current location in the document.\n * @property {HTMLButtonElement} firstPageButton - Button to go to the first\n *   page in the document.\n * @property {HTMLButtonElement} lastPageButton - Button to go to the last page\n *   in the document.\n * @property {HTMLButtonElement} pageRotateCwButton - Button to rotate the pages\n *   clockwise.\n * @property {HTMLButtonElement} pageRotateCcwButton - Button to rotate the\n *   pages counterclockwise.\n * @property {HTMLButtonElement} cursorSelectToolButton - Button to enable the\n *   select tool.\n * @property {HTMLButtonElement} cursorHandToolButton - Button to enable the\n *   hand tool.\n * @property {HTMLButtonElement} documentPropertiesButton - Button for opening\n *   the document properties dialog.\n */\n\nclass SecondaryToolbar {\n  /**\n   * @param {SecondaryToolbarOptions} options\n   * @param {HTMLDivElement} mainContainer\n   * @param {EventBus} eventBus\n   */\n  constructor(options, mainContainer, eventBus) {\n    this.toolbar = options.toolbar;\n    this.toggleButton = options.toggleButton;\n    this.toolbarButtonContainer = options.toolbarButtonContainer;\n    this.buttons = [\n      { element: options.presentationModeButton, eventName: 'presentationmode',\n        close: true, },\n      { element: options.openFileButton, eventName: 'openfile', close: true, },\n      { element: options.printButton, eventName: 'print', close: true, },\n      { element: options.downloadButton, eventName: 'download', close: true, },\n      { element: options.viewBookmarkButton, eventName: null, close: true, },\n      { element: options.firstPageButton, eventName: 'firstpage',\n        close: true, },\n      { element: options.lastPageButton, eventName: 'lastpage', close: true, },\n      { element: options.pageRotateCwButton, eventName: 'rotatecw',\n        close: false, },\n      { element: options.pageRotateCcwButton, eventName: 'rotateccw',\n        close: false, },\n      { element: options.cursorSelectToolButton, eventName: 'switchcursortool',\n        eventDetails: { tool: CursorTool.SELECT, }, close: true, },\n      { element: options.cursorHandToolButton, eventName: 'switchcursortool',\n        eventDetails: { tool: CursorTool.HAND, }, close: true, },\n      { element: options.scrollVerticalButton, eventName: 'switchscrollmode',\n        eventDetails: { mode: ScrollMode.VERTICAL, }, close: true, },\n      { element: options.scrollHorizontalButton, eventName: 'switchscrollmode',\n        eventDetails: { mode: ScrollMode.HORIZONTAL, }, close: true, },\n      { element: options.scrollWrappedButton, eventName: 'switchscrollmode',\n        eventDetails: { mode: ScrollMode.WRAPPED, }, close: true, },\n      { element: options.spreadNoneButton, eventName: 'switchspreadmode',\n        eventDetails: { mode: SpreadMode.NONE, }, close: true, },\n      { element: options.spreadOddButton, eventName: 'switchspreadmode',\n        eventDetails: { mode: SpreadMode.ODD, }, close: true, },\n      { element: options.spreadEvenButton, eventName: 'switchspreadmode',\n        eventDetails: { mode: SpreadMode.EVEN, }, close: true, },\n      { element: options.documentPropertiesButton,\n        eventName: 'documentproperties', close: true, },\n    ];\n    this.items = {\n      firstPage: options.firstPageButton,\n      lastPage: options.lastPageButton,\n      pageRotateCw: options.pageRotateCwButton,\n      pageRotateCcw: options.pageRotateCcwButton,\n    };\n\n    this.mainContainer = mainContainer;\n    this.eventBus = eventBus;\n\n    this.opened = false;\n    this.containerHeight = null;\n    this.previousContainerHeight = null;\n\n    this.reset();\n\n    // Bind the event listeners for click, cursor tool, and scroll/spread mode\n    // actions.\n    this._bindClickListeners();\n    this._bindCursorToolsListener(options);\n    this._bindScrollModeListener(options);\n    this._bindSpreadModeListener(options);\n\n    // Bind the event listener for adjusting the 'max-height' of the toolbar.\n    this.eventBus.on('resize', this._setMaxHeight.bind(this));\n\n    // Hide the Scroll/Spread mode buttons, when they're not applicable to the\n    // current `BaseViewer` instance (in particular `PDFSinglePageViewer`).\n    this.eventBus.on('baseviewerinit', (evt) => {\n      if (evt.source instanceof PDFSinglePageViewer) {\n        this.toolbarButtonContainer.classList.add('hiddenScrollModeButtons',\n                                                  'hiddenSpreadModeButtons');\n      } else {\n        this.toolbarButtonContainer.classList.remove('hiddenScrollModeButtons',\n                                                     'hiddenSpreadModeButtons');\n      }\n    });\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get isOpen() {\n    return this.opened;\n  }\n\n  setPageNumber(pageNumber) {\n    this.pageNumber = pageNumber;\n    this._updateUIState();\n  }\n\n  setPagesCount(pagesCount) {\n    this.pagesCount = pagesCount;\n    this._updateUIState();\n  }\n\n  reset() {\n    this.pageNumber = 0;\n    this.pagesCount = 0;\n    this._updateUIState();\n\n    // Reset the Scroll/Spread buttons too, since they're document specific.\n    this.eventBus.dispatch('secondarytoolbarreset', { source: this, });\n  }\n\n  _updateUIState() {\n    this.items.firstPage.disabled = (this.pageNumber <= 1);\n    this.items.lastPage.disabled = (this.pageNumber >= this.pagesCount);\n    this.items.pageRotateCw.disabled = this.pagesCount === 0;\n    this.items.pageRotateCcw.disabled = this.pagesCount === 0;\n  }\n\n  _bindClickListeners() {\n    // Button to toggle the visibility of the secondary toolbar.\n    this.toggleButton.addEventListener('click', this.toggle.bind(this));\n\n    // All items within the secondary toolbar.\n    for (let button in this.buttons) {\n      let { element, eventName, close, eventDetails, } = this.buttons[button];\n\n      element.addEventListener('click', (evt) => {\n        if (eventName !== null) {\n          let details = { source: this, };\n          for (let property in eventDetails) {\n            details[property] = eventDetails[property];\n          }\n          this.eventBus.dispatch(eventName, details);\n        }\n        if (close) {\n          this.close();\n        }\n      });\n    }\n  }\n\n  _bindCursorToolsListener(buttons) {\n    this.eventBus.on('cursortoolchanged', function({ tool, }) {\n      buttons.cursorSelectToolButton.classList.toggle('toggled',\n        tool === CursorTool.SELECT);\n      buttons.cursorHandToolButton.classList.toggle('toggled',\n        tool === CursorTool.HAND);\n    });\n  }\n\n  _bindScrollModeListener(buttons) {\n    function scrollModeChanged({ mode, }) {\n      buttons.scrollVerticalButton.classList.toggle('toggled',\n        mode === ScrollMode.VERTICAL);\n      buttons.scrollHorizontalButton.classList.toggle('toggled',\n        mode === ScrollMode.HORIZONTAL);\n      buttons.scrollWrappedButton.classList.toggle('toggled',\n        mode === ScrollMode.WRAPPED);\n\n      // Temporarily *disable* the Spread buttons when horizontal scrolling is\n      // enabled, since the non-default Spread modes doesn't affect the layout.\n      const isScrollModeHorizontal = (mode === ScrollMode.HORIZONTAL);\n      buttons.spreadNoneButton.disabled = isScrollModeHorizontal;\n      buttons.spreadOddButton.disabled = isScrollModeHorizontal;\n      buttons.spreadEvenButton.disabled = isScrollModeHorizontal;\n    }\n    this.eventBus.on('scrollmodechanged', scrollModeChanged);\n\n    this.eventBus.on('secondarytoolbarreset', (evt) => {\n      if (evt.source === this) {\n        scrollModeChanged({ mode: ScrollMode.VERTICAL, });\n      }\n    });\n  }\n\n  _bindSpreadModeListener(buttons) {\n    function spreadModeChanged({ mode, }) {\n      buttons.spreadNoneButton.classList.toggle('toggled',\n        mode === SpreadMode.NONE);\n      buttons.spreadOddButton.classList.toggle('toggled',\n        mode === SpreadMode.ODD);\n      buttons.spreadEvenButton.classList.toggle('toggled',\n        mode === SpreadMode.EVEN);\n    }\n    this.eventBus.on('spreadmodechanged', spreadModeChanged);\n\n    this.eventBus.on('secondarytoolbarreset', (evt) => {\n      if (evt.source === this) {\n        spreadModeChanged({ mode: SpreadMode.NONE, });\n      }\n    });\n  }\n\n  open() {\n    if (this.opened) {\n      return;\n    }\n    this.opened = true;\n    this._setMaxHeight();\n\n    this.toggleButton.classList.add('toggled');\n    this.toolbar.classList.remove('hidden');\n  }\n\n  close() {\n    if (!this.opened) {\n      return;\n    }\n    this.opened = false;\n    this.toolbar.classList.add('hidden');\n    this.toggleButton.classList.remove('toggled');\n  }\n\n  toggle() {\n    if (this.opened) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _setMaxHeight() {\n    if (!this.opened) {\n      return; // Only adjust the 'max-height' if the toolbar is visible.\n    }\n    this.containerHeight = this.mainContainer.clientHeight;\n\n    if (this.containerHeight === this.previousContainerHeight) {\n      return;\n    }\n    this.toolbarButtonContainer.setAttribute('style',\n      'max-height: ' + (this.containerHeight - SCROLLBAR_PADDING) + 'px;');\n\n    this.previousContainerHeight = this.containerHeight;\n  }\n}\n\nexport {\n  SecondaryToolbar,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseViewer } from './base_viewer';\nimport { shadow } from 'pdfjs-lib';\n\nclass PDFSinglePageViewer extends BaseViewer {\n  constructor(options) {\n    super(options);\n\n    this.eventBus.on('pagesinit', (evt) => {\n      // Since the pages are placed in a `DocumentFragment`, make sure that\n      // the current page becomes visible upon loading of the document.\n      this._ensurePageViewVisible();\n    });\n  }\n\n  get _setDocumentViewerElement() {\n    // Since we only want to display *one* page at a time when using the\n    // `PDFSinglePageViewer`, we cannot append them to the `viewer` DOM element.\n    // Instead, they are placed in a `DocumentFragment`, and only the current\n    // page is displayed in the viewer (refer to `this._ensurePageViewVisible`).\n    return shadow(this, '_setDocumentViewerElement', this._shadowViewer);\n  }\n\n  _resetView() {\n    super._resetView();\n    this._previousPageNumber = 1;\n    this._shadowViewer = document.createDocumentFragment();\n    this._updateScrollDown = null;\n  }\n\n  _ensurePageViewVisible() {\n    let pageView = this._pages[this._currentPageNumber - 1];\n    let previousPageView = this._pages[this._previousPageNumber - 1];\n\n    let viewerNodes = this.viewer.childNodes;\n    switch (viewerNodes.length) {\n      case 0: // Should *only* occur on initial loading.\n        this.viewer.appendChild(pageView.div);\n        break;\n      case 1: // The normal page-switching case.\n        if (viewerNodes[0] !== previousPageView.div) {\n          throw new Error(\n            '_ensurePageViewVisible: Unexpected previously visible page.');\n        }\n        if (pageView === previousPageView) {\n          break; // The correct page is already visible.\n        }\n        // Switch visible pages, and reset the viewerContainer scroll position.\n        this._shadowViewer.appendChild(previousPageView.div);\n        this.viewer.appendChild(pageView.div);\n\n        this.container.scrollTop = 0;\n        break;\n      default:\n        throw new Error(\n          '_ensurePageViewVisible: Only one page should be visible at a time.');\n    }\n    this._previousPageNumber = this._currentPageNumber;\n  }\n\n  _scrollUpdate() {\n    if (this._updateScrollDown) {\n      this._updateScrollDown();\n    }\n    super._scrollUpdate();\n  }\n\n  _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null, }) {\n    if (pageNumber) { // Ensure that `this._currentPageNumber` is correct.\n      this._setCurrentPageNumber(pageNumber);\n    }\n    const scrolledDown = this._currentPageNumber >= this._previousPageNumber;\n\n    this._ensurePageViewVisible();\n    // Ensure that rendering always occurs, to avoid showing a blank page,\n    // even if the current position doesn't change when the page is scrolled.\n    this.update();\n\n    super._scrollIntoView({ pageDiv, pageSpot, pageNumber, });\n\n    // Since scrolling is tracked using `requestAnimationFrame`, update the\n    // scroll direction during the next `this._scrollUpdate` invocation.\n    this._updateScrollDown = () => {\n      this.scroll.down = scrolledDown;\n      this._updateScrollDown = null;\n    };\n  }\n\n  _getVisiblePages() {\n    return this._getCurrentVisiblePage();\n  }\n\n  _updateHelper(visiblePages) { }\n\n  get _isScrollModeHorizontal() {\n    // The Scroll/Spread modes are never used in `PDFSinglePageViewer`.\n    return shadow(this, '_isScrollModeHorizontal', false);\n  }\n\n  _updateScrollMode() { }\n\n  _updateSpreadMode() { }\n}\n\nexport {\n  PDFSinglePageViewer,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  animationStarted, DEFAULT_SCALE, DEFAULT_SCALE_VALUE, MAX_SCALE,\n  MIN_SCALE, noContextMenuHandler, NullL10n\n} from './ui_utils';\n\nconst PAGE_NUMBER_LOADING_INDICATOR = 'visiblePageIsLoading';\nconst SCALE_SELECT_CONTAINER_PADDING = 8;\nconst SCALE_SELECT_PADDING = 22;\n\n/**\n * @typedef {Object} ToolbarOptions\n * @property {HTMLDivElement} container - Container for the secondary toolbar.\n * @property {HTMLSpanElement} numPages - Label that contains number of pages.\n * @property {HTMLInputElement} pageNumber - Control for display and user input\n *   of the current page number.\n * @property {HTMLSpanElement} scaleSelectContainer - Container where scale\n *   controls are placed. The width is adjusted on UI initialization.\n * @property {HTMLSelectElement} scaleSelect - Scale selection control.\n * @property {HTMLOptionElement} customScaleOption - The item used to display\n *   a non-predefined scale.\n * @property {HTMLButtonElement} previous - Button to go to the previous page.\n * @property {HTMLButtonElement} next - Button to go to the next page.\n * @property {HTMLButtonElement} zoomIn - Button to zoom in the pages.\n * @property {HTMLButtonElement} zoomOut - Button to zoom out the pages.\n * @property {HTMLButtonElement} viewFind - Button to open find bar.\n * @property {HTMLButtonElement} openFile - Button to open a new document.\n * @property {HTMLButtonElement} presentationModeButton - Button to switch to\n *   presentation mode.\n * @property {HTMLButtonElement} download - Button to download the document.\n * @property {HTMLAElement} viewBookmark - Element to link current url of\n *   the page view.\n */\n\nclass Toolbar {\n  /**\n   * @param {ToolbarOptions} options\n   * @param {EventBus} eventBus\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor(options, eventBus, l10n = NullL10n) {\n    this.toolbar = options.container;\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n    this.items = options;\n\n    this._wasLocalized = false;\n    this.reset();\n\n    // Bind the event listeners for click and hand tool actions.\n    this._bindListeners();\n  }\n\n  setPageNumber(pageNumber, pageLabel) {\n    this.pageNumber = pageNumber;\n    this.pageLabel = pageLabel;\n    this._updateUIState(false);\n  }\n\n  setPagesCount(pagesCount, hasPageLabels) {\n    this.pagesCount = pagesCount;\n    this.hasPageLabels = hasPageLabels;\n    this._updateUIState(true);\n  }\n\n  setPageScale(pageScaleValue, pageScale) {\n    this.pageScaleValue = (pageScaleValue || pageScale).toString();\n    this.pageScale = pageScale;\n    this._updateUIState(false);\n  }\n\n  reset() {\n    this.pageNumber = 0;\n    this.pageLabel = null;\n    this.hasPageLabels = false;\n    this.pagesCount = 0;\n    this.pageScaleValue = DEFAULT_SCALE_VALUE;\n    this.pageScale = DEFAULT_SCALE;\n    this._updateUIState(true);\n    this.updateLoadingIndicatorState();\n  }\n\n  _bindListeners() {\n    let { eventBus, items, } = this;\n    let self = this;\n\n    items.previous.addEventListener('click', function() {\n      eventBus.dispatch('previouspage', { source: self, });\n    });\n\n    items.next.addEventListener('click', function() {\n      eventBus.dispatch('nextpage', { source: self, });\n    });\n\n    items.zoomIn.addEventListener('click', function() {\n      eventBus.dispatch('zoomin', { source: self, });\n    });\n\n    items.zoomOut.addEventListener('click', function() {\n      eventBus.dispatch('zoomout', { source: self, });\n    });\n\n    items.pageNumber.addEventListener('click', function() {\n      this.select();\n    });\n\n    items.pageNumber.addEventListener('change', function() {\n      eventBus.dispatch('pagenumberchanged', {\n        source: self,\n        value: this.value,\n      });\n    });\n\n    items.scaleSelect.addEventListener('change', function() {\n      if (this.value === 'custom') {\n        return;\n      }\n      eventBus.dispatch('scalechanged', {\n        source: self,\n        value: this.value,\n      });\n    });\n\n    items.presentationModeButton.addEventListener('click', function() {\n      eventBus.dispatch('presentationmode', { source: self, });\n    });\n\n    items.openFile.addEventListener('click', function() {\n      eventBus.dispatch('openfile', { source: self, });\n    });\n\n    items.print.addEventListener('click', function() {\n      eventBus.dispatch('print', { source: self, });\n    });\n\n    items.download.addEventListener('click', function() {\n      eventBus.dispatch('download', { source: self, });\n    });\n\n    // Suppress context menus for some controls.\n    items.scaleSelect.oncontextmenu = noContextMenuHandler;\n\n    eventBus.on('localized', () => {\n      this._localized();\n    });\n  }\n\n  _localized() {\n    this._wasLocalized = true;\n    this._adjustScaleWidth();\n    this._updateUIState(true);\n  }\n\n  _updateUIState(resetNumPages = false) {\n    if (!this._wasLocalized) {\n      // Don't update the UI state until we localize the toolbar.\n      return;\n    }\n    const { pageNumber, pagesCount, pageScaleValue, pageScale, items, } = this;\n\n    if (resetNumPages) {\n      if (this.hasPageLabels) {\n        items.pageNumber.type = 'text';\n      } else {\n        items.pageNumber.type = 'number';\n        this.l10n.get('of_pages', { pagesCount, }, 'of {{pagesCount}}').\n            then((msg) => {\n          items.numPages.textContent = msg;\n        });\n      }\n      items.pageNumber.max = pagesCount;\n    }\n\n    if (this.hasPageLabels) {\n      items.pageNumber.value = this.pageLabel;\n      this.l10n.get('page_of_pages', { pageNumber, pagesCount, },\n                    '({{pageNumber}} of {{pagesCount}})').then((msg) => {\n        items.numPages.textContent = msg;\n      });\n    } else {\n      items.pageNumber.value = pageNumber;\n    }\n\n    items.previous.disabled = (pageNumber <= 1);\n    items.next.disabled = (pageNumber >= pagesCount);\n\n    items.zoomOut.disabled = (pageScale <= MIN_SCALE);\n    items.zoomIn.disabled = (pageScale >= MAX_SCALE);\n\n    let customScale = Math.round(pageScale * 10000) / 100;\n    this.l10n.get('page_scale_percent', { scale: customScale, },\n                  '{{scale}}%').then((msg) => {\n      let options = items.scaleSelect.options;\n      let predefinedValueFound = false;\n      for (let i = 0, ii = options.length; i < ii; i++) {\n        let option = options[i];\n        if (option.value !== pageScaleValue) {\n          option.selected = false;\n          continue;\n        }\n        option.selected = true;\n        predefinedValueFound = true;\n      }\n      if (!predefinedValueFound) {\n        items.customScaleOption.textContent = msg;\n        items.customScaleOption.selected = true;\n      }\n    });\n  }\n\n  updateLoadingIndicatorState(loading = false) {\n    let pageNumberInput = this.items.pageNumber;\n\n    pageNumberInput.classList.toggle(PAGE_NUMBER_LOADING_INDICATOR, loading);\n  }\n\n  _adjustScaleWidth() {\n    let container = this.items.scaleSelectContainer;\n    let select = this.items.scaleSelect;\n\n    animationStarted.then(function() {\n      // Adjust the width of the zoom box to fit the content.\n      // Note: If the window is narrow enough that the zoom box is not\n      //       visible, we temporarily show it to be able to adjust its width.\n      if (container.clientWidth === 0) {\n        container.setAttribute('style', 'display: inherit;');\n      }\n      if (container.clientWidth > 0) {\n        select.setAttribute('style', 'min-width: inherit;');\n        let width = select.clientWidth + SCALE_SELECT_CONTAINER_PADDING;\n        select.setAttribute('style', 'min-width: ' +\n                                     (width + SCALE_SELECT_PADDING) + 'px;');\n        container.setAttribute('style', 'min-width: ' + width + 'px; ' +\n                                        'max-width: ' + width + 'px;');\n      }\n    });\n  }\n}\n\nexport {\n  Toolbar,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEFAULT_VIEW_HISTORY_CACHE_SIZE = 20;\n\n/**\n * View History - This is a utility for saving various view parameters for\n *                recently opened files.\n *\n * The way that the view parameters are stored depends on how PDF.js is built,\n * for 'gulp <flag>' the following cases exist:\n *  - FIREFOX or MOZCENTRAL - uses sessionStorage.\n *  - GENERIC or CHROME     - uses localStorage, if it is available.\n */\nclass ViewHistory {\n  constructor(fingerprint, cacheSize = DEFAULT_VIEW_HISTORY_CACHE_SIZE) {\n    this.fingerprint = fingerprint;\n    this.cacheSize = cacheSize;\n\n    this._initializedPromise = this._readFromStorage().then((databaseStr) => {\n      let database = JSON.parse(databaseStr || '{}');\n      if (!('files' in database)) {\n        database.files = [];\n      } else {\n        while (database.files.length >= this.cacheSize) {\n          database.files.shift();\n        }\n      }\n      let index = -1;\n      for (let i = 0, length = database.files.length; i < length; i++) {\n        let branch = database.files[i];\n        if (branch.fingerprint === this.fingerprint) {\n          index = i;\n          break;\n        }\n      }\n      if (index === -1) {\n        index = database.files.push({ fingerprint: this.fingerprint, }) - 1;\n      }\n      this.file = database.files[index];\n      this.database = database;\n    });\n  }\n\n  async _writeToStorage() {\n    let databaseStr = JSON.stringify(this.database);\n\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      sessionStorage.setItem('pdfjs.history', databaseStr);\n      return;\n    }\n    localStorage.setItem('pdfjs.history', databaseStr);\n  }\n\n  async _readFromStorage() {\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      return sessionStorage.getItem('pdfjs.history');\n    }\n    return localStorage.getItem('pdfjs.history');\n  }\n\n  async set(name, val) {\n    await this._initializedPromise;\n    this.file[name] = val;\n    return this._writeToStorage();\n  }\n\n  async setMultiple(properties) {\n    await this._initializedPromise;\n    for (let name in properties) {\n      this.file[name] = properties[name];\n    }\n    return this._writeToStorage();\n  }\n\n  async get(name, defaultValue) {\n    await this._initializedPromise;\n    let val = this.file[name];\n    return val !== undefined ? val : defaultValue;\n  }\n\n  async getMultiple(properties) {\n    await this._initializedPromise;\n    let values = Object.create(null);\n\n    for (let name in properties) {\n      let val = this.file[name];\n      values[name] = val !== undefined ? val : properties[name];\n    }\n    return values;\n  }\n}\n\nexport {\n  ViewHistory,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DefaultExternalServices, PDFViewerApplication } from './app';\nimport { BasePreferences } from './preferences';\nimport { DownloadManager } from './download_manager';\nimport { GenericL10n } from './genericl10n';\n\nif (typeof PDFJSDev !== 'undefined' && !PDFJSDev.test('GENERIC')) {\n  throw new Error('Module \"pdfjs-web/genericcom\" shall not be used outside ' +\n                  'GENERIC build.');\n}\n\nlet GenericCom = {};\n\nclass GenericPreferences extends BasePreferences {\n  async _writeToStorage(prefObj) {\n    localStorage.setItem('pdfjs.preferences', JSON.stringify(prefObj));\n  }\n\n  async _readFromStorage(prefObj) {\n    return JSON.parse(localStorage.getItem('pdfjs.preferences'));\n  }\n}\n\nlet GenericExternalServices = Object.create(DefaultExternalServices);\nGenericExternalServices.createDownloadManager = function(options) {\n  return new DownloadManager(options);\n};\nGenericExternalServices.createPreferences = function() {\n  return new GenericPreferences();\n};\nGenericExternalServices.createL10n = function({ locale = 'en-US', }) {\n  return new GenericL10n(locale);\n};\nPDFViewerApplication.externalServices = GenericExternalServices;\n\nexport {\n  GenericCom,\n};\n","/* Copyright 2013 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet defaultPreferences = null;\nfunction getDefaultPreferences() {\n  if (!defaultPreferences) {\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('PRODUCTION')) {\n      defaultPreferences = Promise.resolve(\n        PDFJSDev.json('$ROOT/build/default_preferences.json'));\n    } else {\n      defaultPreferences = new Promise(function(resolve, reject) {\n        if (typeof SystemJS === 'object') {\n          SystemJS.import('./app_options').then(resolve, reject);\n        } else if (typeof require === 'function') {\n          try {\n            resolve(require('./app_options.js'));\n          } catch (ex) {\n            reject(ex);\n          }\n        } else {\n          reject(new Error(\n            'SystemJS or CommonJS must be used to load AppOptions.'));\n        }\n      }).then(function({ AppOptions, OptionKind, }) {\n        return AppOptions.getAll(OptionKind.PREFERENCE);\n      });\n    }\n  }\n  return defaultPreferences;\n}\n\n/**\n * BasePreferences - Abstract base class for storing persistent settings.\n *   Used for settings that should be applied to all opened documents,\n *   or every time the viewer is loaded.\n */\nclass BasePreferences {\n  constructor() {\n    if (this.constructor === BasePreferences) {\n      throw new Error('Cannot initialize BasePreferences.');\n    }\n    this.prefs = null;\n\n    this._initializedPromise = getDefaultPreferences().then((defaults) => {\n      Object.defineProperty(this, 'defaults', {\n        value: Object.freeze(defaults),\n        writable: false,\n        enumerable: true,\n        configurable: false,\n      });\n\n      this.prefs = Object.assign(Object.create(null), defaults);\n      return this._readFromStorage(defaults);\n    }).then((prefs) => {\n      if (!prefs) {\n        return;\n      }\n      for (let name in prefs) {\n        const defaultValue = this.defaults[name], prefValue = prefs[name];\n        // Ignore preferences not present in, or whose types don't match,\n        // the default values.\n        if (defaultValue === undefined ||\n            typeof prefValue !== typeof defaultValue) {\n          continue;\n        }\n        this.prefs[name] = prefValue;\n      }\n    });\n  }\n\n  /**\n   * Stub function for writing preferences to storage.\n   * @param {Object} prefObj The preferences that should be written to storage.\n   * @returns {Promise} A promise that is resolved when the preference values\n   *                    have been written.\n   */\n  async _writeToStorage(prefObj) {\n    throw new Error('Not implemented: _writeToStorage');\n  }\n\n  /**\n   * Stub function for reading preferences from storage.\n   * @param {Object} prefObj The preferences that should be read from storage.\n   * @returns {Promise} A promise that is resolved with an {Object} containing\n   *                    the preferences that have been read.\n   */\n  async _readFromStorage(prefObj) {\n    throw new Error('Not implemented: _readFromStorage');\n  }\n\n  /**\n   * Reset the preferences to their default values and update storage.\n   * @returns {Promise} A promise that is resolved when the preference values\n   *                    have been reset.\n   */\n  async reset() {\n    await this._initializedPromise;\n    this.prefs = Object.assign(Object.create(null), this.defaults);\n    return this._writeToStorage(this.defaults);\n  }\n\n  /**\n   * Set the value of a preference.\n   * @param {string} name The name of the preference that should be changed.\n   * @param {boolean|number|string} value The new value of the preference.\n   * @returns {Promise} A promise that is resolved when the value has been set,\n   *                    provided that the preference exists and the types match.\n   */\n  async set(name, value) {\n    await this._initializedPromise;\n    let defaultValue = this.defaults[name];\n\n    if (defaultValue === undefined) {\n      throw new Error(`Set preference: \"${name}\" is undefined.`);\n    } else if (value === undefined) {\n      throw new Error('Set preference: no value is specified.');\n    }\n    let valueType = typeof value;\n    let defaultType = typeof defaultValue;\n\n    if (valueType !== defaultType) {\n      if (valueType === 'number' && defaultType === 'string') {\n        value = value.toString();\n      } else {\n        throw new Error(`Set preference: \"${value}\" is a ${valueType}, ` +\n                        `expected a ${defaultType}.`);\n      }\n    } else {\n      if (valueType === 'number' && !Number.isInteger(value)) {\n        throw new Error(`Set preference: \"${value}\" must be an integer.`);\n      }\n    }\n    this.prefs[name] = value;\n    return this._writeToStorage(this.prefs);\n  }\n\n  /**\n   * Get the value of a preference.\n   * @param {string} name The name of the preference whose value is requested.\n   * @returns {Promise} A promise resolved with a {boolean|number|string}\n   *                    containing the value of the preference.\n   */\n  async get(name) {\n    await this._initializedPromise;\n    let defaultValue = this.defaults[name];\n\n    if (defaultValue === undefined) {\n      throw new Error(`Get preference: \"${name}\" is undefined.`);\n    } else {\n      let prefValue = this.prefs[name];\n\n      if (prefValue !== undefined) {\n        return prefValue;\n      }\n    }\n    return defaultValue;\n  }\n\n  /**\n   * Get the values of all preferences.\n   * @returns {Promise} A promise that is resolved with an {Object} containing\n   *                    the values of all preferences.\n   */\n  async getAll() {\n    await this._initializedPromise;\n    return Object.assign(Object.create(null), this.defaults, this.prefs);\n  }\n}\n\nexport {\n  BasePreferences,\n};\n","/* Copyright 2013 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  apiCompatibilityParams, createObjectURL, createValidAbsoluteUrl\n} from 'pdfjs-lib';\n\nif (typeof PDFJSDev !== 'undefined' && !PDFJSDev.test('CHROME || GENERIC')) {\n  throw new Error('Module \"pdfjs-web/download_manager\" shall not be used ' +\n                  'outside CHROME and GENERIC builds.');\n}\n\nconst DISABLE_CREATE_OBJECT_URL =\n  apiCompatibilityParams.disableCreateObjectURL || false;\n\nfunction download(blobUrl, filename) {\n  let a = document.createElement('a');\n  if (!a.click) {\n    throw new Error('DownloadManager: \"a.click()\" is not supported.');\n  }\n  a.href = blobUrl;\n  a.target = '_parent';\n  // Use a.download if available. This increases the likelihood that\n  // the file is downloaded instead of opened by another PDF plugin.\n  if ('download' in a) {\n    a.download = filename;\n  }\n  // <a> must be in the document for IE and recent Firefox versions,\n  // otherwise .click() is ignored.\n  (document.body || document.documentElement).appendChild(a);\n  a.click();\n  a.remove();\n}\n\nclass DownloadManager {\n  constructor({ disableCreateObjectURL = DISABLE_CREATE_OBJECT_URL, }) {\n    this.disableCreateObjectURL = disableCreateObjectURL;\n  }\n\n  downloadUrl(url, filename) {\n    if (!createValidAbsoluteUrl(url, 'http://example.com')) {\n      return; // restricted/invalid URL\n    }\n    download(url + '#pdfjs.action=download', filename);\n  }\n\n  downloadData(data, filename, contentType) {\n    if (navigator.msSaveBlob) { // IE10 and above\n      navigator.msSaveBlob(new Blob([data], { type: contentType, }), filename);\n      return;\n    }\n    let blobUrl = createObjectURL(data, contentType,\n                                  this.disableCreateObjectURL);\n    download(blobUrl, filename);\n  }\n\n  download(blob, url, filename) {\n    if (navigator.msSaveBlob) {\n      // IE10 / IE11\n      if (!navigator.msSaveBlob(blob, filename)) {\n        this.downloadUrl(url, filename);\n      }\n      return;\n    }\n\n    if (this.disableCreateObjectURL) {\n      // URL.createObjectURL is not supported\n      this.downloadUrl(url, filename);\n      return;\n    }\n\n    let blobUrl = URL.createObjectURL(blob);\n    download(blobUrl, filename);\n  }\n}\n\nexport {\n  DownloadManager,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport '../external/webL10n/l10n';\n\nlet webL10n = document.webL10n;\n\nclass GenericL10n {\n  constructor(lang) {\n    this._lang = lang;\n    this._ready = new Promise((resolve, reject) => {\n      webL10n.setLanguage(lang, () => {\n        resolve(webL10n);\n      });\n    });\n  }\n\n  async getLanguage() {\n    const l10n = await this._ready;\n    return l10n.getLanguage();\n  }\n\n  async getDirection() {\n    const l10n = await this._ready;\n    return l10n.getDirection();\n  }\n\n  async get(property, args, fallback) {\n    const l10n = await this._ready;\n    return l10n.get(property, args, fallback);\n  }\n\n  async translate(element) {\n    const l10n = await this._ready;\n    return l10n.translate(element);\n  }\n}\n\nexport {\n  GenericL10n,\n};\n","/**\n * Copyright (c) 2011-2013 Fabien Cazenave, Mozilla.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to\n * deal in the Software without restriction, including without limitation the\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n * sell copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n * IN THE SOFTWARE.\n */\n/*\n  Additional modifications for PDF.js project:\n    - Disables language initialization on page loading.\n    - Disables document translation on page loading.\n    - Removes consoleWarn and consoleLog and use console.log/warn directly.\n    - Removes window._ assignment.\n    - Remove compatibility code for OldIE.\n    - Replaces `String.prototype.substr()` with `String.prototype.substring()`.\n    - Removes `fireL10nReadyEvent` since the \"localized\" event it dispatches\n      is unused and may clash with an identically named event in the viewer.\n*/\n\n/*jshint browser: true, devel: true, es5: true, globalstrict: true */\n'use strict';\n\ndocument.webL10n = (function(window, document, undefined) {\n  var gL10nData = {};\n  var gTextData = '';\n  var gTextProp = 'textContent';\n  var gLanguage = '';\n  var gMacros = {};\n  var gReadyState = 'loading';\n\n\n  /**\n   * Synchronously loading l10n resources significantly minimizes flickering\n   * from displaying the app with non-localized strings and then updating the\n   * strings. Although this will block all script execution on this page, we\n   * expect that the l10n resources are available locally on flash-storage.\n   *\n   * As synchronous XHR is generally considered as a bad idea, we're still\n   * loading l10n resources asynchronously -- but we keep this in a setting,\n   * just in case... and applications using this library should hide their\n   * content until the `localized' event happens.\n   */\n\n  var gAsyncResourceLoading = true; // read-only\n\n\n  /**\n   * DOM helpers for the so-called \"HTML API\".\n   *\n   * These functions are written for modern browsers. For old versions of IE,\n   * they're overridden in the 'startup' section at the end of this file.\n   */\n\n  function getL10nResourceLinks() {\n    return document.querySelectorAll('link[type=\"application/l10n\"]');\n  }\n\n  function getL10nDictionary() {\n    var script = document.querySelector('script[type=\"application/l10n\"]');\n    // TODO: support multiple and external JSON dictionaries\n    return script ? JSON.parse(script.innerHTML) : null;\n  }\n\n  function getTranslatableChildren(element) {\n    return element ? element.querySelectorAll('*[data-l10n-id]') : [];\n  }\n\n  function getL10nAttributes(element) {\n    if (!element)\n      return {};\n\n    var l10nId = element.getAttribute('data-l10n-id');\n    var l10nArgs = element.getAttribute('data-l10n-args');\n    var args = {};\n    if (l10nArgs) {\n      try {\n        args = JSON.parse(l10nArgs);\n      } catch (e) {\n        console.warn('could not parse arguments for #' + l10nId);\n      }\n    }\n    return { id: l10nId, args: args };\n  }\n\n  function xhrLoadText(url, onSuccess, onFailure) {\n    onSuccess = onSuccess || function _onSuccess(data) {};\n    onFailure = onFailure || function _onFailure() {};\n\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', url, gAsyncResourceLoading);\n    if (xhr.overrideMimeType) {\n      xhr.overrideMimeType('text/plain; charset=utf-8');\n    }\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState == 4) {\n        if (xhr.status == 200 || xhr.status === 0) {\n          onSuccess(xhr.responseText);\n        } else {\n          onFailure();\n        }\n      }\n    };\n    xhr.onerror = onFailure;\n    xhr.ontimeout = onFailure;\n\n    // in Firefox OS with the app:// protocol, trying to XHR a non-existing\n    // URL will raise an exception here -- hence this ugly try...catch.\n    try {\n      xhr.send(null);\n    } catch (e) {\n      onFailure();\n    }\n  }\n\n\n  /**\n   * l10n resource parser:\n   *  - reads (async XHR) the l10n resource matching `lang';\n   *  - imports linked resources (synchronously) when specified;\n   *  - parses the text data (fills `gL10nData' and `gTextData');\n   *  - triggers success/failure callbacks when done.\n   *\n   * @param {string} href\n   *    URL of the l10n resource to parse.\n   *\n   * @param {string} lang\n   *    locale (language) to parse. Must be a lowercase string.\n   *\n   * @param {Function} successCallback\n   *    triggered when the l10n resource has been successfully parsed.\n   *\n   * @param {Function} failureCallback\n   *    triggered when the an error has occurred.\n   *\n   * @return {void}\n   *    uses the following global variables: gL10nData, gTextData, gTextProp.\n   */\n\n  function parseResource(href, lang, successCallback, failureCallback) {\n    var baseURL = href.replace(/[^\\/]*$/, '') || './';\n\n    // handle escaped characters (backslashes) in a string\n    function evalString(text) {\n      if (text.lastIndexOf('\\\\') < 0)\n        return text;\n      return text.replace(/\\\\\\\\/g, '\\\\')\n                 .replace(/\\\\n/g, '\\n')\n                 .replace(/\\\\r/g, '\\r')\n                 .replace(/\\\\t/g, '\\t')\n                 .replace(/\\\\b/g, '\\b')\n                 .replace(/\\\\f/g, '\\f')\n                 .replace(/\\\\{/g, '{')\n                 .replace(/\\\\}/g, '}')\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/\\\\'/g, \"'\");\n    }\n\n    // parse *.properties text data into an l10n dictionary\n    // If gAsyncResourceLoading is false, then the callback will be called\n    // synchronously. Otherwise it is called asynchronously.\n    function parseProperties(text, parsedPropertiesCallback) {\n      var dictionary = {};\n\n      // token expressions\n      var reBlank = /^\\s*|\\s*$/;\n      var reComment = /^\\s*#|^\\s*$/;\n      var reSection = /^\\s*\\[(.*)\\]\\s*$/;\n      var reImport = /^\\s*@import\\s+url\\((.*)\\)\\s*$/i;\n      var reSplit = /^([^=\\s]*)\\s*=\\s*(.+)$/; // TODO: escape EOLs with '\\'\n\n      // parse the *.properties file into an associative array\n      function parseRawLines(rawText, extendedSyntax, parsedRawLinesCallback) {\n        var entries = rawText.replace(reBlank, '').split(/[\\r\\n]+/);\n        var currentLang = '*';\n        var genericLang = lang.split('-', 1)[0];\n        var skipLang = false;\n        var match = '';\n\n        function nextEntry() {\n          // Use infinite loop instead of recursion to avoid reaching the\n          // maximum recursion limit for content with many lines.\n          while (true) {\n            if (!entries.length) {\n              parsedRawLinesCallback();\n              return;\n            }\n            var line = entries.shift();\n\n            // comment or blank line?\n            if (reComment.test(line))\n              continue;\n\n            // the extended syntax supports [lang] sections and @import rules\n            if (extendedSyntax) {\n              match = reSection.exec(line);\n              if (match) { // section start?\n                // RFC 4646, section 4.4, \"All comparisons MUST be performed\n                // in a case-insensitive manner.\"\n\n                currentLang = match[1].toLowerCase();\n                skipLang = (currentLang !== '*') &&\n                    (currentLang !== lang) && (currentLang !== genericLang);\n                continue;\n              } else if (skipLang) {\n                continue;\n              }\n              match = reImport.exec(line);\n              if (match) { // @import rule?\n                loadImport(baseURL + match[1], nextEntry);\n                return;\n              }\n            }\n\n            // key-value pair\n            var tmp = line.match(reSplit);\n            if (tmp && tmp.length == 3) {\n              dictionary[tmp[1]] = evalString(tmp[2]);\n            }\n          }\n        }\n        nextEntry();\n      }\n\n      // import another *.properties file\n      function loadImport(url, callback) {\n        xhrLoadText(url, function(content) {\n          parseRawLines(content, false, callback); // don't allow recursive imports\n        }, function () {\n          console.warn(url + ' not found.');\n          callback();\n        });\n      }\n\n      // fill the dictionary\n      parseRawLines(text, true, function() {\n        parsedPropertiesCallback(dictionary);\n      });\n    }\n\n    // load and parse l10n data (warning: global variables are used here)\n    xhrLoadText(href, function(response) {\n      gTextData += response; // mostly for debug\n\n      // parse *.properties text data into an l10n dictionary\n      parseProperties(response, function(data) {\n\n        // find attribute descriptions, if any\n        for (var key in data) {\n          var id, prop, index = key.lastIndexOf('.');\n          if (index > 0) { // an attribute has been specified\n            id = key.substring(0, index);\n            prop = key.substring(index + 1);\n          } else { // no attribute: assuming text content by default\n            id = key;\n            prop = gTextProp;\n          }\n          if (!gL10nData[id]) {\n            gL10nData[id] = {};\n          }\n          gL10nData[id][prop] = data[key];\n        }\n\n        // trigger callback\n        if (successCallback) {\n          successCallback();\n        }\n      });\n    }, failureCallback);\n  }\n\n  // load and parse all resources for the specified locale\n  function loadLocale(lang, callback) {\n    // RFC 4646, section 2.1 states that language tags have to be treated as\n    // case-insensitive. Convert to lowercase for case-insensitive comparisons.\n    if (lang) {\n      lang = lang.toLowerCase();\n    }\n\n    callback = callback || function _callback() {};\n\n    clear();\n    gLanguage = lang;\n\n    // check all <link type=\"application/l10n\" href=\"...\" /> nodes\n    // and load the resource files\n    var langLinks = getL10nResourceLinks();\n    var langCount = langLinks.length;\n    if (langCount === 0) {\n      // we might have a pre-compiled dictionary instead\n      var dict = getL10nDictionary();\n      if (dict && dict.locales && dict.default_locale) {\n        console.log('using the embedded JSON directory, early way out');\n        gL10nData = dict.locales[lang];\n        if (!gL10nData) {\n          var defaultLocale = dict.default_locale.toLowerCase();\n          for (var anyCaseLang in dict.locales) {\n            anyCaseLang = anyCaseLang.toLowerCase();\n            if (anyCaseLang === lang) {\n              gL10nData = dict.locales[lang];\n              break;\n            } else if (anyCaseLang === defaultLocale) {\n              gL10nData = dict.locales[defaultLocale];\n            }\n          }\n        }\n        callback();\n      } else {\n        console.log('no resource to load, early way out');\n      }\n      // early way out\n      gReadyState = 'complete';\n      return;\n    }\n\n    // start the callback when all resources are loaded\n    var onResourceLoaded = null;\n    var gResourceCount = 0;\n    onResourceLoaded = function() {\n      gResourceCount++;\n      if (gResourceCount >= langCount) {\n        callback();\n        gReadyState = 'complete';\n      }\n    };\n\n    // load all resource files\n    function L10nResourceLink(link) {\n      var href = link.href;\n      // Note: If |gAsyncResourceLoading| is false, then the following callbacks\n      // are synchronously called.\n      this.load = function(lang, callback) {\n        parseResource(href, lang, callback, function() {\n          console.warn(href + ' not found.');\n          // lang not found, used default resource instead\n          console.warn('\"' + lang + '\" resource not found');\n          gLanguage = '';\n          // Resource not loaded, but we still need to call the callback.\n          callback();\n        });\n      };\n    }\n\n    for (var i = 0; i < langCount; i++) {\n      var resource = new L10nResourceLink(langLinks[i]);\n      resource.load(lang, onResourceLoaded);\n    }\n  }\n\n  // clear all l10n data\n  function clear() {\n    gL10nData = {};\n    gTextData = '';\n    gLanguage = '';\n    // TODO: clear all non predefined macros.\n    // There's no such macro /yet/ but we're planning to have some...\n  }\n\n\n  /**\n   * Get rules for plural forms (shared with JetPack), see:\n   * http://unicode.org/repos/cldr-tmp/trunk/diff/supplemental/language_plural_rules.html\n   * https://github.com/mozilla/addon-sdk/blob/master/python-lib/plural-rules-generator.p\n   *\n   * @param {string} lang\n   *    locale (language) used.\n   *\n   * @return {Function}\n   *    returns a function that gives the plural form name for a given integer:\n   *       var fun = getPluralRules('en');\n   *       fun(1)    -> 'one'\n   *       fun(0)    -> 'other'\n   *       fun(1000) -> 'other'.\n   */\n\n  function getPluralRules(lang) {\n    var locales2rules = {\n      'af': 3,\n      'ak': 4,\n      'am': 4,\n      'ar': 1,\n      'asa': 3,\n      'az': 0,\n      'be': 11,\n      'bem': 3,\n      'bez': 3,\n      'bg': 3,\n      'bh': 4,\n      'bm': 0,\n      'bn': 3,\n      'bo': 0,\n      'br': 20,\n      'brx': 3,\n      'bs': 11,\n      'ca': 3,\n      'cgg': 3,\n      'chr': 3,\n      'cs': 12,\n      'cy': 17,\n      'da': 3,\n      'de': 3,\n      'dv': 3,\n      'dz': 0,\n      'ee': 3,\n      'el': 3,\n      'en': 3,\n      'eo': 3,\n      'es': 3,\n      'et': 3,\n      'eu': 3,\n      'fa': 0,\n      'ff': 5,\n      'fi': 3,\n      'fil': 4,\n      'fo': 3,\n      'fr': 5,\n      'fur': 3,\n      'fy': 3,\n      'ga': 8,\n      'gd': 24,\n      'gl': 3,\n      'gsw': 3,\n      'gu': 3,\n      'guw': 4,\n      'gv': 23,\n      'ha': 3,\n      'haw': 3,\n      'he': 2,\n      'hi': 4,\n      'hr': 11,\n      'hu': 0,\n      'id': 0,\n      'ig': 0,\n      'ii': 0,\n      'is': 3,\n      'it': 3,\n      'iu': 7,\n      'ja': 0,\n      'jmc': 3,\n      'jv': 0,\n      'ka': 0,\n      'kab': 5,\n      'kaj': 3,\n      'kcg': 3,\n      'kde': 0,\n      'kea': 0,\n      'kk': 3,\n      'kl': 3,\n      'km': 0,\n      'kn': 0,\n      'ko': 0,\n      'ksb': 3,\n      'ksh': 21,\n      'ku': 3,\n      'kw': 7,\n      'lag': 18,\n      'lb': 3,\n      'lg': 3,\n      'ln': 4,\n      'lo': 0,\n      'lt': 10,\n      'lv': 6,\n      'mas': 3,\n      'mg': 4,\n      'mk': 16,\n      'ml': 3,\n      'mn': 3,\n      'mo': 9,\n      'mr': 3,\n      'ms': 0,\n      'mt': 15,\n      'my': 0,\n      'nah': 3,\n      'naq': 7,\n      'nb': 3,\n      'nd': 3,\n      'ne': 3,\n      'nl': 3,\n      'nn': 3,\n      'no': 3,\n      'nr': 3,\n      'nso': 4,\n      'ny': 3,\n      'nyn': 3,\n      'om': 3,\n      'or': 3,\n      'pa': 3,\n      'pap': 3,\n      'pl': 13,\n      'ps': 3,\n      'pt': 3,\n      'rm': 3,\n      'ro': 9,\n      'rof': 3,\n      'ru': 11,\n      'rwk': 3,\n      'sah': 0,\n      'saq': 3,\n      'se': 7,\n      'seh': 3,\n      'ses': 0,\n      'sg': 0,\n      'sh': 11,\n      'shi': 19,\n      'sk': 12,\n      'sl': 14,\n      'sma': 7,\n      'smi': 7,\n      'smj': 7,\n      'smn': 7,\n      'sms': 7,\n      'sn': 3,\n      'so': 3,\n      'sq': 3,\n      'sr': 11,\n      'ss': 3,\n      'ssy': 3,\n      'st': 3,\n      'sv': 3,\n      'sw': 3,\n      'syr': 3,\n      'ta': 3,\n      'te': 3,\n      'teo': 3,\n      'th': 0,\n      'ti': 4,\n      'tig': 3,\n      'tk': 3,\n      'tl': 4,\n      'tn': 3,\n      'to': 0,\n      'tr': 0,\n      'ts': 3,\n      'tzm': 22,\n      'uk': 11,\n      'ur': 3,\n      've': 3,\n      'vi': 0,\n      'vun': 3,\n      'wa': 4,\n      'wae': 3,\n      'wo': 0,\n      'xh': 3,\n      'xog': 3,\n      'yo': 0,\n      'zh': 0,\n      'zu': 3\n    };\n\n    // utility functions for plural rules methods\n    function isIn(n, list) {\n      return list.indexOf(n) !== -1;\n    }\n    function isBetween(n, start, end) {\n      return start <= n && n <= end;\n    }\n\n    // list of all plural rules methods:\n    // map an integer to the plural form name to use\n    var pluralRules = {\n      '0': function(n) {\n        return 'other';\n      },\n      '1': function(n) {\n        if ((isBetween((n % 100), 3, 10)))\n          return 'few';\n        if (n === 0)\n          return 'zero';\n        if ((isBetween((n % 100), 11, 99)))\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '2': function(n) {\n        if (n !== 0 && (n % 10) === 0)\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '3': function(n) {\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '4': function(n) {\n        if ((isBetween(n, 0, 1)))\n          return 'one';\n        return 'other';\n      },\n      '5': function(n) {\n        if ((isBetween(n, 0, 2)) && n != 2)\n          return 'one';\n        return 'other';\n      },\n      '6': function(n) {\n        if (n === 0)\n          return 'zero';\n        if ((n % 10) == 1 && (n % 100) != 11)\n          return 'one';\n        return 'other';\n      },\n      '7': function(n) {\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '8': function(n) {\n        if ((isBetween(n, 3, 6)))\n          return 'few';\n        if ((isBetween(n, 7, 10)))\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '9': function(n) {\n        if (n === 0 || n != 1 && (isBetween((n % 100), 1, 19)))\n          return 'few';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '10': function(n) {\n        if ((isBetween((n % 10), 2, 9)) && !(isBetween((n % 100), 11, 19)))\n          return 'few';\n        if ((n % 10) == 1 && !(isBetween((n % 100), 11, 19)))\n          return 'one';\n        return 'other';\n      },\n      '11': function(n) {\n        if ((isBetween((n % 10), 2, 4)) && !(isBetween((n % 100), 12, 14)))\n          return 'few';\n        if ((n % 10) === 0 ||\n            (isBetween((n % 10), 5, 9)) ||\n            (isBetween((n % 100), 11, 14)))\n          return 'many';\n        if ((n % 10) == 1 && (n % 100) != 11)\n          return 'one';\n        return 'other';\n      },\n      '12': function(n) {\n        if ((isBetween(n, 2, 4)))\n          return 'few';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '13': function(n) {\n        if ((isBetween((n % 10), 2, 4)) && !(isBetween((n % 100), 12, 14)))\n          return 'few';\n        if (n != 1 && (isBetween((n % 10), 0, 1)) ||\n            (isBetween((n % 10), 5, 9)) ||\n            (isBetween((n % 100), 12, 14)))\n          return 'many';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '14': function(n) {\n        if ((isBetween((n % 100), 3, 4)))\n          return 'few';\n        if ((n % 100) == 2)\n          return 'two';\n        if ((n % 100) == 1)\n          return 'one';\n        return 'other';\n      },\n      '15': function(n) {\n        if (n === 0 || (isBetween((n % 100), 2, 10)))\n          return 'few';\n        if ((isBetween((n % 100), 11, 19)))\n          return 'many';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '16': function(n) {\n        if ((n % 10) == 1 && n != 11)\n          return 'one';\n        return 'other';\n      },\n      '17': function(n) {\n        if (n == 3)\n          return 'few';\n        if (n === 0)\n          return 'zero';\n        if (n == 6)\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '18': function(n) {\n        if (n === 0)\n          return 'zero';\n        if ((isBetween(n, 0, 2)) && n !== 0 && n != 2)\n          return 'one';\n        return 'other';\n      },\n      '19': function(n) {\n        if ((isBetween(n, 2, 10)))\n          return 'few';\n        if ((isBetween(n, 0, 1)))\n          return 'one';\n        return 'other';\n      },\n      '20': function(n) {\n        if ((isBetween((n % 10), 3, 4) || ((n % 10) == 9)) && !(\n            isBetween((n % 100), 10, 19) ||\n            isBetween((n % 100), 70, 79) ||\n            isBetween((n % 100), 90, 99)\n            ))\n          return 'few';\n        if ((n % 1000000) === 0 && n !== 0)\n          return 'many';\n        if ((n % 10) == 2 && !isIn((n % 100), [12, 72, 92]))\n          return 'two';\n        if ((n % 10) == 1 && !isIn((n % 100), [11, 71, 91]))\n          return 'one';\n        return 'other';\n      },\n      '21': function(n) {\n        if (n === 0)\n          return 'zero';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '22': function(n) {\n        if ((isBetween(n, 0, 1)) || (isBetween(n, 11, 99)))\n          return 'one';\n        return 'other';\n      },\n      '23': function(n) {\n        if ((isBetween((n % 10), 1, 2)) || (n % 20) === 0)\n          return 'one';\n        return 'other';\n      },\n      '24': function(n) {\n        if ((isBetween(n, 3, 10) || isBetween(n, 13, 19)))\n          return 'few';\n        if (isIn(n, [2, 12]))\n          return 'two';\n        if (isIn(n, [1, 11]))\n          return 'one';\n        return 'other';\n      }\n    };\n\n    // return a function that gives the plural form name for a given integer\n    var index = locales2rules[lang.replace(/-.*$/, '')];\n    if (!(index in pluralRules)) {\n      console.warn('plural form unknown for [' + lang + ']');\n      return function() { return 'other'; };\n    }\n    return pluralRules[index];\n  }\n\n  // pre-defined 'plural' macro\n  gMacros.plural = function(str, param, key, prop) {\n    var n = parseFloat(param);\n    if (isNaN(n))\n      return str;\n\n    // TODO: support other properties (l20n still doesn't...)\n    if (prop != gTextProp)\n      return str;\n\n    // initialize _pluralRules\n    if (!gMacros._pluralRules) {\n      gMacros._pluralRules = getPluralRules(gLanguage);\n    }\n    var index = '[' + gMacros._pluralRules(n) + ']';\n\n    // try to find a [zero|one|two] key if it's defined\n    if (n === 0 && (key + '[zero]') in gL10nData) {\n      str = gL10nData[key + '[zero]'][prop];\n    } else if (n == 1 && (key + '[one]') in gL10nData) {\n      str = gL10nData[key + '[one]'][prop];\n    } else if (n == 2 && (key + '[two]') in gL10nData) {\n      str = gL10nData[key + '[two]'][prop];\n    } else if ((key + index) in gL10nData) {\n      str = gL10nData[key + index][prop];\n    } else if ((key + '[other]') in gL10nData) {\n      str = gL10nData[key + '[other]'][prop];\n    }\n\n    return str;\n  };\n\n\n  /**\n   * l10n dictionary functions\n   */\n\n  // fetch an l10n object, warn if not found, apply `args' if possible\n  function getL10nData(key, args, fallback) {\n    var data = gL10nData[key];\n    if (!data) {\n      console.warn('#' + key + ' is undefined.');\n      if (!fallback) {\n        return null;\n      }\n      data = fallback;\n    }\n\n    /** This is where l10n expressions should be processed.\n      * The plan is to support C-style expressions from the l20n project;\n      * until then, only two kinds of simple expressions are supported:\n      *   {[ index ]} and {{ arguments }}.\n      */\n    var rv = {};\n    for (var prop in data) {\n      var str = data[prop];\n      str = substIndexes(str, args, key, prop);\n      str = substArguments(str, args, key);\n      rv[prop] = str;\n    }\n    return rv;\n  }\n\n  // replace {[macros]} with their values\n  function substIndexes(str, args, key, prop) {\n    var reIndex = /\\{\\[\\s*([a-zA-Z]+)\\(([a-zA-Z]+)\\)\\s*\\]\\}/;\n    var reMatch = reIndex.exec(str);\n    if (!reMatch || !reMatch.length)\n      return str;\n\n    // an index/macro has been found\n    // Note: at the moment, only one parameter is supported\n    var macroName = reMatch[1];\n    var paramName = reMatch[2];\n    var param;\n    if (args && paramName in args) {\n      param = args[paramName];\n    } else if (paramName in gL10nData) {\n      param = gL10nData[paramName];\n    }\n\n    // there's no macro parser yet: it has to be defined in gMacros\n    if (macroName in gMacros) {\n      var macro = gMacros[macroName];\n      str = macro(str, param, key, prop);\n    }\n    return str;\n  }\n\n  // replace {{arguments}} with their values\n  function substArguments(str, args, key) {\n    var reArgs = /\\{\\{\\s*(.+?)\\s*\\}\\}/g;\n    return str.replace(reArgs, function(matched_text, arg) {\n      if (args && arg in args) {\n        return args[arg];\n      }\n      if (arg in gL10nData) {\n        return gL10nData[arg];\n      }\n      console.log('argument {{' + arg + '}} for #' + key + ' is undefined.');\n      return matched_text;\n    });\n  }\n\n  // translate an HTML element\n  function translateElement(element) {\n    var l10n = getL10nAttributes(element);\n    if (!l10n.id)\n      return;\n\n    // get the related l10n object\n    var data = getL10nData(l10n.id, l10n.args);\n    if (!data) {\n      console.warn('#' + l10n.id + ' is undefined.');\n      return;\n    }\n\n    // translate element (TODO: security checks?)\n    if (data[gTextProp]) { // XXX\n      if (getChildElementCount(element) === 0) {\n        element[gTextProp] = data[gTextProp];\n      } else {\n        // this element has element children: replace the content of the first\n        // (non-empty) child textNode and clear other child textNodes\n        var children = element.childNodes;\n        var found = false;\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (children[i].nodeType === 3 && /\\S/.test(children[i].nodeValue)) {\n            if (found) {\n              children[i].nodeValue = '';\n            } else {\n              children[i].nodeValue = data[gTextProp];\n              found = true;\n            }\n          }\n        }\n        // if no (non-empty) textNode is found, insert a textNode before the\n        // first element child.\n        if (!found) {\n          var textNode = document.createTextNode(data[gTextProp]);\n          element.insertBefore(textNode, element.firstChild);\n        }\n      }\n      delete data[gTextProp];\n    }\n\n    for (var k in data) {\n      element[k] = data[k];\n    }\n  }\n\n  // webkit browsers don't currently support 'children' on SVG elements...\n  function getChildElementCount(element) {\n    if (element.children) {\n      return element.children.length;\n    }\n    if (typeof element.childElementCount !== 'undefined') {\n      return element.childElementCount;\n    }\n    var count = 0;\n    for (var i = 0; i < element.childNodes.length; i++) {\n      count += element.nodeType === 1 ? 1 : 0;\n    }\n    return count;\n  }\n\n  // translate an HTML subtree\n  function translateFragment(element) {\n    element = element || document.documentElement;\n\n    // check all translatable children (= w/ a `data-l10n-id' attribute)\n    var children = getTranslatableChildren(element);\n    var elementCount = children.length;\n    for (var i = 0; i < elementCount; i++) {\n      translateElement(children[i]);\n    }\n\n    // translate element itself if necessary\n    translateElement(element);\n  }\n\n  return {\n    // get a localized string\n    get: function(key, args, fallbackString) {\n      var index = key.lastIndexOf('.');\n      var prop = gTextProp;\n      if (index > 0) { // An attribute has been specified\n        prop = key.substring(index + 1);\n        key = key.substring(0, index);\n      }\n      var fallback;\n      if (fallbackString) {\n        fallback = {};\n        fallback[prop] = fallbackString;\n      }\n      var data = getL10nData(key, args, fallback);\n      if (data && prop in data) {\n        return data[prop];\n      }\n      return '{{' + key + '}}';\n    },\n\n    // debug\n    getData: function() { return gL10nData; },\n    getText: function() { return gTextData; },\n\n    // get|set the document language\n    getLanguage: function() { return gLanguage; },\n    setLanguage: function(lang, callback) {\n      loadLocale(lang, function() {\n        if (callback)\n          callback();\n      });\n    },\n\n    // get the direction (ltr|rtl) of the current language\n    getDirection: function() {\n      // http://www.w3.org/International/questions/qa-scripts\n      // Arabic, Hebrew, Farsi, Pashto, Urdu\n      var rtlList = ['ar', 'he', 'fa', 'ps', 'ur'];\n      var shortCode = gLanguage.split('-', 1)[0];\n      return (rtlList.indexOf(shortCode) >= 0) ? 'rtl' : 'ltr';\n    },\n\n    // translate an element or document fragment\n    translate: translateFragment,\n\n    // this can be used to prevent race conditions\n    getReadyState: function() { return gReadyState; },\n    ready: function(callback) {\n      if (!callback) {\n        return;\n      } else if (gReadyState == 'complete' || gReadyState == 'interactive') {\n        window.setTimeout(function() {\n          callback();\n        });\n      } else if (document.addEventListener) {\n        document.addEventListener('localized', function once() {\n          document.removeEventListener('localized', once);\n          callback();\n        });\n      }\n    }\n  };\n}) (window, document);\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CSS_UNITS, NullL10n } from './ui_utils';\nimport { PDFPrintServiceFactory, PDFViewerApplication } from './app';\nimport { AppOptions } from './app_options';\n\nlet activeService = null;\nlet overlayManager = null;\n\n// Renders the page to the canvas of the given print service, and returns\n// the suggested dimensions of the output page.\nfunction renderPage(activeServiceOnEntry, pdfDocument, pageNumber, size) {\n  let scratchCanvas = activeService.scratchCanvas;\n\n  // The size of the canvas in pixels for printing.\n  const PRINT_RESOLUTION = AppOptions.get('printResolution') || 150;\n  const PRINT_UNITS = PRINT_RESOLUTION / 72.0;\n  scratchCanvas.width = Math.floor(size.width * PRINT_UNITS);\n  scratchCanvas.height = Math.floor(size.height * PRINT_UNITS);\n\n  // The physical size of the img as specified by the PDF document.\n  let width = Math.floor(size.width * CSS_UNITS) + 'px';\n  let height = Math.floor(size.height * CSS_UNITS) + 'px';\n\n  let ctx = scratchCanvas.getContext('2d');\n  ctx.save();\n  ctx.fillStyle = 'rgb(255, 255, 255)';\n  ctx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);\n  ctx.restore();\n\n  return pdfDocument.getPage(pageNumber).then(function(pdfPage) {\n    let renderContext = {\n      canvasContext: ctx,\n      transform: [PRINT_UNITS, 0, 0, PRINT_UNITS, 0, 0],\n      viewport: pdfPage.getViewport({ scale: 1, rotation: size.rotation, }),\n      intent: 'print',\n    };\n    return pdfPage.render(renderContext).promise;\n  }).then(function() {\n    return {\n      width,\n      height,\n    };\n  });\n}\n\nfunction PDFPrintService(pdfDocument, pagesOverview, printContainer, l10n) {\n  this.pdfDocument = pdfDocument;\n  this.pagesOverview = pagesOverview;\n  this.printContainer = printContainer;\n  this.l10n = l10n || NullL10n;\n  this.disableCreateObjectURL =\n    pdfDocument.loadingParams['disableCreateObjectURL'];\n  this.currentPage = -1;\n  // The temporary canvas where renderPage paints one page at a time.\n  this.scratchCanvas = document.createElement('canvas');\n}\n\nPDFPrintService.prototype = {\n  layout() {\n    this.throwIfInactive();\n\n    const body = document.querySelector('body');\n    body.setAttribute('data-pdfjsprinting', true);\n\n    let hasEqualPageSizes = this.pagesOverview.every(function(size) {\n      return size.width === this.pagesOverview[0].width &&\n             size.height === this.pagesOverview[0].height;\n    }, this);\n    if (!hasEqualPageSizes) {\n      console.warn('Not all pages have the same size. The printed ' +\n                   'result may be incorrect!');\n    }\n\n    // Insert a @page + size rule to make sure that the page size is correctly\n    // set. Note that we assume that all pages have the same size, because\n    // variable-size pages are not supported yet (e.g. in Chrome & Firefox).\n    // TODO(robwu): Use named pages when size calculation bugs get resolved\n    // (e.g. https://crbug.com/355116) AND when support for named pages is\n    // added (http://www.w3.org/TR/css3-page/#using-named-pages).\n    // In browsers where @page + size is not supported (such as Firefox,\n    // https://bugzil.la/851441), the next stylesheet will be ignored and the\n    // user has to select the correct paper size in the UI if wanted.\n    this.pageStyleSheet = document.createElement('style');\n    let pageSize = this.pagesOverview[0];\n    this.pageStyleSheet.textContent =\n      // \"size:<width> <height>\" is what we need. But also add \"A4\" because\n      // Firefox incorrectly reports support for the other value.\n      '@supports ((size:A4) and (size:1pt 1pt)) {' +\n      '@page { size: ' + pageSize.width + 'pt ' + pageSize.height + 'pt;}' +\n      '}';\n    body.appendChild(this.pageStyleSheet);\n  },\n\n  destroy() {\n    if (activeService !== this) {\n      // |activeService| cannot be replaced without calling destroy() first,\n      // so if it differs then an external consumer has a stale reference to\n      // us.\n      return;\n    }\n    this.printContainer.textContent = '';\n\n    const body = document.querySelector('body');\n    body.removeAttribute('data-pdfjsprinting');\n\n    if (this.pageStyleSheet) {\n      this.pageStyleSheet.remove();\n      this.pageStyleSheet = null;\n    }\n    this.scratchCanvas.width = this.scratchCanvas.height = 0;\n    this.scratchCanvas = null;\n    activeService = null;\n    ensureOverlay().then(function() {\n      if (overlayManager.active !== 'printServiceOverlay') {\n        return; // overlay was already closed\n      }\n      overlayManager.close('printServiceOverlay');\n    });\n  },\n\n  renderPages() {\n    let pageCount = this.pagesOverview.length;\n    let renderNextPage = (resolve, reject) => {\n      this.throwIfInactive();\n      if (++this.currentPage >= pageCount) {\n        renderProgress(pageCount, pageCount, this.l10n);\n        resolve();\n        return;\n      }\n      let index = this.currentPage;\n      renderProgress(index, pageCount, this.l10n);\n      renderPage(this, this.pdfDocument, index + 1, this.pagesOverview[index])\n        .then(this.useRenderedPage.bind(this))\n        .then(function() {\n          renderNextPage(resolve, reject);\n        }, reject);\n    };\n    return new Promise(renderNextPage);\n  },\n\n  useRenderedPage(printItem) {\n    this.throwIfInactive();\n    let img = document.createElement('img');\n    img.style.width = printItem.width;\n    img.style.height = printItem.height;\n\n    let scratchCanvas = this.scratchCanvas;\n    if (('toBlob' in scratchCanvas) && !this.disableCreateObjectURL) {\n      scratchCanvas.toBlob(function(blob) {\n        img.src = URL.createObjectURL(blob);\n      });\n    } else {\n      img.src = scratchCanvas.toDataURL();\n    }\n\n    let wrapper = document.createElement('div');\n    wrapper.appendChild(img);\n    this.printContainer.appendChild(wrapper);\n\n    return new Promise(function(resolve, reject) {\n      img.onload = resolve;\n      img.onerror = reject;\n    });\n  },\n\n  performPrint() {\n    this.throwIfInactive();\n    return new Promise((resolve) => {\n      // Push window.print in the macrotask queue to avoid being affected by\n      // the deprecation of running print() code in a microtask, see\n      // https://github.com/mozilla/pdf.js/issues/7547.\n      setTimeout(() => {\n        if (!this.active) {\n          resolve();\n          return;\n        }\n        print.call(window);\n        // Delay promise resolution in case print() was not synchronous.\n        setTimeout(resolve, 20);  // Tidy-up.\n      }, 0);\n    });\n  },\n\n  get active() {\n    return this === activeService;\n  },\n\n  throwIfInactive() {\n    if (!this.active) {\n      throw new Error('This print request was cancelled or completed.');\n    }\n  },\n};\n\nlet print = window.print;\nwindow.print = function print() {\n  if (activeService) {\n    console.warn('Ignored window.print() because of a pending print job.');\n    return;\n  }\n  ensureOverlay().then(function() {\n    if (activeService) {\n      overlayManager.open('printServiceOverlay');\n    }\n  });\n\n  try {\n    dispatchEvent('beforeprint');\n  } finally {\n    if (!activeService) {\n      console.error('Expected print service to be initialized.');\n      ensureOverlay().then(function() {\n        if (overlayManager.active === 'printServiceOverlay') {\n          overlayManager.close('printServiceOverlay');\n        }\n      });\n      return; // eslint-disable-line no-unsafe-finally\n    }\n    let activeServiceOnEntry = activeService;\n    activeService.renderPages().then(function() {\n      return activeServiceOnEntry.performPrint();\n    }).catch(function() {\n      // Ignore any error messages.\n    }).then(function() {\n      // aborts acts on the \"active\" print request, so we need to check\n      // whether the print request (activeServiceOnEntry) is still active.\n      // Without the check, an unrelated print request (created after aborting\n      // this print request while the pages were being generated) would be\n      // aborted.\n      if (activeServiceOnEntry.active) {\n        abort();\n      }\n    });\n  }\n};\n\nfunction dispatchEvent(eventType) {\n  let event = document.createEvent('CustomEvent');\n  event.initCustomEvent(eventType, false, false, 'custom');\n  window.dispatchEvent(event);\n}\n\nfunction abort() {\n  if (activeService) {\n    activeService.destroy();\n    dispatchEvent('afterprint');\n  }\n}\n\nfunction renderProgress(index, total, l10n) {\n  let progressContainer = document.getElementById('printServiceOverlay');\n  let progress = Math.round(100 * index / total);\n  let progressBar = progressContainer.querySelector('progress');\n  let progressPerc = progressContainer.querySelector('.relative-progress');\n  progressBar.value = progress;\n  l10n.get('print_progress_percent', { progress, }, progress + '%').\n      then((msg) => {\n    progressPerc.textContent = msg;\n  });\n}\n\nlet hasAttachEvent = !!document.attachEvent;\n\nwindow.addEventListener('keydown', function(event) {\n  // Intercept Cmd/Ctrl + P in all browsers.\n  // Also intercept Cmd/Ctrl + Shift + P in Chrome and Opera\n  if (event.keyCode === /* P= */ 80 && (event.ctrlKey || event.metaKey) &&\n      !event.altKey && (!event.shiftKey || window.chrome || window.opera)) {\n    window.print();\n    if (hasAttachEvent) {\n      // Only attachEvent can cancel Ctrl + P dialog in IE <=10\n      // attachEvent is gone in IE11, so the dialog will re-appear in IE11.\n      return;\n    }\n    event.preventDefault();\n    if (event.stopImmediatePropagation) {\n      event.stopImmediatePropagation();\n    } else {\n      event.stopPropagation();\n    }\n  }\n}, true);\nif (hasAttachEvent) {\n  // eslint-disable-next-line consistent-return\n  document.attachEvent('onkeydown', function(event) {\n    event = event || window.event;\n    if (event.keyCode === /* P= */ 80 && event.ctrlKey) {\n      event.keyCode = 0;\n      return false;\n    }\n  });\n}\n\nif ('onbeforeprint' in window) {\n  // Do not propagate before/afterprint events when they are not triggered\n  // from within this polyfill. (FF /IE / Chrome 63+).\n  let stopPropagationIfNeeded = function(event) {\n    if (event.detail !== 'custom' && event.stopImmediatePropagation) {\n      event.stopImmediatePropagation();\n    }\n  };\n  window.addEventListener('beforeprint', stopPropagationIfNeeded);\n  window.addEventListener('afterprint', stopPropagationIfNeeded);\n}\n\nlet overlayPromise;\nfunction ensureOverlay() {\n  if (!overlayPromise) {\n    overlayManager = PDFViewerApplication.overlayManager;\n    if (!overlayManager) {\n      throw new Error('The overlay manager has not yet been initialized.');\n    }\n\n    overlayPromise = overlayManager.register('printServiceOverlay',\n      document.getElementById('printServiceOverlay'), abort, true);\n    document.getElementById('printCancel').onclick = abort;\n  }\n  return overlayPromise;\n}\n\nPDFPrintServiceFactory.instance = {\n  supportsPrinting: true,\n\n  createPrintService(pdfDocument, pagesOverview, printContainer, l10n) {\n    if (activeService) {\n      throw new Error('The print service is created and active.');\n    }\n    activeService = new PDFPrintService(pdfDocument, pagesOverview,\n                                        printContainer, l10n);\n    return activeService;\n  },\n};\n\nexport {\n  PDFPrintService,\n};\n"],"sourceRoot":""}